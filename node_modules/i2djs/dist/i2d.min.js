/*!
      * i2djs v3.5.0
      * (c) 2021 Narayana Swamy (narayanaswamy14@gmail.com)
      * @license BSD-3-Clause
      */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).i2d={})}(this,(function(t){"use strict";let e=null,n=[];const i={},r=[];let o,s,a,h=[];function c(t,e,n){this.executable=e,this.duration=e.duration?e.duration:0,this.delay=e.delay?e.delay:0,this.lastTime=0-(e.delay?e.delay:0),this.loopTracker=0,this.loop=e.loop?e.loop:0,this.direction=e.direction,this.easying=n,this.end=e.end?e.end:null,"reverse"===this.direction?this.factor=1:this.factor=0}function l(){}"undefined"==typeof window&&(global.window={setTimeout:setTimeout,clearTimeout:clearTimeout},global.performance={now:function(){return Date.now()}},global.document={}),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)},c.prototype.execute=function(t){this.executable.run(t)},c.prototype.resetCallBack=function(t){"function"==typeof t&&(this.callBack=t)},l.prototype={startAnimeFrames:function(){o||(o=window.requestAnimationFrame(d))},stopAnimeFrame:function(){o&&(window.cancelAnimFrame(o),o=null)},add:function(t,e,i){const r=new c(t,e,i);r.currTime=performance.now(),e.target&&(e.target.animList||(e.target.animList=[]),e.target.animList[e.target.animList.length]=r),n[n.length]=r,this.startAnimeFrames()},remove:function(t){const e=n.indexOf(t);-1!==e&&n.splice(e,1)},onRequestFrame:function(t){if("function"!=typeof t)throw new Error("Wrong input");h.push(t),h.length>0&&!o&&this.startAnimeFrames()},removeRequestFrameCall:function(t){if("function"!=typeof t)throw new Error("Wrong input");const e=h.indexOf(t);-1!==e&&h.splice(e,1)},clearAll:function(){n=[],h=[]}},l.prototype.addVdom=function(t){const e=r.length+1;return i[e]=t,r.push(e),this.startAnimeFrames(),e},l.prototype.removeVdom=function(t){const e=r.indexOf(t);-1!==e&&(r.splice(e,1),i[t].root.destroy(),delete i[t]),0===r.length&&0===n.length&&0===h.length&&this.stopAnimeFrame()},l.prototype.vDomChanged=function(t){if(i[t]&&void 0!==i[t].stateModified)i[t].stateModified=!0,i[t].root.stateModified=!0;else if("string"==typeof t){const e=t.split(":");if(i[e[0]]&&void 0!==i[e[0]].stateModified){i[e[0]].stateModified=!0,i[e[0]].root.stateModified=!0;const t=i[e[0]].root.fetchEl("#"+e[1]);t&&(t.stateModified=!0)}}},l.prototype.execute=function(){this.startAnimeFrames()},l.prototype.vDomUpdates=function(){for(let t=0,e=r.length;t<e;t+=1)if(r[t]&&i[r[t]]&&i[r[t]].stateModified)i[r[t]].execute(),i[r[t]].stateModified=!1;else if(r[t]&&i[r[t]]&&i[r[t]].root&&"NODE"!==i[r[t]].root.ENV){document.getElementById(i[r[t]].root.container.id)||this.removeVdom(r[t])}};const p=Math.abs;let f=0,u=[];function d(){try{u=[],f=0,a=performance.now();for(let t=0;t<n.length;t+=1)s=n[t],s.lastTime+=a-s.currTime,s.currTime=a,s.lastTime<s.duration&&s.lastTime>=0?(s.execute(p(s.factor-s.easying(s.lastTime,s.duration))),u[f++]=s):s.lastTime>s.duration?y(s):u[f++]=s;n=u,h.length>0&&function(){for(let t=0;t<h.length;t+=1)h[t](a)}(),e.vDomUpdates()}catch(t){console.error(t)}finally{o=window.requestAnimationFrame(d)}}function y(t){if(t.loopTracker>=t.loop-1){if(t.execute(1-t.factor),t.end&&t.end(),t.executable.target){const e=t.executable.target.animList;if(e&&e.length>0)if(1===e.length)t.executable.target.animList=[];else if(e.length>1){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}else t.loopTracker+=1,t.lastTime=t.lastTime-t.duration,"alternate"===t.direction?t.factor=1-t.factor:"reverse"===t.direction?t.factor=1:t.factor=0,t.execute(p(t.factor-t.easying(t.lastTime,t.duration))),u[f++]=t}e=new l;var x=e;function m(){}function g(t,e){let n=0,i=0,r=1,o=1;const s=e;if(t.attr.transform&&t.attr.transform.translate&&([n,i]=t.attr.transform.translate,s.x-=n,s.y-=i),t.attr.transform&&t.attr.transform.scale&&(r=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,o=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:r,s.x/=r,s.y/=o),t.attr.transform&&t.attr.transform.rotate){const e=t.attr.transform.rotate[0],n={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]},i=s.x,r=s.y,o=n.x,l=n.y;var a=Math.PI/180*e,h=Math.cos(a),c=Math.sin(a);s.x=h*(i-o)+c*(r-l)+o,s.y=h*(r-l)-c*(i-o)+l}}m.prototype.execute=function(){this.root.execute(),this.stateModified=!1},m.prototype.rootNode=function(t){this.root=t,this.stateModified=!0},m.prototype.eventsCheck=function(t,e,n){const i=this;let r,o;for(var s=0;s<=t.length-1;s+=1){var a=t[s],h={x:e.x,y:e.y};g(a,h),a.in({x:h.x,y:h.y})&&(a.children&&a.children.length>0?(o=i.eventsCheck(a.children,{x:h.x,y:h.y},n),o&&(r=o)):r=a)}return r},m.prototype.transformCoOr=g;const v=Math.sqrt,b=Math.sin,w=Math.cos,B=Math.abs,A=Math.atan2,T=Math.tan,k=Math.PI,E=Math.ceil,S=Math.max;function C(t,e){let n=1;if(0===e)return n;for(let i=1;i<=e;i+=1)n*=t;return n}function D(t,e){let n=0;for(const i in t)n+=C(e[i]-t[i],2);if(isNaN(n))throw new Error("error");return v(n)}function M(t,e,n){const i=C(n,3),r=C(n,2);return{x:e.ax*i+e.bx*r+e.cx*n+t.x,y:e.ay*i+e.by*r+e.cy*n+t.y}}const _=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){const n=[];let i,r=!0,o=!1;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{o&&console.log("Error -"+i)}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},z=2*k,I=function(t,e,n,i,r,o,s){let{x:a,y:h}=t;a*=e,h*=n;return{x:i*a-r*h+o,y:r*a+i*h+s}},P=function(t,e){const n=4/3*T(e/4),i=w(t),r=b(t),o=w(t+e),s=b(t+e);return[{x:i-r*n,y:r+i*n},{x:o+s*n,y:s-o*n},{x:o,y:s}]},O=function(t,e,n,i){const r=t*i-e*n<0?-1:1;let o=(t*n+e*i)/(v(t*t+e*e)*v(t*t+e*e));return o>1&&(o=1),o<-1&&(o=-1),r*Math.acos(o)};function L(t,e,n,i){const r=t.x,o=t.y,s=e.x,a=e.y;var h=k/180*n,c=w(-h),l=b(-h);return{x:c*(r-s)+l*(o-a)+s,y:c*(o-a)-l*(r-s)+a}}function N(){}N.prototype={pow:C,getAngle:function(t,e){return A(e.x-t.x,e.y-t.y)},getDistance:D,scaleAlongOrigin:function(t,e){const n={};for(const i in t)n[i]=t[i]*e;return n},scaleAlongPoint:function(t,e,n){const i=(t.y-e.y)/(t.x-e.x),r=t.x*n;return{x:r,y:(i*(r-e.x)+e.y)*n}},linearTransitionBetweenPoints:function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}},bezierTransition:function(t,e,n,i){return{x:(t.x-2*e.x+n.x)*i*i+(2*e.x-2*t.x)*i+t.x,y:(t.y-2*e.y+n.y)*i*i+(2*e.y-2*t.y)*i+t.y}},bezierLength:function(t,e,n){const i={},r={};i.x=t.x+n.x-2*e.x,i.y=t.y+n.y-2*e.y,r.x=2*e.x-2*t.x,r.y=2*e.y-2*t.y;const o=4*(i.x*i.x+i.y*i.y),s=4*(i.x*r.x+i.y*r.y),a=r.x*r.x+r.y*r.y,h=2*v(o+s+a),c=v(o),l=2*o*c,p=2*v(a),f=s/c;let u=(2*c+f+h)/(f+p);return u=isNaN(u)||B(u)===1/0?1:u,(l*h+c*s*(h-p)+(4*a*o-s*s)*Math.log(u))/(4*l)},cubicBezierTransition:M,cubicBezierLength:function(t,e){const n=.001;let i=0;const r=M.bind(null,t,e);let o,s;for(let t=0;t<=1;t+=n)o=r(t),s=r(t+n),i+=v(C((s.x-o.x)/n,2)+C((s.y-o.y)/n,2))*n;return i},cubicBezierCoefficients:function(t){const e=3*(t.cntrl1.x-t.p0.x),n=3*(t.cntrl2.x-t.cntrl1.x)-e,i=t.p1.x-t.p0.x-e-n,r=3*(t.cntrl1.y-t.p0.y),o=3*(t.cntrl2.y-t.cntrl1.y)-r;return{cx:e,bx:n,ax:i,cy:r,by:o,ay:t.p1.y-t.p0.y-r-o}},arcToBezier:function(t){let{px:e,py:n,cx:i,cy:r,rx:o,ry:s}=t;const a=t.xAxisRotation,h=void 0===a?0:a,c=t.largeArcFlag,l=void 0===c?0:c,p=t.sweepFlag,f=void 0===p?0:p,u=[];if(0===o||0===s)return[];const d=b(h*z/360),y=w(h*z/360),x=y*(e-i)/2+d*(n-r)/2,m=-d*(e-i)/2+y*(n-r)/2;if(0===x&&0===m)return[];o=B(o),s=B(s);const g=C(x,2)/C(o,2)+C(m,2)/C(s,2);g>1&&(o*=v(g),s*=v(g));const A=function(t,e,n,i,r,o,s,a,h,c,l,p){const f=C(r,2),u=C(o,2),d=C(l,2),y=C(p,2);let x=f*u-f*y-u*d;x<0&&(x=0),x/=f*y+u*d,x=v(x)*(s===a?-1:1);const m=x*r/o*p,g=x*-o/r*l,b=c*m-h*g+(t+n)/2,w=h*m+c*g+(e+i)/2,B=(l-m)/r,A=(p-g)/o,T=(-l-m)/r,k=(-p-g)/o,E=O(1,0,B,A);let S=O(B,A,T,k);return 0===a&&S>0&&(S-=z),1===a&&S<0&&(S+=z),[b,w,E,S]}(e,n,i,r,o,s,l,f,d,y,x,m),T=_(A,4),k=T[0],D=T[1];let M=T[2],L=T[3];const N=S(E(B(L)/(z/4)),1);L/=N;for(let t=0;t<N;t++)u.push(P(M,L)),M+=L;return u.map((t=>{const e=I(t[0],o,s,y,d,k,D),n=e.x,i=e.y,r=I(t[1],o,s,y,d,k,D),a=r.x,h=r.y,c=I(t[2],o,s,y,d,k,D);return{x1:n,y1:i,x2:a,y2:h,x:c.x,y:c.y}}))},intermediateValue:function(t,e,n){return t+(e-t)*n},toCubicCurves:function(t){if(!t.length)return;const e=t,n=[];for(let t=0;t<e.length;t+=1)if(-1!==["M","C","S","Q"].indexOf(e[t].type))n.push(e[t]);else if(-1!==["V","H","L","Z"].indexOf(e[t].type)){const i={x:(e[t].p0.x+e[t].p1.x)/2,y:(e[t].p0.y+e[t].p1.y)/2};n.push({p0:e[t].p0,cntrl1:i,cntrl2:i,p1:e[t].p1,type:"C",length:e[t].length})}else console.log("wrong cmd type");return n},rotatePoint:L,rotateBBox:function(t,e){let n={x:t.x,y:t.y},i={x:t.x+t.width,y:t.y},r={x:t.x,y:t.y+t.height},o={x:t.x+t.width,y:t.y+t.height};const{translate:s,rotate:a}=e,h={x:a[1]||0,y:a[2]||0},c=a[0];s&&s.length>0&&(h.x+=s[0],h.y+=s[1]),n=L(n,h,c,D(n,h)),i=L(i,h,c,D(i,h)),r=L(r,h,c,D(r,h)),o=L(o,h,c,D(o,h));const l=[n.x,i.x,r.x,o.x].sort(((t,e)=>t-e)),p=[n.y,i.y,r.y,o.y].sort(((t,e)=>t-e));return{x:l[0],y:p[0],width:l[3]-l[0],height:p[3]-p[0]}}};var F=new N;const R=F;function j(t,e){return t/e}function X(t,e){const n=t/e;return 1-(1-n)*Math.sin(n*e*.002*Math.PI*2+Math.PI/2)/Math.exp(8*n)}function Y(t,e){const n=t/e,i=n/100;return 1-(1-n)*Math.abs(Math.sin(n*e*i*Math.PI*2+Math.PI/2))/Math.exp(10*n)}function G(t,e){const n=t/e;return n*n}function U(t,e){const n=t/e;return n*(2-n)}function H(t,e){const n=t/e;return n<.5?2*n*n:(4-2*n)*n-1}function V(t,e){const n=t/e;return R.pow(n,3)}function q(t,e){let n=t/e;return n-=1,n*n*n+1}function Z(t,e){const n=t/e;return n<.5?4*R.pow(n,3):(n-1)*(2*n-2)*(2*n-2)+1}function W(t,e){const n=t/e;return 1-Math.cos(n*Math.PI/2)}function $(t,e){const n=t/e;return Math.cos(n*Math.PI/2)}function Q(t,e){const n=t/e;return(1-Math.cos(Math.PI*n))/2}function J(t){let e;if("function"==typeof t)return function(e,n){return t(e/n)};switch(t){case"easeOutQuad":e=U;break;case"easeInQuad":e=G;break;case"easeInOutQuad":e=H;break;case"easeInCubic":e=V;break;case"easeOutCubic":e=q;break;case"easeInOutCubic":e=Z;break;case"easeInSin":e=W;break;case"easeOutSin":e=$;break;case"easeInOutSin":e=Q;break;case"bounce":e=Y;break;case"linear":e=j;break;case"elastic":e=X;break;default:e=j}return e}let K=0,tt=0;function et(){return K+=1,K}function nt(){return tt+=1,tt}const it=J;function rt(t){return this.easying=it(t),this.transition=t,this}function ot(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.durationP=t,this}function st(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.loopValue=t,this}function at(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.directionV=t,this}function ht(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.data=t,"CANVAS"===this.data.nodeName&&(this.canvasStack=[]),this}function ct(t){return"function"!=typeof t?null:(this.callbckExe=t,this)}function lt(t){return this.end=t,this}function pt(t){return this.endExe=t,this}function ft(){this.start()}function ut(){this.queue=x,this.sequenceQueue=[],this.lengthV=0,this.currPos=0,this.ID=et(),this.loopCounter=0}function dt(){this.queue=x,this.group=[],this.currPos=0,this.ID=et(),this.loopCounter=1}ut.prototype={duration:ot,loop:st,callbck:ct,bind:ht,child:lt,ease:rt,end:pt,commit:ft,reset:function(t){return this.resetV=t,this},direction:at},ut.prototype.add=function(t){const e=this;return Array.isArray(t)||"function"==typeof t||(t=[t]),Array.isArray(t)&&t.map((t=>(e.lengthV+=t.length?t.length:0,t))),this.sequenceQueue=this.sequenceQueue.concat(t),this},ut.prototype.easyingGlobal=function(t,e){return t/e},ut.prototype.start=function(){const t=this;if("alternate"===t.directionV)t.factor=t.factor?-1*t.factor:1,t.currPos=t.factor<0?this.sequenceQueue.length-1:0;else if("reverse"===t.directionV){for(let e=0;e<this.sequenceQueue.length;e+=1){const n=this.sequenceQueue[e];n instanceof ut||n instanceof dt||n.run(1),t.currPos=e}t.factor=-1}else t.currPos=0,t.factor=1;this.execute()},ut.prototype.execute=function(){const t=this;let e=this.sequenceQueue[t.currPos];if(e="function"==typeof e?e():e,e)return e instanceof ut||e instanceof dt?e.end(t.triggerEnd.bind(t,e)).commit():(this.currObj=e,this.queue.add(nt(),{run(t){e.run(t)},target:e.target,delay:void 0!==e.delay?e.delay:0,duration:void 0!==e.duration?e.duration:t.durationP,loop:e.loop?e.loop:1,direction:t.factor<0?"reverse":"default",end:t.triggerEnd.bind(t,e)},((t,e)=>t/e))),this},ut.prototype.triggerEnd=function(t){const e=this;if(e.currPos+=e.factor,t.end&&e.triggerChild(t),e.sequenceQueue.length===e.currPos||e.currPos<0)return e.endExe&&e.endExe(),e.loopCounter+=1,void(e.loopCounter<e.loopValue&&e.start());this.execute()},ut.prototype.triggerChild=function(t){t.end instanceof dt||t.end instanceof ut?setTimeout((()=>{t.end.commit()}),0):t.end()},dt.prototype={duration:ot,loop:st,callbck:ct,bind:ht,child:lt,ease:rt,end:pt,commit:ft,direction:at},dt.prototype.add=function(t){const e=this;return Array.isArray(t)||(t=[t]),this.group=this.group.concat(t),this.group.forEach((t=>{t.durationP=t.durationP?t.durationP:e.durationP})),this},dt.prototype.execute=function(){const t=this;t.currPos=0;for(let e=0,n=t.group.length;e<n;e++){const n=t.group[e];n instanceof ut||n instanceof dt?n.end(t.triggerEnd.bind(t,n)).commit():t.queue.add(nt(),{run(t){n.run(t)},target:n.target,delay:void 0!==n.delay?n.delay:0,duration:void 0!==n.duration?n.duration:t.durationP,loop:n.loop?n.loop:1,direction:n.direction?n.direction:"default",end:t.triggerEnd.bind(t,n)},n.ease?it(n.ease):t.easying)}return t},dt.prototype.start=function(){const t=this;"alternate"===t.directionV?t.factor=t.factor?-1*t.factor:1:"reverse"===t.directionV?t.factor=-1:t.factor=1,this.execute()},dt.prototype.triggerEnd=function(t){const e=this;this.currPos+=1,t.end&&this.triggerChild(t.end),this.currPos===this.group.length&&(this.endExe&&this.triggerChild(this.endExe),e.loopCounter+=1,e.loopCounter<e.loopValue&&e.start())},dt.prototype.triggerChild=function(t){t instanceof dt||t instanceof ut?t.commit():"function"==typeof t?t():console.log("wrong type")};var yt={sequenceChain:function(){return new ut},parallelChain:function(){return new dt}};let xt=0;const mt=F,gt=x,vt=J;function bt(t,e,n,i){let{minX:r,minY:o,maxX:s,maxY:a}=n;if(-1!==["V","H","L","v","h","l"].indexOf(t.type))[t.p0?t.p0:e.p1,t.p1].forEach((function(t){t.x<r&&(r=t.x),t.x>s&&(s=t.x),t.y<o&&(o=t.y),t.y>a&&(a=t.y)}));else if(-1!==["Q","C","q","c"].indexOf(t.type)){const e=mt.cubicBezierCoefficients(t),n=mt.cubicBezierTransition.bind(null,t.p0,e);let i,h=0;for(;h<1;)i=n(h),h+=.05,i.x<r&&(r=i.x),i.x>s&&(s=i.x),i.y<o&&(o=i.y),i.y>a&&(a=i.y)}else{const e=t.p0;e.x<r&&(r=e.x),e.x>s&&(s=e.x),e.y<o&&(o=e.y),e.y>a&&(a=e.y)}n.minX=r,n.minY=o,n.maxX=s,n.maxY=a,i.x=r,i.y=o,i.width=s-r,i.height=a-o}function wt(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Bt(t,e){return{x:t.x-e.x,y:t.y-e.y}}function At(t,e,n){return t?n:e}function Tt(t){this.stack=[],this.length=0,this.stackGroup=[],this.BBox={x:0,y:0,width:0,height:0},this.minMax={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},t&&this.parse(t)}function kt(t){return["S","C","V","L","H","Q"].indexOf(t)>-1}Tt.prototype={z:function(){return this.cp=this.start,this.segmentLength=mt.getDistance(this.pp,this.cp),this.stack.push({p0:this.pp,p1:this.cp,type:"Z",length:this.segmentLength,pointAt(t){return mt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},m:function(t,e){const n=At(t,this.pp?this.pp:{x:0,y:0},{x:0,y:0});return this.cntrl=null,this.cp=wt(e,n),this.start=this.cp,this.segmentLength=0,this.length=this.segmentLength,0!==this.currPathArr&&this.pp?(this.stackGroup.push(this.stack),this.stack=[]):this.stackGroup.push(this.stack),this.stack.push({type:"M",p0:this.cp,length:this.segmentLength,pointAt(t){return this.p0}}),this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},v:function(t,e){const n=At(t,this.pp,{x:this.pp.x,y:0});return this.cntrl=null,this.cp=wt(e,n),this.segmentLength=mt.getDistance(this.pp,this.cp),this.stack.push({type:"V",p0:this.pp,p1:this.cp,length:this.segmentLength,pointAt(t){return mt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},h:function(t,e){const n=At(t,this.pp,{x:0,y:this.pp.y});return this.cp=wt(e,n),this.cntrl=null,this.segmentLength=mt.getDistance(this.pp,this.cp),this.stack.push({type:t?"H":"h",p0:this.pp,p1:this.cp,length:this.segmentLength,relative:{p1:e},pointAt(t){return mt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},l:function(t,e){const n=At(t,this.pp,{x:0,y:0});return this.cntrl=null,this.cp=wt(e,n),this.segmentLength=mt.getDistance(this.pp,this.cp),this.stack.push({type:t?"L":"l",p0:this.pp,p1:this.cp,relative:{p1:e},length:this.segmentLength,pointAt(t){return mt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},q:function(t,e,n){const i=At(t,this.pp,{x:0,y:0}),r=wt(e,i),o=wt(n,i);return this.cp=o,this.segmentLength=mt.bezierLength(this.pp,r,this.cp),this.cp=o,this.stack.push({type:t?"Q":"q",p0:this.pp,cntrl1:r,cntrl2:r,p1:this.cp,relative:{cntrl1:e,p1:n},length:this.segmentLength,pointAt(t){return mt.bezierTransition(this.p0,this.cntrl1,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=r,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},s:function(t,e,n){const i=At(t,this.pp,{x:0,y:0}),r=wt(e,i),o=this.cntrl?wt(this.pp,Bt(this.pp,this.cntrl?this.cntrl:this.pp)):r,s=wt(n,i);this.cp=s;const a=mt.cubicBezierCoefficients({p0:this.pp,cntrl1:o,cntrl2:r,p1:s});return this.segmentLength=mt.cubicBezierLength(this.pp,a),this.stack.push({type:t?"S":"s",p0:this.pp,cntrl1:o,cntrl2:r,p1:this.cp,co:a,length:this.segmentLength,relative:{cntrl2:e,p1:n},pointAt(t){return mt.cubicBezierTransition(this.p0,this.co,t)}}),bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=r,this},c:function(t,e,n,i){const r=this,o=At(t,this.pp,{x:0,y:0}),s=wt(e,o),a=wt(n,o),h=wt(i,o),c=mt.cubicBezierCoefficients({p0:this.pp,cntrl1:s,cntrl2:a,p1:h});return this.cntrl=a,this.cp=h,this.segmentLength=mt.cubicBezierLength(this.pp,c),this.stack.push({type:t?"C":"c",p0:this.pp,cntrl1:s,cntrl2:a,p1:this.cp,length:this.segmentLength,co:c,relative:{cntrl1:e,cntrl2:n,p1:i},pointAt(t){return mt.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(r.stack[r.stack.length-1],r.stack[r.stack.length-2],r.minMax,r.BBox),this},a:function(t,e,n,i,r,o,s){const a=At(t,this.pp,{x:0,y:0}),h=this,c=wt(s,a);this.cp=c;const l=mt.arcToBezier({px:this.pp.x,py:this.pp.y,cx:c.x,cy:c.y,rx:e,ry:n,xAxisRotation:i,largeArcFlag:r,sweepFlag:o});return l.forEach(((t,e)=>{const n=0===e?h.pp:{x:l[0].x,y:l[0].y},i={x:t.x1,y:t.y1},r={x:t.x2,y:t.y2},o={x:t.x,y:t.y},s=mt.cubicBezierLength(n,mt.cubicBezierCoefficients({p0:n,cntrl1:i,cntrl2:r,p1:o}));h.stack.push({type:"C",p0:n,cntrl1:i,cntrl2:r,p1:o,length:s,pointAt(t){return mt.bezierTransition(this.p0,this.cntrl1,this.cntrl2,this.p1,t)}}),h.length+=s,bt(h.stack[h.stack.length-1],h.stack[h.stack.length-2],h.minMax,h.BBox)})),this.pp=this.cp,this.cntrl=null,this},fetchXY:function(){return{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:parseFloat(this.pathArr[this.currPathArr+=1])}}},Tt.prototype.points=function(t){if(void 0===this.f&&(this.f=.3),void 0===this.t&&(this.t=.6),0===t.length)return;this.m(!0,{x:t[0].x,y:t[0].y});var e=0,n=0,i=0;let r=0,o=0;for(var s=t[0],a=1;a<t.length;a++){var h=t[a],c=t[a+1];r=0,o=0,c&&(e=(c.y-s.y)/(c.x-s.x),r=(c.x-h.x)*-this.f,o=r*e*this.t),this.c(!0,{x:s.x-n,y:s.y-i},{x:h.x+r,y:h.y+o},{x:h.x,y:h.y}),n=r,i=o,s=h}},Tt.prototype.curveFfactor=function(t){this.f=t},Tt.prototype.curveTfactor=function(t){this.t=t},Tt.prototype.parse=function(t){for(this.path=t,this.currPathArr=-1,this.stack=[],this.length=0,this.pathArr=function(t){let e=t.replace(/e-/g,"$");e=e.replace(/ /g,","),e=e.replace(/-/g,",-"),e=e.split(/([a-zA-Z,])/g).filter((t=>""!==t&&","!==t)).map((t=>t.replace(/\$/g,"e-")));for(let t=0;t<e.length;t+=1)if(e[t].split(".").length>2){const n=e[t].split("."),i=[`${n[0]}.${n[1]}`];for(let t=2;t<n.length;t+=1)i.push("."+n[t]);e.splice(t,1,i[0],i[1])}return e}(this.path),this.stackGroup=[];this.currPathArr<this.pathArr.length-1;)this.case(this.pathArr[this.currPathArr+=1]);return this.stack},Tt.prototype.fetchPathString=function(){let t,e="";for(let n=0;n<this.stack.length;n++)t=this.stack[n],"M"===t.type||"m"===t.type?e+=t.type+" "+t.p0.x+","+t.p0.y+" ":"Z"===t.type||"z"===t.type?e+="z":"C"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"c"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"Q"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.p1.x+","+t.p1.y+" ":"q"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"S"===t.type?e+=t.type+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"s"===t.type?e+=t.type+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"V"===t.type?e+=t.type+" "+t.p1.y+" ":"v"===t.type?e+=t.type+" "+t.relative.p1.y+" ":"H"===t.type?e+=t.type+" "+t.p1.x+" ":"h"===t.type?e+=t.type+" "+t.relative.p1.x+" ":"L"===t.type?e+=t.type+" "+t.p1.x+","+t.p1.y+" ":"l"===t.type&&(e+=t.type+" "+t.relative.p1.x+","+t.relative.p1.y+" ");return e},Tt.prototype.getTotalLength=function(){return this.length},Tt.prototype.getAngleAtLength=function(t,e){if(t>this.length)return null;const n=this.getPointAtLength(t),i=this.getPointAtLength(t+("src"===e?-1*t*.01:.01*t));return Math.atan2(i.y-n.y,i.x-n.x)},Tt.prototype.getPointAtLength=function(t){let e={x:0,y:0},n=t;return this.stack.every(((t,i)=>(n-=t.length,Math.floor(n)>=0||(e=t.pointAt((t.length+n)/(0===t.length?1:t.length)),!1)))),e},Tt.prototype.execute=function(t,e){let n;e||t.beginPath();for(let e=0;e<this.stack.length;e++)switch(n=this.stack[e],n.type){case"M":case"m":t.moveTo(n.p0.x,n.p0.y);break;case"Z":case"z":t.lineTo(n.p1.x,n.p1.y);break;case"L":case"l":case"V":case"v":case"H":case"h":t.lineTo(n.p1.x,n.p1.y);break;case"C":case"c":case"S":case"s":t.bezierCurveTo(n.cntrl1.x,n.cntrl1.y,n.cntrl2.x,n.cntrl2.y,n.p1.x,n.p1.y);break;case"Q":case"q":t.quadraticCurveTo(n.cntrl1.x,n.cntrl1.y,n.p1.x,n.p1.y)}e||t.closePath()},Tt.prototype.getPoints=function(t=.01){const e=[];let n;for(let t=0;t<this.stack.length;t++){n=this.stack[t];const i=.05;let r=0;switch(n.type){case"M":case"m":e[e.length]=n.p0.x,e[e.length]=n.p0.y;break;case"Z":case"z":e[e.length]=n.p1.x,e[e.length]=n.p1.y;break;case"L":case"l":case"V":case"v":case"H":case"h":e[e.length]=n.p1.x,e[e.length]=n.p1.y;break;case"C":case"c":case"S":case"s":case"Q":case"q":for(;r<=1;){const t=n.pointAt(r);e[e.length]=t.x,e[e.length]=t.y,r+=i}}}return e},Tt.prototype.case=function(t){let e,n,i,r,o,s=t;switch(-1!==["m","M","v","V","l","L","h","H","q","Q","c","C","s","S","a","A","z","Z"].indexOf(s)?this.PC=s:(s=this.PC,this.currPathArr=this.currPathArr-1),s){case"m":this.m(!1,this.fetchXY());break;case"M":this.m(!0,this.fetchXY());break;case"v":this.v(!1,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"V":this.v(!0,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"l":this.l(!1,this.fetchXY());break;case"L":this.l(!0,this.fetchXY());break;case"h":this.h(!1,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"H":this.h(!0,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"q":this.q(!1,this.fetchXY(),this.fetchXY());break;case"Q":this.q(!0,this.fetchXY(),this.fetchXY());break;case"c":this.c(!1,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"C":this.c(!0,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"s":this.s(!1,this.fetchXY(),this.fetchXY());break;case"S":this.s(!0,this.fetchXY(),this.fetchXY());break;case"a":e=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),this.a(!1,e,n,i,r,o,this.fetchXY());break;case"A":e=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),this.a(!0,e,n,i,r,o,this.fetchXY());break;case"z":case"Z":this.z()}};const Et=function(t,e,n,i,r,o){this.type=t,this.p0=e,this.c1_src=n,this.c2_src=i,this.co=r,this.length_src=o};Et.prototype.execute=function(t){const e=this.co,n=this.p0,i=this.c1_src,r=this.c2_src,o={x:n.x+(i.x-n.x)*t,y:n.y+(i.y-n.y)*t},s=i.x+(r.x-i.x)*t,a=i.y+(r.y-i.y)*t;return this.cntrl1=o,this.cntrl2={x:o.x+(s-o.x)*t,y:o.y+(a-o.y)*t},this.p1={x:e.ax*mt.pow(t,3)+e.bx*mt.pow(t,2)+e.cx*t+n.x,y:e.ay*mt.pow(t,3)+e.by*mt.pow(t,2)+e.cy*t+n.y},this.length=this.length_src*t,this.relative={cntrl1:kt(this.type)?this.cntrl1:Bt(this.cntrl1,this.p0),cntrl2:kt(this.type)?this.cntrl2:Bt(this.cntrl2,this.p0),p1:kt(this.type)?this.p1:Bt(this.p1,this.p0)},this},Et.prototype.pointAt=function(t){return mt.cubicBezierTransition(this.p0,this.co,t)};const St=function(t,e,n,i,r,o){this.type=t,this.p0=e,this.p1_src=n,this.p2_src=i,this.length_src=r,this.length=0};St.prototype.execute=function(t){const e=this.p0,n=this.p1_src,i=this.p2_src;return this.length=this.length_src*t,this.cntrl1={x:e.x+(n.x-e.x)*t,y:e.y+(n.y-e.y)*t},this.cntrl2=this.cntrl1,this.p1={x:(e.x-2*n.x+i.x)*t*t+(2*n.x-2*e.x)*t+e.x,y:(e.y-2*n.y+i.y)*t*t+(2*n.y-2*e.y)*t+e.y},this.relative={cntrl1:kt(this.type)?this.cntrl1:Bt(this.cntrl1,this.p0),p1:kt(this.type)?this.p1:Bt(this.p1,this.p0)},this},St.prototype.pointAt=function(t){return mt.bezierTransition(this.p0,this.cntrl1,this.p1,t)};const Ct=function(t,e,n,i,r){this.type=t,this.p0=e,this.p1=e,this.p2_src=n,this.length_src=i,this.length=0};function Dt(t){return t instanceof Tt}Ct.prototype.execute=function(t){const e=this.p0,n=this.p2_src;return this.p1={x:e.x+(n.x-e.x)*t,y:e.y+(n.y-e.y)*t},this.length=this.length_src*t,this.relative={p1:kt(this.type)?this.p1:Bt(this.p1,this.p0)},this},Ct.prototype.pointAt=function(t){return mt.linearTransitionBetweenPoints(this.p0,this.p1,t)};var Mt={instance:function(t){return new Tt(t)},isTypePath:Dt,animatePathTo:function(t){const e=this,{duration:n,ease:i,end:r,loop:o,direction:s,d:a}=t,h=a||e.attr.d;let c=0;if(e.arrayStack=[],!h)throw Error("Path Not defined");const l=yt.sequenceChain(),p=Dt(h)?h:new Tt(h),f=p.stackGroup.reduce(((t,e)=>t=t.concat(e)),[]),u=[];for(let t=0;t<f.length;t+=1)if("Z"===f[t].type||"z"===f[t].type)u.push({run(t){p.stack.length=this.id+1,p.stack[this.id]=this.render.execute(t),e.setAttr("d",p)},target:e,id:t,render:new Ct(f[t].type,f[t].p0,f[0].p0,f[t].segmentLength),length:f[t].length}),c+=0;else if(-1!==["V","v","H","h","L","l"].indexOf(f[t].type))u.push({run(t){p.stack.length=this.id+1,p.stack[this.id]=this.render.execute(t),e.setAttr("d",p)},target:e,id:t,render:new Ct(f[t].type,f[t].p0,f[t].p1,f[t].length),length:f[t].length}),c+=f[t].length;else if("Q"===f[t].type||"q"===f[t].type)u.push({run(t){p.stack.length=this.id+1,p.stack[this.id]=this.render.execute(t),e.setAttr("d",p)},target:e,id:t,render:new St(f[t].type,f[t].p0,f[t].cntrl1,f[t].p1,f[t].length),length:f[t].length}),c+=f[t].length;else if("C"===f[t].type||"S"===f[t].type||"c"===f[t].type||"s"===f[t].type){const n=mt.cubicBezierCoefficients(f[t]);u.push({run(t){p.stack.length=this.id+1,p.stack[this.id]=this.render.execute(t),e.setAttr("d",p)},target:e,id:t,co:n,render:new Et(f[t].type,f[t].p0,f[t].cntrl1,f[t].cntrl2,n,f[t].length),length:f[t].length}),c+=f[t].length}else"M"!==f[t].type&&"m"!==f[t].type||(u.push({run(){p.stack.length=this.id+1,p.stack[this.id]={type:"M",p0:f[t].p0,length:0,pointAt(t){return this.p0}}},target:e,id:t,length:0}),c+=0);return u.forEach((function(t){t.duration=t.length/c*n})),l.add(u).ease(i).loop(o||0).direction(s||"default"),"function"==typeof r&&l.end(r.bind(e)),l.commit(),this},morphTo:function(t){const e=this,{duration:n}=t,{ease:i}=t,r=t.loop?t.loop:0,o=t.direction?t.direction:"default",s=t.attr.d?t.attr.d:e.attr.d;let a=Dt(e.attr.d)?e.attr.d.stackGroup:new Tt(e.attr.d).stackGroup,h=Dt(s)?s.stackGroup:new Tt(s).stackGroup;const c=[];e.arrayStack=[],a.length>1&&(a=a.sort(((t,e)=>e.segmentLength-t.segmentLength))),h.length>1&&(h=h.sort(((t,e)=>e.segmentLength-t.segmentLength)));const l=a.length>h.length?a.length:h.length;b(p(a[0]),p(h[0]));for(let t=1;t<l;t+=1)a[t]&&b(p(a[t]),[{type:"M",p0:a[t][0].p0}]),h[t]&&b([{type:"M",p0:h[t][0].p0}],p(h[t]));function p(t){if(!t.length)return;const e=t,n=[];for(let t=0;t<e.length;t+=1)if(-1!==["M","C","S","Q"].indexOf(e[t].type))n.push(e[t]);else if(-1!==["V","H","L","Z"].indexOf(e[t].type)){const i={x:(e[t].p0.x+e[t].p1.x)/2,y:(e[t].p0.y+e[t].p1.y)/2};n.push({p0:e[t].p0,cntrl1:i,cntrl2:i,p1:e[t].p1,type:"C",length:e[t].length})}return n}function f(t,e){c.push({run(t,e){const n=this,i=n.ctrl1Transition(e),r=n.ctrl2Transition(e),o=n.destTransition(e);t.c(!0,{x:i.x,y:i.y},{x:r.x,y:r.y},{x:o.x,y:o.y})},srcTransition:mt.linearTransitionBetweenPoints.bind(null,t.p0,e.p0),ctrl1Transition:mt.linearTransitionBetweenPoints.bind(null,t.cntrl1,e.cntrl1),ctrl2Transition:mt.linearTransitionBetweenPoints.bind(null,t.cntrl2,e.cntrl2),destTransition:mt.linearTransitionBetweenPoints.bind(null,t.p1,e.p1)})}function u(t,e){if(t.length===e)return t;const n=t.reduce(((t,e)=>t+e.length),0),i=[];for(let r=0;r<t.length;r+=1){const o=t[r].length;let s=Math.floor(e/n*o);if(s<=1)i.push(t[r]);else{let e,n=t[r];for(;s>1;){const t=n;e=d([t.p0,t.cntrl1,t.cntrl2,t.p1].slice(0),1/s),i.push({p0:t.p0,cntrl1:e.b1[0],cntrl2:e.b1[1],p1:e.b1[2],type:"C"}),n={p0:e.b1[2],cntrl1:e.b2[0],cntrl2:e.b2[1],p1:e.b2[2],type:"C"},s-=1}i.push(n)}}return i}function d(t,e){const n=[],i=t;for(;i.length>0;){for(let t=0;t<i.length-1;t+=1)n.unshift(i[t]),i[t]=(r=i[t],o=i[t+1],s=e,{x:r.x+(o.x-r.x)*(void 0!==s?s:.5),y:r.y+(o.y-r.y)*(void 0!==s?s:.5)});n.unshift(i.pop())}var r,o,s;return{b1:[{x:n[5].x,y:n[5].y},{x:n[2].x,y:n[2].y},{x:n[0].x,y:n[0].y}],b2:[{x:n[1].x,y:n[1].y},{x:n[3].x,y:n[3].y},{x:n[6].x,y:n[6].y}]}}function y(t){let e=0;for(let n=0;n<t.length;n+=1)"M"!==t[n].type&&(e+=(t[n].p1.x-t[n].p0.x)*(t[n].p1.y+t[n].p0.y));return e}function x(t){const e=t.reverse(),n=[{type:"M",p0:e[0].p1}];return e.forEach((t=>{if("C"===t.type){const e=t,i=e.p0,r=e.cntrl1;e.p0=t.p1,e.p1=i,e.cntrl1=t.cntrl2,e.cntrl2=r,n.push(e)}})),n}function m(t){let e=0,n=0,i=0,r=0;return t.forEach((t=>{t.p0&&(e+=t.p0.x,n+=t.p0.y,i+=1,r+=1),t.p1&&(e+=t.p1.x,n+=t.p1.y,i+=1,r+=1)})),{x:e/i,y:n/r}}function g(t,e){return e.x>=t.x&&e.y<=t.y?1:e.x<=t.x&&e.y<=t.y?2:e.x<=t.x&&e.y>=t.y?3:4}function v(t,e){if(e<=0)return t;let n=t;const i=n.splice(0,e);return i.shift(),n=n.concat(i),n.unshift({type:"M",p0:n[0].p0}),n.push({type:"M",p0:n[0].p0}),n}function b(t,e){let n,i,r=t.length>e.length?t.length:e.length;e.length>2&&t.length>2?(r>50?r+=30:r=r>=20?r+15:r+4,n=u(t,r),i=u(e,r)):(n=t,i=e),y(n)<0&&(n=x(n)),y(i)<0&&(i=x(i));const o=function(t,e){const n=m(t),i=m(e),r=t,o=e;for(let e=0;e<t.length;e+=1)r[e].quad=g(n,t[e].p0);for(let t=0;t<e.length;t+=1)o[t].quad=g(i,e[t].p0);let s=0;return t.forEach(((t,e)=>{const i=mt.getDistance(t.p0,n);1===t.quad&&i>=s&&(s=i)})),s=0,e.forEach(((t,e)=>{const n=mt.getDistance(t.p0,i);1===t.quad&&n>s&&(s=n)})),{src:v(t,0),dest:v(e,0),srcCentroid:n,destCentroid:i}}(n,i);n=o.src.length>1?o.src:[{type:"M",p0:o.destCentroid}],i=o.dest.length>1?o.dest:[{type:"M",p0:o.srcCentroid}];const s=i.length<n.length?n.length:i.length;for(let t=0;t<n.length;t+=1)n[t].index=t;for(let t=0;t<i.length;t+=1)i[t].index=t;for(let t=0;t<s;t+=1){const e=n[n.length-1].p0?n[n.length-1].p0:n[n.length-1].p1,r=i[i.length-1].p0?i[i.length-1].p0:i[i.length-1].p1,o=n[t]?n[t]:{type:"C",p0:e,p1:e,cntrl1:e,cntrl2:e,length:0},s=i[t]?i[t]:{type:"C",p0:r,p1:r,cntrl1:r,cntrl2:r,length:0};"M"===o.type&&"M"===s.type?(a=o,h=s,c.push({run(t,e){const n=this.pointTansition(e);t.m(!0,{x:n.x,y:n.y})},pointTansition:mt.linearTransitionBetweenPoints.bind(null,a.p0,h.p0)})):"M"===o.type||"M"===s.type?"M"===o.type?f({type:"C",p0:o.p0,p1:o.p0,cntrl1:o.p0,cntrl2:o.p0,length:0},s):f(o,{type:"C",p0:s.p0,p1:s.p0,cntrl1:s.p0,cntrl2:s.p0,length:0}):f(o,s)}var a,h}gt.add((xt+=1,"morph_"+xt),{run(t){const n=new Tt;for(let e=0,i=c.length;e<i;e++)c[e].run(n,t);e.setAttr("d",n)},target:e,duration:n,loop:r,direction:o},vt(i))}};const _t={AliceBlue:"f0f8ff",AntiqueWhite:"faebd7",Aqua:"00ffff",Aquamarine:"7fffd4",Azure:"f0ffff",Beige:"f5f5dc",Bisque:"ffe4c4",Black:"000000",BlanchedAlmond:"ffebcd",Blue:"0000ff",BlueViolet:"8a2be2",Brown:"a52a2a",BurlyWood:"deb887",CadetBlue:"5f9ea0",Chartreuse:"7fff00",Chocolate:"d2691e",Coral:"ff7f50",CornflowerBlue:"6495ed",Cornsilk:"fff8dc",Crimson:"dc143c",Cyan:"00ffff",DarkBlue:"00008b",DarkCyan:"008b8b",DarkGoldenRod:"b8860b",DarkGray:"a9a9a9",DarkGrey:"a9a9a9",DarkGreen:"006400",DarkKhaki:"bdb76b",DarkMagenta:"8b008b",DarkOliveGreen:"556b2f",DarkOrange:"ff8c00",DarkOrchid:"9932cc",DarkRed:"8b0000",DarkSalmon:"e9967a",DarkSeaGreen:"8fbc8f",DarkSlateBlue:"483d8b",DarkSlateGray:"2f4f4f",DarkSlateGrey:"2f4f4f",DarkTurquoise:"00ced1",DarkViolet:"9400d3",DeepPink:"ff1493",DeepSkyBlue:"00bfff",DimGray:"696969",DimGrey:"696969",DodgerBlue:"1e90ff",FireBrick:"b22222",FloralWhite:"fffaf0",ForestGreen:"228b22",Fuchsia:"ff00ff",Gainsboro:"dcdcdc",GhostWhite:"f8f8ff",Gold:"ffd700",GoldenRod:"daa520",Gray:"808080",Grey:"808080",Green:"008000",GreenYellow:"adff2f",HoneyDew:"f0fff0",HotPink:"ff69b4",IndianRed:"cd5c5c",Indigo:"4b0082",Ivory:"fffff0",Khaki:"f0e68c",Lavender:"e6e6fa",LavenderBlush:"fff0f5",LawnGreen:"7cfc00",LemonChiffon:"fffacd",LightBlue:"add8e6",LightCoral:"f08080",LightCyan:"e0ffff",LightGoldenRodYellow:"fafad2",LightGray:"d3d3d3",LightGrey:"d3d3d3",LightGreen:"90ee90",LightPink:"ffb6c1",LightSalmon:"ffa07a",LightSeaGreen:"20b2aa",LightSkyBlue:"87cefa",LightSlateGray:"778899",LightSlateGrey:"778899",LightSteelBlue:"b0c4de",LightYellow:"ffffe0",Lime:"00ff00",LimeGreen:"32cd32",Linen:"faf0e6",Magenta:"ff00ff",Maroon:"800000",MediumAquaMarine:"66cdaa",MediumBlue:"0000cd",MediumOrchid:"ba55d3",MediumPurple:"9370db",MediumSeaGreen:"3cb371",MediumSlateBlue:"7b68ee",MediumSpringGreen:"00fa9a",MediumTurquoise:"48d1cc",MediumVioletRed:"c71585",MidnightBlue:"191970",MintCream:"f5fffa",MistyRose:"ffe4e1",Moccasin:"ffe4b5",NavajoWhite:"ffdead",Navy:"000080",OldLace:"fdf5e6",Olive:"808000",OliveDrab:"6b8e23",Orange:"ffa500",OrangeRed:"ff4500",Orchid:"da70d6",PaleGoldenRod:"eee8aa",PaleGreen:"98fb98",PaleTurquoise:"afeeee",PaleVioletRed:"db7093",PapayaWhip:"ffefd5",PeachPuff:"ffdab9",Peru:"cd853f",Pink:"ffc0cb",Plum:"dda0dd",PowderBlue:"b0e0e6",Purple:"800080",RebeccaPurple:"663399",Red:"ff0000",RosyBrown:"bc8f8f",RoyalBlue:"4169e1",SaddleBrown:"8b4513",Salmon:"fa8072",SandyBrown:"f4a460",SeaGreen:"2e8b57",SeaShell:"fff5ee",Sienna:"a0522d",Silver:"c0c0c0",SkyBlue:"87ceeb",SlateBlue:"6a5acd",SlateGray:"708090",SlateGrey:"708090",Snow:"fffafa",SpringGreen:"00ff7f",SteelBlue:"4682b4",Tan:"d2b48c",Teal:"008080",Thistle:"d8bfd8",Tomato:"ff6347",Turquoise:"40e0d0",Violet:"ee82ee",Wheat:"f5deb3",White:"ffffff",WhiteSmoke:"f5f5f5",Yellow:"ffff00",YellowGreen:"9acd32"},zt=Math.round;var It="rgba(0,0,0,0)";function Pt(t,e,n,i){this.r=t,this.g=e,this.b=n,this.a=void 0===i?255:i,this.rgba=`rgba(${t},${e},${n},${i})`}function Ot(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((t,e,n,i)=>e+e+n+n+i+i));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return new Pt(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),255)}function Lt(t){var e,n,i,r,o,s,a;const h=t.replace(/[^0-9.,]+/g,"").split(",").map((function(t){return parseFloat(t)}));if(o=h[0]/360,s=h[1]/100,a=h[2]/100,r=h[3],0===s)e=n=i=a;else{var c=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},l=a<.5?a*(1+s):a+s-a*s,p=2*a-l;e=255*c(p,l,o+1/3),n=255*c(p,l,o),i=255*c(p,l,o-1/3)}return new Pt(e,n,i,r)}function Nt(t){return t instanceof Pt?t:t.startsWith("#")?Ot(t):t.startsWith("rgb")?function(t){const e=t.replace(/[^0-9.,]+/g,"").split(","),n={},i=["r","g","b","a"];for(let t=0;t<e.length;t+=1)n[i[t]]=parseFloat(e[t]);return new Pt(n.r,n.g,n.b,n.a)}(t):t.startsWith("hsl")?Lt(t):{r:0,g:0,b:0,a:255}}Pt.prototype.normalize=function(){return this.normalFlag||(this.r/=255,this.g/=255,this.b/=255,this.a/=255,this.normalFlag=!0),this};var Ft={nameToHex:function(t){return _t[t]?"#"+_t[t]:"#000"},hexToRgb:Ot,rgbToHex:function(t){const e=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")).split(",");return"#"+((1<<24)+(parseInt(e[0],10)<<16)+(parseInt(e[1],10)<<8)+parseInt(e[2],10)).toString(16).slice(1)},hslToRgb:Lt,transition:function(t,e){return e=e||It,t=Nt(t=t||It),e=Nt(e),function(n){return new Pt(zt(t.r+(e.r-t.r)*n),zt(t.g+(e.g-t.g)*n),zt(t.b+(e.b-t.b)*n),zt(t.a+(e.a-t.a)*n))}},colorToRGB:Nt,rgba:function(t,e,n,i){return new Pt(t,e,n,i)},isTypeColor:function(t){return t instanceof Pt||t.startsWith("#")||t.startsWith("rgb")||t.startsWith("hsl")},RGBAInstanceCheck:function(t){return t instanceof Pt}};function Rt(t){this.vDom=t,this.disable=!1,this.dragNode=null,this.touchNode=null,this.wheelNode=null,this.pointers=[]}function jt(t,e,n){if(t.dom.parent)return t.dom.parent.events[e]&&t.dom.parent.events[e](t.dom.parent,n),jt(t.dom.parent,e,n)}let Xt;Rt.prototype.getNode=function(t){},Rt.prototype.addPointer=function(t){this.pointers.push(t)},Rt.prototype.removePointer=function(t){const e=this,n=this.pointers;let i=-1;for(var r=0;r<n.length;r++)if(t.pointerId===n[r].pointerId){i=r;break}-1!==i&&(e.pointers=[],e.distance=0,this.pointerNode&&this.pointerNode.node.events.zoom&&this.pointerNode.node.events.zoom.onZoomEnd(this.pointerNode.node,t,e))},Rt.prototype.clickCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"click")},Rt.prototype.dblclickCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"dblclick")},Rt.prototype.pointerdownCheck=function(t){const e=this,n=Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"pointerdown");!n||this.pointerNode&&this.pointerNode.node===n?this.pointerNode&&(this.pointerNode.clickCounter+=1):this.pointerNode={node:n,clickCounter:1,dragCounter:0},n&&(n.events.zoom||n.events.drag)?(n.events.zoom&&n.events.zoom.panFlag&&n.events.zoom.panExecute(n,t,"pointerdown",e),n.events.drag&&n.events.drag.execute(n,t,"pointerdown",e)):n&&"touch"===t.pointerType&&n.events.mouseover.call(n,t)},Rt.prototype.pointermoveCheck=function(t){const e=this,n=this.pointerNode?this.pointerNode.node:null;n?(this.pointerNode.dragCounter+=1,n.events.zoom&&(n.events.zoom.panFlag&&n.events.zoom.panExecute(n,t,"pointermove",e),n.events.zoom.zoomPinch(n,t,e)),n.events.drag&&n.events.drag.execute(n,t,"pointermove",e),n.events.mousemove&&n.events.mousemove.call(n,t)):n&&"touch"===t.pointerType&&n.events.mousemove.call(n,t),t.preventDefault()},Rt.prototype.pointerupCheck=function(t){const e=this,n=this.pointerNode?this.pointerNode.node:null;n&&(n.events.drag&&n.events.drag.execute(n,t,"pointerup",e),n.events.zoom&&n.events.zoom.panFlag&&n.events.zoom.panExecute(n,t,"pointerup",e),this.pointerNode.dragCounter<=2||"touch"===t.pointerType&&this.pointerNode.dragCounter<=5?(n.events.click&&n.events.click.call(n,t),jt(n,"click",t),2===this.pointerNode.clickCounter&&(n.events.dblclick&&n.events.dblclick.call(n,t),jt(n,"dblclick",t)),Xt&&clearTimeout(Xt),Xt=setTimeout((function(){e.pointerNode=null,Xt=null}),200)):this.pointerNode=null,"touch"===t.pointerType&&n.events.mouseup.call(n,t))},Rt.prototype.mousedownCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mousedown")},Rt.prototype.mousemoveCheck=function(t){const e=Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mousemove");this.selectedNode&&this.selectedNode!==e&&(this.selectedNode.events.mouseout&&this.selectedNode.events.mouseout.call(this.selectedNode,t),this.selectedNode.events.mouseleave&&this.selectedNode.events.mouseleave.call(this.selectedNode,t)),e&&(e.events.mouseover||e.events.mousein)&&this.selectedNode!==e&&(e.events.mouseover&&e.events.mouseover.call(e,t),e.events.mousein&&e.events.mousein.call(e,t)),this.selectedNode=e,t.preventDefault()},Rt.prototype.mouseupCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mouseup")},Rt.prototype.mouseleaveCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mouseleave")},Rt.prototype.contextmenuCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"contextmenu")},Rt.prototype.touchstartCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"touchstart")},Rt.prototype.touchendCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"touchend")},Rt.prototype.touchmoveCheck=function(t){const e=t.touches;0!==e.length&&Ut([this.vDom],{x:e[0].clientX,y:e[0].clientY},t,"touchmove")},Rt.prototype.touchcancelCheck=function(t){Ut([this.vDom],{x:t.x,y:t.y},t,"touchcacel")};let Yt=0,Gt=0;function Ut(t,e,n,i){let r,o;for(var s=t.length-1;s>=0;s-=1){var a=t[s],h={x:e.x,y:e.y};if(a.bbox&&(Ht(a,h),a.in({x:h.x,y:h.y})&&(a.children&&a.children.length>0?(o=Ut(a.children,{x:h.x,y:h.y},n,i),o&&(r=o)):r=a,a.events[i]&&"function"==typeof a.events[i]&&a.events[i](n),r)))break}return r||"rootNode"!==a.attr.id||(r=a,a.events[i]&&"function"==typeof a.events[i]&&a.events[i](n)),r}function Ht(t,e){let n=0,i=0,r=1,o=1;const s=e;if(t.attr.transform&&t.attr.transform.translate&&([n,i]=t.attr.transform.translate,s.x-=n,s.y-=i),t.attr.transform&&t.attr.transform.scale&&(r=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,o=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:r,s.x/=r,s.y/=o),t.attr.transform&&t.attr.transform.rotate){const e=t.attr.transform.rotate[0],n={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]},i=s.x,r=s.y,o=n.x,l=n.y;var a=Math.PI/180*e,h=Math.cos(a),c=Math.sin(a);s.x=h*(i-o)+c*(r-l)+o,s.y=h*(r-l)-c*(i-o)+l}}Rt.prototype.wheelEventCheck=function(t){const e=this;if(this.wheelNode)this.wheelNode.events.zoom.zoomExecute(this.wheelNode,t,e),Yt+=1,this.wheelHndl&&(clearTimeout(this.wheelHndl),this.wheelHndl=null,Gt=Yt),this.wheelHndl=setTimeout((function(){Gt!==Yt?Gt=Yt:(e.wheelHndl=null,e.wheelNode.events.zoom.onZoomEnd(e.wheelNode,t,e),e.wheelNode=null,Yt=0)}),100);else{let n=Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"wheel");n=n||this.vDom,n&&n.events.zoom&&(n.events.zoom.disableWheel||(n.events.zoom.zoomExecute(n,t,e),this.wheelNode=n))}};var Vt,qt=[],Zt="ResizeObserver loop completed with undelivered notifications.";!function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(Vt||(Vt={}));var Wt,$t=function(){function t(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return t.prototype.toJSON=function(){var t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),Qt=function(t){return t instanceof SVGElement&&"getBBox"in t},Jt=function(t){if(Qt(t)){var e=t.getBBox(),n=e.width,i=e.height;return!n&&!i}var r=t,o=r.offsetWidth,s=r.offsetHeight;return!(o||s||t.getClientRects().length)},Kt=function(t){var e,n,i=null===(n=null===(e=t)||void 0===e?void 0:e.ownerDocument)||void 0===n?void 0:n.defaultView;return!!(i&&t instanceof i.Element)},te="undefined"!=typeof window?window:{},ee=new WeakMap,ne=/auto|scroll/,ie=/^tb|vertical/,re=/msie|trident/i.test(te.navigator&&te.navigator.userAgent),oe=function(t){return parseFloat(t||"0")},se=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=!1),Object.freeze({inlineSize:(n?e:t)||0,blockSize:(n?t:e)||0})},ae=Object.freeze({devicePixelContentBoxSize:se(),borderBoxSize:se(),contentBoxSize:se(),contentRect:new $t(0,0,0,0)}),he=function(t,e){if(void 0===e&&(e=!1),ee.has(t)&&!e)return ee.get(t);if(Jt(t))return ee.set(t,ae),ae;var n=getComputedStyle(t),i=Qt(t)&&t.ownerSVGElement&&t.getBBox(),r=!re&&"border-box"===n.boxSizing,o=ie.test(n.writingMode||""),s=!i&&ne.test(n.overflowY||""),a=!i&&ne.test(n.overflowX||""),h=i?0:oe(n.paddingTop),c=i?0:oe(n.paddingRight),l=i?0:oe(n.paddingBottom),p=i?0:oe(n.paddingLeft),f=i?0:oe(n.borderTopWidth),u=i?0:oe(n.borderRightWidth),d=i?0:oe(n.borderBottomWidth),y=p+c,x=h+l,m=(i?0:oe(n.borderLeftWidth))+u,g=f+d,v=a?t.offsetHeight-g-t.clientHeight:0,b=s?t.offsetWidth-m-t.clientWidth:0,w=r?y+m:0,B=r?x+g:0,A=i?i.width:oe(n.width)-w-b,T=i?i.height:oe(n.height)-B-v,k=A+y+b+m,E=T+x+v+g,S=Object.freeze({devicePixelContentBoxSize:se(Math.round(A*devicePixelRatio),Math.round(T*devicePixelRatio),o),borderBoxSize:se(k,E,o),contentBoxSize:se(A,T,o),contentRect:new $t(p,h,A,T)});return ee.set(t,S),S},ce=function(t,e,n){var i=he(t,n),r=i.borderBoxSize,o=i.contentBoxSize,s=i.devicePixelContentBoxSize;switch(e){case Vt.DEVICE_PIXEL_CONTENT_BOX:return s;case Vt.BORDER_BOX:return r;default:return o}},le=function(t){var e=he(t);this.target=t,this.contentRect=e.contentRect,this.borderBoxSize=[e.borderBoxSize],this.contentBoxSize=[e.contentBoxSize],this.devicePixelContentBoxSize=[e.devicePixelContentBoxSize]},pe=function(t){if(Jt(t))return 1/0;for(var e=0,n=t.parentNode;n;)e+=1,n=n.parentNode;return e},fe=function(){var t=1/0,e=[];qt.forEach((function(n){if(0!==n.activeTargets.length){var i=[];n.activeTargets.forEach((function(e){var n=new le(e.target),r=pe(e.target);i.push(n),e.lastReportedSize=ce(e.target,e.observedBox),r<t&&(t=r)})),e.push((function(){n.callback.call(n.observer,i,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var n=0,i=e;n<i.length;n++){(0,i[n])()}return t},ue=function(t){qt.forEach((function(e){e.activeTargets.splice(0,e.activeTargets.length),e.skippedTargets.splice(0,e.skippedTargets.length),e.observationTargets.forEach((function(n){n.isActive()&&(pe(n.target)>t?e.activeTargets.push(n):e.skippedTargets.push(n))}))}))},de=function(){var t=0;for(ue(t);qt.some((function(t){return t.activeTargets.length>0}));)t=fe(),ue(t);return qt.some((function(t){return t.skippedTargets.length>0}))&&function(){var t;"function"==typeof ErrorEvent?t=new ErrorEvent("error",{message:Zt}):((t=document.createEvent("Event")).initEvent("error",!1,!1),t.message=Zt),window.dispatchEvent(t)}(),t>0},ye=[],xe=function(t){if(!Wt){var e=0,n=document.createTextNode("");new MutationObserver((function(){return ye.splice(0).forEach((function(t){return t()}))})).observe(n,{characterData:!0}),Wt=function(){n.textContent=""+(e?e--:e++)}}ye.push(t),Wt()},me=0,ge={attributes:!0,characterData:!0,childList:!0,subtree:!0},ve=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],be=function(t){return void 0===t&&(t=0),Date.now()+t},we=!1,Be=new(function(){function t(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return t.prototype.run=function(t){var e=this;if(void 0===t&&(t=250),!we){we=!0;var n,i=be(t);n=function(){var n=!1;try{n=de()}finally{if(we=!1,t=i-be(),!me)return;n?e.run(1e3):t>0?e.run(t):e.start()}},xe((function(){requestAnimationFrame(n)}))}},t.prototype.schedule=function(){this.stop(),this.run()},t.prototype.observe=function(){var t=this,e=function(){return t.observer&&t.observer.observe(document.body,ge)};document.body?e():te.addEventListener("DOMContentLoaded",e)},t.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),ve.forEach((function(e){return te.addEventListener(e,t.listener,!0)})))},t.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),ve.forEach((function(e){return te.removeEventListener(e,t.listener,!0)})),this.stopped=!0)},t}()),Ae=function(t){!me&&t>0&&Be.start(),!(me+=t)&&Be.stop()},Te=function(){function t(t,e){this.target=t,this.observedBox=e||Vt.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){var t,e=ce(this.target,this.observedBox,!0);return t=this.target,Qt(t)||function(t){switch(t.tagName){case"INPUT":if("image"!==t.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(t)||"inline"!==getComputedStyle(t).display||(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},t}(),ke=function(t,e){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=e},Ee=new WeakMap,Se=function(t,e){for(var n=0;n<t.length;n+=1)if(t[n].target===e)return n;return-1},Ce=function(){function t(){}return t.connect=function(t,e){var n=new ke(t,e);Ee.set(t,n)},t.observe=function(t,e,n){var i=Ee.get(t),r=0===i.observationTargets.length;Se(i.observationTargets,e)<0&&(r&&qt.push(i),i.observationTargets.push(new Te(e,n&&n.box)),Ae(1),Be.schedule())},t.unobserve=function(t,e){var n=Ee.get(t),i=Se(n.observationTargets,e),r=1===n.observationTargets.length;i>=0&&(r&&qt.splice(qt.indexOf(n),1),n.observationTargets.splice(i,1),Ae(-1))},t.disconnect=function(t){var e=this,n=Ee.get(t);n.observationTargets.slice().forEach((function(n){return e.unobserve(t,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},t}(),De=function(){function t(t){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof t)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Ce.connect(this,t)}return t.prototype.observe=function(t,e){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Kt(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Ce.observe(this,t,e)},t.prototype.unobserve=function(t){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Kt(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Ce.unobserve(this,t)},t.prototype.disconnect=function(){Ce.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}();let Me=0;const _e=F,ze=J,Ie=x,Pe=window.ResizeObserver||De;const Oe=function(t,e,n){return function(i){t.setAttr(e,n.call(t,i))}},Le=function(t,e,n){const i=[],r=t.attr.transform;return"function"==typeof n?function(i){t[e](n.call(t,i))}:(n.forEach(((t,n)=>{let o;o=r[e]&&void 0!==r[e][n]?r[e][n]:"scale"===e?1:0,i.push(_e.intermediateValue.bind(null,o,t))})),function(n){t[e](i.map((t=>t(n))))})},Ne=function(t,e,n){const i=t.attr[e];return function(r){t.setAttr(e,_e.intermediateValue(i,n,r))}},Fe=function(t,e,n){let i,r,o;if("function"==typeof n)return function(i){t.setStyle(e,n.call(t,t.dataObj,i))};if(i=t.style[e],isNaN(n)){if(Ft.isTypeColor(n)){const r=Ft.transition(i,n);return function(n){t.setStyle(e,r(n))}}i=i.match(/(\d+)/g),o=n.match(/(\d+)/g),r=n.match(/\D+$/),i=parseInt(i.length>0?i[0]:0,10),o=parseInt(o.length>0?o[0]:0,10),r=r.length>0?r[0]:"px"}else i=void 0!==t.style[e]?t.style[e]:1,o=n,r=0;return function(n){t.setStyle(e,_e.intermediateValue(i,o,n)+r)}},Re=function(t,e){const n=e.attr?e.attr:{},i=e.style?e.style:{},r=[];let o;if("function"!=typeof n)for(const i in n)if("transform"!==i){const o=n[i];"function"==typeof o?r[r.length]=function(e){t.setAttr(i,o.call(t,e))}:"d"===i?t.morphTo(e):r[r.length]=Ne(t,i,n[i])}else if(o=n[i],"function"==typeof o)r[r.length]=Oe(t,i,o);else{t.attr.transform||(t.attr.transform={});const e=Object.keys(n.transform);for(let i=0,o=e.length;i<o;i+=1)r[r.length]=Le(t,e[i],n.transform[e[i]])}else r[r.length]=n.bind(t);if("function"!=typeof i)for(const e in i)r[r.length]=Fe(t,e,i[e]);else r[r.length]=i.bind(t);return{run(t){for(let e=0,n=r.length;e<n;e+=1)r[e](t)},target:t,duration:e.duration,delay:e.delay?e.delay:0,end:e.end?e.end.bind(t,t.dataObj):null,loop:e.loop?e.loop:0,direction:e.direction?e.direction:"default",ease:e.ease?e.ease:"default"}};function je(t,e,n){const i=t.map(n),r={new:[],update:[],old:[]};for(let o=0;o<e.length;o+=1){const s=i.indexOf(n(e[o].dataObj,o));-1!==s?(e[o].dataObj=t[s],r.update.push(e[o]),i[s]=null):r.old.push(e[o])}return r.new=t.filter(((t,e)=>{const r=i.indexOf(n(t,e));return-1!==r&&(i[r]=null,!0)})),r}const Xe={};Xe.push={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(let e=0,n=t.length;e<n;e++)this.data.push(t[e]);if(this.config.action.enter){const e={};this.selector.split(",").forEach((function(n){e[n]=t})),this.config.action.enter.call(this,e)}},enumerable:!1,configurable:!1,writable:!1},Xe.pop={value:function(){const t=this,e=this.data.pop();if(this.config.action.exit){const n={};this.selector.split(",").forEach((function(i){n[i]=t.fetchEls(i,[e])})),this.config.action.exit.call(this,n)}},enumerable:!1,configurable:!1,writable:!1},Xe.remove={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);const e=this;for(let e=0,n=t.length;e<n;e++)-1!==this.data.indexOf(t[e])&&this.data.splice(this.data.indexOf(t[e]),1);if(this.config.action.exit){const n={};this.selector.split(",").forEach((function(i){n[i]=e.fetchEls(i,t)})),this.config.action.exit.call(this,n)}},enumerable:!1,configurable:!0,writable:!1},Xe.update={value:function(){const t=this;if(this.config.action.update){const e={};this.selector.split(",").forEach((function(n){e[n]=t.fetchEls(n,t.data)})),this.config.action.update.call(this,e)}},enumerable:!1,configurable:!0,writable:!1},Xe.join={value:function(t){this.data=t,Ge.call(this,t,this.selector,this.config)},enumerable:!1,configurable:!0,writable:!1};var Ye=function(){};function Ge(t,e,n){const i=this,r=e.split(",");let{joinOn:o}=n;const s={new:{},update:{},old:{}};o||(o=function(t,e){return e});for(let e=0,n=r.length;e<n;e++){const n=r[e],a=je(t,i.fetchEls(n).stack,o);s.new[n]=a.new,s.update[n]=(new He).wrapper(a.update),s.old[n]=(new He).wrapper(a.old)}return n.action&&(n.action.enter&&n.action.enter.call(i,s.new),n.action.exit&&n.action.exit.call(i,s.old),n.action.update&&n.action.update.call(i,s.update)),Xe.config={value:n,enumerable:!1,configurable:!0,writable:!0},Xe.selector={value:e,enumerable:!1,configurable:!0,writable:!1},Xe.data={value:t,enumerable:!1,configurable:!0,writable:!0},Object.create(i,Xe)}function Ue(t,e,n){const i={};let r;for(r in t)"end"!==r&&("function"==typeof t[r]?i[r]=t[r].call(e,e.dataObj,n):i[r]=t[r]);return i}Ye.prototype.getAttr=function(t){return this.attr[t]},Ye.prototype.getStyle=function(t){return this.style[t]},Ye.prototype.exec=function(t){return"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,this.dataObj),this},Ye.prototype.fetchEls=function(t,e){const n=[],i=new He;if(this.children.length>0)if("."===t.charAt(0)){const i=t.substring(1,t.length);this.children.forEach((t=>{const r=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.class===i,o=!e&&t.attr.class===i;(r||o)&&n.push(t)}))}else if("#"===t.charAt(0)){const i=t.substring(1,t.length);this.children.every((t=>{const r=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.id===i,o=!e&&t.attr.id===i;return!r&&!o||(n.push(t),!1)}))}else t="group"===t?"g":t,this.children.forEach((i=>{const r=e&&i.dataObj&&-1!==e.indexOf(i.dataObj)&&i.nodeName===t,o=!e&&i.nodeName===t;(r||o)&&n.push(i)}));return i.wrapper(n)},Ye.prototype.fetchEl=function(t,e){let n;if(this.children.length>0)if("."===t.charAt(0)){const i=t.substring(1,t.length);this.children.every((t=>{const r=e&&t.dataObj&&e===t.dataObj&&t.attr.class===i,o=!e&&t.attr.class===i;return!r&&!o||(n=t,!1)}))}else if("#"===t.charAt(0)){const i=t.substring(1,t.length);this.children.every((t=>{const r=e&&t.dataObj&&e===t.dataObj&&t.attr.id===i,o=!e&&t.attr.id===i;return!r&&!o||(n=t,!1)}))}else t="group"===t?"g":t,this.children.forEach((i=>{const r=e&&i.dataObj&&e===i.dataObj&&i.nodeName===t,o=!e&&i.nodeName===t;(r||o)&&(n=i)}));return n},Ye.prototype.join=Ge,Ye.prototype.data=function(t){return t?(this.dataObj=t,this):this.dataObj},Ye.prototype.interrupt=function(){if(this.animList&&this.animList.length>0)for(var t=this.animList.length-1;t>=0;t--)Ie.remove(this.animList[t]);return this.animList=[],this},Ye.prototype.animateTo=function(t){return Ie.add((Me+=1,Me),Re(this,t),ze(t.ease)),this},Ye.prototype.animateExe=function(t){return Re(this,t)};function He(t,e,n,i){let r,o;e||(e=[]);const s=n&&n.attr?Object.keys(n.attr):[],a=n&&n.style?Object.keys(n.style):[],h=!n||(void 0===n.bbox||n.bbox);return this.stack=e.map(((e,c)=>{const l=this.createNode(t.ctx,{el:n.el,bbox:h},i);for(let t=0,i=a.length;t<i;t+=1)if(o=a[t],"function"==typeof n.style[o]){const t=n.style[o].call(l,e,c);l.setStyle(o,t)}else l.setStyle(o,n.style[o]);for(let t=0,i=s.length;t<i;t+=1)if(o=s[t],"transform"!==o)if("function"==typeof n.attr[o]){const t=n.attr[o].call(l,e,c);l.setAttr(o,t)}else l.setAttr(o,n.attr[o]);else{"function"==typeof n.attr.transform?r=n.attr[o].call(l,e,c):({transform:r}=n.attr);for(const t in r)l[t](r[t])}return l.dataObj=e,l})),this}He.prototype={createEls:function(t,e){let n;const i=[];let r=t;for(let o=0,s=this.stack.length;o<s;o+=1){let s={};if(n=this.stack[o],"function"==typeof t&&(r=t.call(n,n.dataObj,o)),"function"==typeof e)s=e.call(n,n.dataObj,o);else{const t=Object.keys(e);for(let n=0,i=t.length;n<i;n+=1){const i=t[n];s[i]=e[i]}}i.push(n.createEls(r,s))}const o=new He;return o.wrapper(i),o},createEl:function(t){let e;const n=[];for(let i=0,r=this.stack.length;i<r;i+=1){let r={};if(e=this.stack[i],"function"==typeof t)r=t.call(e,e.dataObj,i);else{const e=Object.keys(t);for(let n=0,i=e.length;n<i;n+=1){const i=e[n];"object"!=typeof t[i]?r[i]=t[i]:r[i]=JSON.parse(JSON.stringify(t[i]))}}n.push(e.createEl(r))}const i=new He;return i.wrapper(n),i},forEach:function(t){for(let e=0,n=this.stack.length;e<n;e+=1)t.call(this.stack[e],this.stack[e].dataObj,e);return this},setAttr:function(t,e){let n;for(let i=0,r=this.stack.length;i<r;i+=1)if(n=this.stack[i],arguments.length>1)"function"==typeof e?n.setAttr(t,e.call(n,n.dataObj,i)):n.setAttr(t,e);else if("function"==typeof t)n.setAttr(t.call(n,n.dataObj,i));else{const e=Object.keys(t);for(let r=0,o=e.length;r<o;r+=1){const o=e[r];"function"==typeof t[o]?n.setAttr(o,t[o].call(n,n.dataObj,i)):n.setAttr(o,t[o])}}return this},fetchEls:function(t,e){let n;const i=[];for(let r=0;r<this.stack.length;r+=1)n=this.stack[r],i.push(n.fetchEls(t,e));const r=new He;return r.wrapper(i),r},setStyle:function(t,e){let n;for(let i=0,r=this.stack.length;i<r;i+=1)if(n=this.stack[i],arguments.length>1)"function"==typeof e?n.setStyle(t,e.call(n,n.dataObj,i)):n.setStyle(t,e);else{if("function"==typeof t)n.setStyle(t.call(n,n.dataObj,i));else{const e=Object.keys(t);for(let r=0,o=e.length;r<o;r+=1){const o=e[r];"function"==typeof t[o]?n.setStyle(o,t[o].call(n,n.dataObj,i)):n.setStyle(o,t[o])}}"function"==typeof t?n.setStyle(t.call(n,n.dataObj,i)):n.setStyle(t)}return this},translate:function(t){let e;for(let n=0,i=this.stack.length;n<i;n+=1)e=this.stack[n],"function"==typeof t?e.translate(t.call(e,e.dataObj,n)):e.translate(t);return this},rotate:function(t){let e;for(let n=0,i=this.stack.length;n<i;n+=1)e=this.stack[n],"function"==typeof t?e.rotate(t.call(e,e.dataObj,n)):e.rotate(t);return this},scale:function(t){let e;for(let n=0,i=this.stack.length;n<i;n+=1)e=this.stack[n],"function"==typeof t?e.scale(t.call(e,e.dataObj,n)):e.scale(t);return this},exec:function(t){let e;if("function"==typeof t){for(let n=0,i=this.stack.length;n<i;n+=1)e=this.stack[n],t.call(e,e.dataObj,n);return this}},animateTo:function(t){let e,n;for(let i=0;i<this.stack.length;i+=1)n={},e=this.stack[i],n=Ue(t,e,i),t.attr&&"function"!=typeof t.attr&&(n.attr=Ue(t.attr,e,i)),t.style&&"function"!=typeof t.style&&(n.style=Ue(t.style,e,i)),t.end&&(n.end=t.end),t.ease&&(n.ease=t.ease),e.animateTo(n);return this},animateExe:function(t){let e,n;const i=[];for(let r=0;r<this.stack.length;r+=1)n={},e=this.stack[r],n=Ue(t,e,r),t.attr&&"function"!=typeof t.attr&&(n.attr=Ue(t.attr,e,r)),t.style&&"function"!=typeof t.style&&(n.style=Ue(t.style,e,r)),t.end&&(n.end=t.end),t.ease&&(n.ease=t.ease),i.push(e.animateExe(n));return i},animatePathTo:function(t){let e;const n=Object.keys(t);for(let i=0,r=this.stack.length;i<r;i+=1){e=this.stack[i];const r={};for(let o=0;o<n.length;o++){let s=t[n[o]];"function"==typeof s&&(s=s.call(e,e.dataObj,i)),r[n[o]]=s}e.animatePathTo(r)}return this},remove:function(){for(let t=0,e=this.stack.length;t<e;t+=1)this.stack[t].remove();return this},interrupt:function(){for(let t=0,e=this.stack.length;t<e;t+=1)this.stack[t].interrupt();return this},text:function(t){let e;if("function"!=typeof t)for(let n=0;n<this.stack.length;n+=1)e=this.stack[n],e.text(t);else for(let n=0;n<this.stack.length;n+=1)e=this.stack[n],e.text(t.call(e,e.dataObj,n));return this},join:function(t,e,n){let i;const r=[];for(let o=0;o<this.stack.length;o+=1)i=this.stack[o],r.push(i.join(t,e,n));const o=new He;return o.wrapper(r),o},on:function(t,e){for(let n=0,i=this.stack.length;n<i;n+=1)this.stack[n].on(t,e);return this}},He.prototype.createNode=function(){},He.prototype.wrapper=function(t){const e=this;if(t)for(let n=0,i=t.length;n<i;n++){const i=t[n];e.stack.push(i)}return this};const Ve=function(t){for(const e in t){const n=t[e],i=n.contentRect;n.target.resizeHandler&&n.target.resizeHandler.forEach((function(t){t(i)}))}};function qe(t,e){t.ro||(t.ro=new Pe(Ve),t.ro.observe(t.container)),t.container.resizeHandler||(t.container.resizeHandler=[]),t.container.resizeHandler.push(e)}function Ze(t,e){if(!t.container.resizeHandler)return;const n=t.container.resizeHandler.indexOf(e);-1!==n&&t.container.resizeHandler.splice(n,1),0===t.container.resizeHandler.length&&t.ro&&t.ro.disconnect()}const We=x;let $e=0;function Qe(){return $e+=1,$e}const Je=function(){He.apply(this,arguments)};function Ke(t,e={}){this.pDom=t;const n=e.id?e.id:"mask-"+Math.ceil(1e3*Math.random());this.id=e.id||n,e.id=n,this.defs||(this.defs=t.createEl({el:"defs"})),this.mask=this.defs.createEl({el:"mask",attr:e,style:{}})}function tn(t,e={}){this.pDom=t;const n=e.id?e.id:"clip-"+Math.ceil(1e3*Math.random());this.id=e.id||n,e.id=n,this.defs||(this.defs=t.createEl({el:"defs"})),this.clip=this.defs.createEl({el:"clipPath",attr:e,style:{}})}function en(t,e={}){this.pDom=t;const n=e.id?e.id:"pattern-"+Math.ceil(1e3*Math.random());this.id=e.id||n,e.id=n,this.defs||(this.defs=t.createEl({el:"defs"})),this.pattern=this.defs.createEl({el:"pattern",attr:e,style:{}})}function nn(t){let e="";for(const n in t)e+="rotate"===n?`${n}(${t.rotate[0]+" "+(t.rotate[1]||0)+" "+(t.rotate[2]||0)}) `:`${n}(${t[n].join(" ")}) `;return e}function rn(t,e,n){this.config=t,this.type=e||"linear",this.pDom=n,this.defs=this.pDom.createEl({el:"defs"})}(Je.prototype=new He).constructor=Je,Je.prototype.createNode=function(t,e,n){return an(e,n)},Ke.prototype.exe=function(){return`url(#${this.id})`},tn.prototype.exe=function(){return`url(#${this.id})`},en.prototype.exe=function(){return`url(#${this.id})`},rn.prototype.exe=function(){return`url(#${this.config.id})`},rn.prototype.linearGradient=function(){const t=this;return this.linearEl=this.defs.join([1],"linearGradient",{action:{enter(e){const n=this.createEls(e.linearGradient,{el:"linearGradient"}).setAttr({id:t.config.id,x1:t.config.x1+"%",y1:t.config.y1+"%",x2:t.config.x2+"%",y2:t.config.y2+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"});t.config.gradientTransform&&n.setAttr("gradientTransform",nn(t.config.gradientTransform))},exit(t){t.linearGradient.remove()},update(e){e.linearGradient.setAttr({id:t.config.id,x1:t.config.x1+"%",y1:t.config.y1+"%",x2:t.config.x2+"%",y2:t.config.y2+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"}),t.config.gradientTransform&&e.linearGradient.setAttr("gradientTransform",nn(t.config.gradientTransform))}}}),this.linearEl=this.linearEl.fetchEl("linearGradient"),this.linearEl.fetchEls("stop").remove(),this.linearEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:(t,e)=>t.value+"%","stop-color":function(t,e){return t.color}}}),this},rn.prototype.radialGradient=function(){const t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.radialEl=this.defs.join([1],"radialGradient",{action:{enter(e){const n=this.createEls(e.radialGradient,{el:"radialGradient"}).setAttr({id:t.config.id,cx:t.config.innerCircle.x+"%",cy:t.config.innerCircle.y+"%",r:t.config.outerCircle.r+"%",fx:t.config.outerCircle.x+"%",fy:t.config.outerCircle.y+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"});t.config.gradientTransform&&n.setAttr("gradientTransform",nn(t.config.gradientTransform))},exit(t){t.radialGradient.remove()},update(e){e.radialGradient.setAttr({id:t.config.id,cx:t.config.innerCircle.x+"%",cy:t.config.innerCircle.y+"%",r:t.config.outerCircle.r+"%",fx:t.config.outerCircle.x+"%",fy:t.config.outerCircle.y+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"}),t.config.gradientTransform&&e.radialGradient.setAttr("gradientTransform",nn(t.config.gradientTransform))}}}),this.radialEl=this.radialEl.fetchEl("radialGradient"),this.radialEl.fetchEls("stop").remove(),this.radialEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:(t,e)=>t.value+"%","stop-color":function(t,e){return t.color}}}),this},rn.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,"linear"===this.type?this.linearGradient():"radial"===this.type&&this.radialGradient())};const on={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},sn=function(t){return document.createElementNS(on.svg,t)};function an(t,e){let n=null;switch(t.el){case"group":n=sn("g");break;default:n=sn(t.el)}const i=new hn(n,t,Qe(),e);return t.dataObj&&(n.dataObj=t.dataObj),i}const hn=function(t,e,n,i){this.dom=t,this.nodeName=t.nodeName,this.attr={},this.style={},this.changedAttribute={},this.changedStyles={},this.id=n,this.nodeType="svg",this.dom.nodeId=n,this.children=[],this.vDomIndex=i,this.events={},e.style&&this.setStyle(e.style),e.attr&&this.setAttr(e.attr)};function cn(t,e){const n=e.indexOf(":"),i=t.changedAttribute[e];n>=0?t.dom.setAttributeNS(on[e.slice(0,n)],e.slice(n+1),i):"text"===e?t.dom.textContent=i:"d"===e?Mt.isTypePath(i)?t.dom.setAttribute(e,i.fetchPathString()):t.dom.setAttribute(e,i):"onerror"===e||"onload"===e?t.dom[e]=function(e){i.call(t,e)}:t.dom.setAttribute(e,i)}function ln(t){let e="";for(const n in t.attr.transform)e+="rotate"===n?`${n}(${t.attr.transform.rotate[0]+" "+(t.attr.transform.rotate[1]||0)+" "+(t.attr.transform.rotate[2]||0)}) `:`${n}(${t.attr.transform[n].join(" ")}) `;t.dom.setAttribute("transform",e)}function pn(t){if("[object Array]"===Object.prototype.toString.call(t))return t.reduce((function(t,e){return t+e.x+","+e.y+" "}),"")}hn.prototype=new Ye,hn.prototype.node=function(){return this.execute(),this.dom},hn.prototype.transFormAttributes=function(){const t=this;for(const e in t.changedAttribute)"transform"!==e?cn(t,e):ln(t);this.changedAttribute={}},hn.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.scale=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,We.vDomChanged(this.vDomIndex),this},hn.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,We.vDomChanged(this.vDomIndex),this},hn.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,We.vDomChanged(this.vDomIndex),this},hn.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,We.vDomChanged(this.vDomIndex),this},hn.prototype.rotate=function(t,e,n){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)&&t.length>0?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,n||0],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,We.vDomChanged(this.vDomIndex),this},hn.prototype.setStyle=function(t,e){if(2===arguments.length)null==e&&null!=this.style[t]?delete this.style[t]:("function"==typeof e&&(e=e.call(this,this.dataObj)),Ft.RGBAInstanceCheck(e)&&(e=e.rgba),this.style[t]=e),this.changedStyles[t]=e;else if(1===arguments.length&&"object"==typeof t)for(const e in t)null==t[e]&&null!=this.style[t]?delete this.style[e]:this.style[e]=t[e],this.changedStyles[e]=t[e];return this.styleChanged=!0,We.vDomChanged(this.vDomIndex),this},hn.prototype.setAttr=function(t,e){if(2===arguments.length)"points"===t&&(e=pn(e)),this.attr[t]=e,this.changedAttribute[t]=e;else if(1===arguments.length&&"object"==typeof t)for(const e in t)"points"===e&&(t[e]=pn(t[e])),this.attr[e]=t[e],this.changedAttribute[e]=t[e];return this.attrChanged=!0,We.vDomChanged(this.vDomIndex),this},hn.prototype.execute=function(){if(this.styleChanged||this.attrChanged){this.transFormAttributes();for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();for(const t in this.changedStyles)"object"==typeof this.changedStyles[t]&&(this.changedStyles[t]instanceof rn||this.changedStyles[t]instanceof en||this.changedStyles[t]instanceof tn||this.changedStyles[t]instanceof Ke)&&(this.changedStyles[t]=this.changedStyles[t].exe()),this.dom.style.setProperty(t,this.changedStyles[t],"");this.changedStyles={}}else for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute()},hn.prototype.child=function(t){const e=this.dom,n=this;if(t instanceof Je){var i=document.createDocumentFragment();for(let e=0,r=t.stack.length;e<r;e++)i.appendChild(t.stack[e].dom),t.stack[e].parentNode=n,this.children[this.children.length]=t.stack[e];e.appendChild(i)}else t instanceof hn?(e.appendChild(t.dom),t.parentNode=n,this.children.push(t)):console.log("wrong node type");return this},hn.prototype.animatePathTo=Mt.animatePathTo,hn.prototype.morphTo=Mt.morphTo,hn.prototype.createRadialGradient=function(t){const e=new rn(t,"radial",this);return e.radialGradient(),e},hn.prototype.createLinearGradient=function(t){const e=new rn(t,"linear",this);return e.linearGradient(),e},hn.prototype.on=function(t,e){const n=this;if(n.events[t]&&"drag"!==t&&"zoom"!==t&&(n.dom.removeEventListener(t,n.events[t]),delete n.events[t]),"drag"===t&&delete n.dom.drag_,"zoom"===t&&(n.dom.removeEventListener("wheel",n.events[t]),delete n.dom.drag_),e){if("drag"===t)n.dom.drag_=function(t,i){e.execute(n,t,i)};else if("zoom"===t){let i,r=0,o=0;n.events[t]=function(t){e.disableWheel||(e.zoomExecute(n,t),r+=1,i&&(clearTimeout(i),i=null,o=r),i=setTimeout((function(){o!==r?o=r:(i=null,e.onZoomEnd(n,t),r=0)}),100))},n.dom.addEventListener("wheel",n.events[t]),n.dom.drag_=function(t,i,r){e.panFlag&&e.panExecute(n,t,i,r)}}else{const i=e.bind(n);n.events[t]=function(t){i(t)},n.dom.addEventListener(t,n.events[t])}return this}},hn.prototype.html=function(t){return arguments.length?(this.dom.innerHTML(t),this):this.dom.innerHTML},hn.prototype.text=function(t){return arguments.length?(this.attr.text=t,this.changedAttribute.text=t,this):this.attr.text},hn.prototype.remove=function(){this.parentNode.removeChild(this)},hn.prototype.createEls=function(t,e){const n=new Je({type:"SVG"},t,e,this.vDomIndex);return this.child(n),We.vDomChanged(this.vDomIndex),n},hn.prototype.createEl=function(t){const e=an(t,this.vDomIndex);return this.child(e),We.vDomChanged(this.vDomIndex),e},hn.prototype.removeChild=function(t){const{children:e}=this,n=e.indexOf(t);if(-1!==n){const t=e.splice(n,1)[0].dom;if(!this.dom.contains(t))return;this.dom.removeChild(t)}};const fn=x,un=J;let dn=0;function yn(){return dn+=1,dn}function xn(t,{dx:e=0,dy:n=0},i){const r=t.transform.translate,[o,s=o]=t.transform.scale;return function(t,[e,n],i){return i[0]>=t[0][0]*e&&i[0]<=t[1][0]*e&&i[1]>=t[0][1]*n&&i[1]<=t[1][1]*n}(i,[o,s],[r[0]+e,r[1]+n])&&(e/=o,n/=s,t.dx=e,t.dy=n,r[0]/=o,r[1]/=s,r[0]+=e,r[1]+=n,r[0]*=o,r[1]*=s),t}const mn=function(){const t=this;this.dragStartFlag=!1,this.dragExtent=[[-1/0,-1/0],[1/0,1/0]],this.event={x:0,y:0,dx:0,dy:0,transform:{translate:[0,0],scale:[1,1]}},this.onDragStart=function(e,n){t.event.x=n.offsetX,t.event.y=n.offsetY,t.event.dx=0,t.event.dy=0,t.dragStartFlag=!0},this.onDrag=function(){},this.onDragEnd=function(){t.event.x=event.offsetX,t.event.y=event.offsetY,t.event.dx=0,t.event.dy=0,t.dragStartFlag=!1}};function gn(t,e){return e<=t[0]?t[0]:e>=t[1]?t[1]:e}function vn(t,e,n,i){return t.translate[0]/=e,t.translate[1]/=e,t.translate[0]-=i[0]/e-i[0]/n,t.translate[1]-=i[1]/e-i[1]/n,t.scale=[n,n],t.translate[0]*=n,t.translate[1]*=n,t}mn.prototype={dragExtent:function(t){return this.dragExtent=t,this},dragStart:function(t){const e=this;return"function"==typeof t&&(this.onDragStart=function(n,i){e.event.x=i.offsetX,e.event.y=i.offsetY,e.event.dx=0,e.event.dy=0,t.call(n,e.event),e.dragStartFlag=!0}),this},drag:function(t){const e=this;return"function"==typeof t&&(this.onDrag=function(n,i){const r=i.offsetX-e.event.x,o=i.offsetY-e.event.y;e.event.x=i.offsetX,e.event.y=i.offsetY,e.event=xn(this.event,{dx:r,dy:o},e.dragExtent),t.call(n,e.event)}),this},dragEnd:function(t){const e=this;return"function"==typeof t&&(this.onDragEnd=function(n,i){e.dragStartFlag=!1,e.event.x=i.offsetX,e.event.y=i.offsetY,e.event.dx=0,e.event.dy=0,t.call(n,e.event)}),this},bindMethods:function(t){const e=this;t.dragTo=function(n,i){e.dragTo(t,n,i)}},execute:function(t,e,n){const i=this;this.event.e=e,e.preventDefault&&e.preventDefault(),this.dragStartFlag||"mousedown"!==n&&"pointerdown"!==n?!this.onDragEnd||"mouseup"!==n&&"mouseleave"!==n&&"pointerleave"!==n&&"pointerup"!==n?this.onDrag&&i.onDrag(t,e):i.onDragEnd(t,e):i.onDragStart(t,e)}};const bn=function(){const t=this;this.event={x:0,y:0,dx:0,dy:0,distance:0},this.event.pointers=[],this.event.transform={translate:[0,0],scale:[1,1]},this.zoomBy_=.001,this.zoomExtent_=[0,1/0],this.zoomStartFlag=!1,this.zoomDuration=250,this.onZoomStart=function(e,n){t.event.x=n.offsetX,t.event.y=n.offsetY,t.event.dx=0,t.event.dy=0,t.zoomStartFlag=!0,t.event.distance=0},this.onZoom=function(e,n){t.event.x=n.offsetX,t.event.y=n.offsetY},this.onZoomEnd=function(e,n){t.event.x=n.offsetX,t.event.y=n.offsetY,t.event.dx=0,t.event.dy=0,t.zoomStartFlag=!1,t.event.distance=0},this.onPanStart=function(t,e){},this.onPan=function(t,e){},this.onPanEnd=function(){},this.disableWheel=!1,this.disableDbclick=!1};bn.prototype.zoomStart=function(t){const e=this;return"function"==typeof t&&(this.zoomStartExe=t,this.onZoomStart=function(n,i,r){if(r.pointers&&2===r.pointers.length){const t=r.pointers;i={x:t[0].offsetX+.5*(t[1].offsetX-t[0].offsetX),y:t[0].offsetY+.5*(t[1].offsetY-t[0].offsetY)}}e.event.x=i.offsetX,e.event.y=i.offsetY,e.event.dx=0,e.event.dy=0,e.zoomStartFlag||t.call(n,e.event),e.zoomStartFlag=!0,e.event.distance=0}),this},bn.prototype.zoom=function(t){const e=this;return"function"==typeof t&&(this.zoomExe=t,this.onZoom=function(n,i){const r=e.event.transform,o=r.scale[0];let s=o;const a=i.deltaY,h=i.offsetX,c=i.offsetY;s=gn(e.zoomExtent_,s+-1*a*e.zoomBy_),e.event.transform=vn(r,o,s,[h,c]),e.event.x=h,e.event.y=c,t.call(n,e.event)}),this},bn.prototype.zoomEnd=function(t){const e=this;return"function"==typeof t&&(this.zoomEndExe=t,this.onZoomEnd=function(n,i){e.event.x=i.offsetX,e.event.y=i.offsetY,e.event.dx=0,e.event.dy=0,e.zoomStartFlag=!1,t.call(n,e.event),e.event.distance=0}),this},bn.prototype.zoomTransition=function(){},bn.prototype.zoomExecute=function(t,e,n){this.eventType="zoom",e.preventDefault&&e.preventDefault(),this.zoomStartFlag?this.onZoom(t,e):this.onZoomStart(t,e,n)},bn.prototype.zoomPinch=function(t,e,n){const i=n.pointers;if(e.preventDefault&&e.preventDefault(),2===n.pointers.length)if(this.zoomStartFlag){const n=this.event.distance;for(var r=0;r<i.length;r++)if(e.pointerId===i[r].pointerId){i[r]=e;break}const o=F.getDistance({x:i[0].offsetX,y:i[0].offsetY},{x:i[1].offsetX,y:i[1].offsetY}),s={offsetX:this.event.x,offsetY:this.event.y,deltaY:n?n-o:0};this.event.distance=o,this.onZoom(t,s)}else this.onZoomStart(t,e,n)},bn.prototype.scaleBy=function(t,e,n){const i=this,r=i.event.transform,o=e*r.scale[0],s=r.scale[0],a=this.zoomTarget_||n,h=(a[0]-n[0])*s,c=(a[1]-n[1])*s;let l=0;const p={run(e){const a=r.scale[0],p=gn(i.zoomExtent_,s+(o-s)*e);i.event.transform=vn(r,a,p,n),i.event.transform.translate[0]+=h*(e-l)/p,i.event.transform.translate[1]+=c*(e-l)/p,l=e,i.zoomExe&&i.zoomExe.call(t,i.event)},target:t,duration:i.zoomDuration,delay:0,end:function(){i.onZoomEnd&&i.onZoomEnd(t,{})},loop:1,direction:"default",ease:"default"};fn.add(yn(),p,un(p.ease))},bn.prototype.zoomTarget=function(t){this.zoomTarget_=t},bn.prototype.scaleTo=function(t,e,n){const i=this,r=i.event.transform,o=r.scale[0],s=this.zoomTarget_||n,a=(s[0]-n[0])*o,h=(s[1]-n[1])*o;let c=0;const l={run(s){const l=r.scale[0],p=gn(i.zoomExtent_,o+(e-o)*s);i.event.transform=vn(r,l,p,n),i.event.transform.translate[0]+=a*(s-c)/p,i.event.transform.translate[1]+=h*(s-c)/p,c=s,i.zoomStartFlag||i.onZoomStart(t,{offsetX:n[0],offsetY:n[1]},{}),i.zoomExe&&i.zoomExe.call(t,i.event)},target:t,duration:i.zoomDuration,delay:0,end:function(){i.onZoomEnd&&i.onZoomEnd(t,i.event)},loop:1,direction:"default",ease:"default"};fn.add(yn(),l,un(l.ease))},bn.prototype.panTo=function(t,e){const n=this,i=n.event.transform,r=e[0]-n.event.x,o=e[1]-n.event.y;let s=0;const a={run(e){const[a]=i.scale;i.translate[0]+=r*(e-s)/a,i.translate[1]+=o*(e-s)/a,s=e,n.zoomExe&&n.zoomExe.call(t,n.event)},target:t,duration:n.zoomDuration,delay:0,end:function(){n.onZoomEnd&&n.onZoomEnd(t,n.event)},loop:1,direction:"default",ease:"default"};fn.add(yn(),a,un(a.ease))},bn.prototype.bindMethods=function(t){const e=this;t.scaleTo=function(n,i){e.scaleTo(t,n,i)},t.scaleBy=function(n,i){return e.scaleBy(t,n,i),t},t.panTo=function(n,i){return e.panTo(t,n,i),t}},bn.prototype.zoomFactor=function(t){return this.zoomBy_=t,this},bn.prototype.scaleExtent=function(t){return this.zoomExtent_=t,this},bn.prototype.duration=function(t){return this.zoomDuration=t||250,this},bn.prototype.panExtent=function(t){return this.panExtent_=t,this.panFlag=!0,this},bn.prototype.panExecute=function(t,e,n,i){if(1===i.pointers.length){if(this.event.e=e,this.eventType="pan",e.preventDefault&&e.preventDefault(),"touchstart"!==e.type&&"touchmove"!==e.type&&"touchend"!==e.type&&"touchcancel"!==e.type||(e.offsetX=e.touches[0].clientX,e.offsetY=e.touches[0].clientY),this.zoomStartFlag||"mousedown"!==n&&"pointerdown"!==n)if(!this.onZoomEnd||"mouseup"!==n&&"mouseleave"!==n&&"pointerup"!==n&&"pointerleave"!==n){if(this.zoomExe){const n=e.offsetX-this.event.x,i=e.offsetY-this.event.y;this.event.x=e.offsetX,this.event.y=e.offsetY,this.event=xn(this.event,{dx:n,dy:i},this.panExtent_),this.zoomExe.call(t,this.event)}}else this.onZoomEnd(t,e);else this.onZoomStart(t,e,{});e.preventDefault&&e.preventDefault()}};var wn={drag:function(){return new mn},zoom:function(){return new bn}};const Bn=F,An=x;let Tn=0;const kn=wn.zoom(),En=wn.drag();function Sn(){return Tn+=1,Tn}const Cn=function(){He.apply(this,arguments)};function Dn(t){const e=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1);return e<1?1:e}function Mn(t){const e={translateX:0,translateY:0,scaleX:1,scaleY:1};return t&&(t.translate&&t.translate.length>0&&(e.translateX=t.translate[0],e.translateY=t.translate[1]),t.scale&&t.scale.length>0&&(e.scaleX=t.scale[0],e.scaleY=t.scale[1]||e.scaleX)),e}function _n(){const t=this,{transform:e,points:n=[]}=t.attr,{translateX:i,translateY:r,scaleX:o,scaleY:s}=Mn(e);if(n&&n.length>0){let e=n[0].x,a=n[0].x,h=n[0].y,c=n[0].y;for(let t=1;t<n.length;t+=1)e>n[t].x&&(e=n[t].x),a<n[t].x&&(a=n[t].x),h>n[t].y&&(h=n[t].y),c<n[t].y&&(c=n[t].y);t.BBox={x:i+e*o,y:r+h*s,width:(a-e)*o,height:(c-h)*s}}else t.BBox={x:0,y:0,width:0,height:0};e&&e.rotate?t.BBoxHit=Bn.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox}function zn(t,e){this.config=t,this.type=e||"linear",this.mode=this.config.mode&&"percent"!==this.config.mode?"absolute":"percent"}function In(t,e,n){this.imageData=t,this.width=e,this.height=n}function Pn(t,e={}){const n=e.id?e.id:"mask-"+Math.ceil(1e3*Math.random());this.config=e,this.mask=new Kn(t.dom.ctx,{el:"g",attr:{id:n}},Sn(),t.vDomIndex)}function On(t){return new Pn(this,t)}function Ln(t,e={}){const n=e.id?e.id:"clip-"+Math.ceil(1e3*Math.random());this.clip=new Kn(t.dom.ctx,{el:"g",attr:{id:n}},Sn(),t.vDomIndex)}function Nn(t){return new Ln(this,t)}function Fn(t,e={},n=0,i=0){const r=this,o=e.id?e.id:"pattern-"+Math.ceil(1e3*Math.random());this.repeatInd=e.repeat?e.repeat:"repeat","NODE"===t.ENV?r.pattern=si({},i,n):(r.pattern=ei(null,{},{enableEvents:!1,enableResize:!1}),r.pattern.setSize(n,i)),r.pattern.setAttr("id",o),t.prependChild([r.pattern]),r.pattern.vDomIndex=t.vDomIndex+":"+o,r.pattern.onChange((function(){r.patternObj=t.ctx.createPattern(r.pattern.domEl,r.repeatInd)}))}function Rn(t,e=0,n=0){return new Fn(this,t,e,n)}function jn(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}function Xn(t,e,n,i,r,o){const s=this;s.ctx=t,s.attr=e,s.style=n,s.nodeName="Image",s.nodeExe=o;for(const t in e)this.setAttr(t,e[t]);An.vDomChanged(o.vDomIndex),s.stack=[s]}function Yn(t,e,n){const i=this;i.ctx=t,i.attr=e,i.style=n,i.nodeName="text",i.stack=[i]}(Cn.prototype=new He).constructor=Cn,Cn.prototype.createNode=function(t,e,n){return new Kn(t,e,Sn(),n)},zn.prototype.exe=function(t,e){return"linear"===this.type&&"percent"===this.mode?this.linearGradient(t,e):"linear"===this.type&&"absolute"===this.mode?this.absoluteLinearGradient(t):"radial"===this.type&&"percent"===this.mode?this.radialGradient(t,e):"radial"===this.type&&"absolute"===this.mode?this.absoluteRadialGradient(t):void console.error("wrong Gradiant type")},zn.prototype.linearGradient=function(t,e){const n=t.createLinearGradient(e.x+e.width*(this.config.x1/100),e.y+e.height*(this.config.y1/100),e.x+e.width*(this.config.x2/100),e.y+e.height*(this.config.y2/100));return this.config.colorStops.forEach((t=>{n.addColorStop(t.value/100,t.color)})),n},zn.prototype.absoluteLinearGradient=function(t){const e=t.createLinearGradient(this.config.x1,this.config.y1,this.config.x2,this.config.y2);return this.config.colorStops.forEach((t=>{e.addColorStop(t.value,t.color)})),e},zn.prototype.radialGradient=function(t,e){const n=t.createRadialGradient(e.x+e.width*(this.config.innerCircle.x/100),e.y+e.height*(this.config.innerCircle.y/100),e.width>e.height?e.width*this.config.innerCircle.r/100:e.height*this.config.innerCircle.r/100,e.x+e.width*(this.config.outerCircle.x/100),e.y+e.height*(this.config.outerCircle.y/100),e.width>e.height?e.width*this.config.outerCircle.r/100:e.height*this.config.outerCircle.r/100);return this.config.colorStops.forEach((t=>{n.addColorStop(t.value/100,t.color)})),n},zn.prototype.absoluteRadialGradient=function(t,e){const n=t.createRadialGradient(this.config.innerCircle.x,this.config.innerCircle.y,this.config.innerCircle.r,this.config.outerCircle.x,this.config.outerCircle.y,this.config.outerCircle.r);return this.config.colorStops.forEach((t=>{n.addColorStop(t.value/100,t.color)})),n},zn.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,this)},In.prototype.get=function(t){const e=this.imageData?this.imageData.pixels:[],n=(t.y-1)*(4*this.width)+4*(t.x-1);return"rgba("+e[n]+", "+e[n+1]+", "+e[n+2]+", "+e[n+3]+")"},In.prototype.put=function(t,e){const n=(t.y-1)*(4*this.width)+4*(t.x-1);return this.imageData.pixels[n]=e[0],this.imageData.pixels[n+1]=e[1],this.imageData.pixels[n+2]=e[2],this.imageData.pixels[n+3]=e[3],this},Pn.prototype.setAttr=function(t,e){this.config[t]=e},Pn.prototype.exe=function(){return this.mask.execute(),this.mask.dom.ctx.globalCompositeOperation=this.config.globalCompositeOperation||"destination-atop",!0},Ln.prototype.exe=function(){return this.clip.execute(),this.clip.dom.ctx.clip(),!0},Fn.prototype.repeat=function(t){this.repeatInd=t},Fn.prototype.exe=function(){return this.patternObj},jn.prototype={render:function(t){const e=this;if(t.transform){const{transform:n}=t,{scale:i=[1,1],skew:r=[0,0],translate:o=[0,0]}=n,[s=1,a=s]=i,[h=0,c=h]=r,[l=0,p=l]=o;e.ctx.transform(s,h,c,a,l,p),n.rotate&&n.rotate.length>0&&(e.ctx.translate(n.rotate[1]||0,n.rotate[2]||0),e.ctx.rotate(n.rotate[0]*(Math.PI/180)),e.ctx.translate(-n.rotate[1]||0,-n.rotate[2]||0))}for(let t=0;t<e.stack.length;t+=1)e.stack[t].execute()},setAttr:function(t,e){null==e&&null!=this.attr[t]?delete this.attr[t]:this.attr[t]=e},setStyle:function(t,e){null==e&&null!=this.style[t]?delete this.style[t]:this.style[t]=e},applyStyles:function(){"#000000"!==this.ctx.fillStyle&&this.ctx.fill(),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke()}},Xn.prototype=new jn,Xn.prototype.constructor=Xn,Xn.prototype.setAttr=function(t,e){const n=this;"src"===t&&("string"==typeof e?(n.image=n.image?n.image:function(t){const e=new Image;return e.crossOrigin="anonymous",e.onload=function(){t.attr.height=t.attr.height?t.attr.height:this.height,t.attr.width=t.attr.width?t.attr.width:this.width,t.imageObj=this,t.nodeExe.attr.onload&&"function"==typeof t.nodeExe.attr.onload&&t.nodeExe.attr.onload.call(t.nodeExe,t.image),t.nodeExe.BBoxUpdate=!0,An.vDomChanged(t.nodeExe.vDomIndex)},e.onerror=function(e){t.nodeExe.attr.onerror&&"function"==typeof t.nodeExe.attr.onerror&&t.nodeExe.attr.onerror.call(t.nodeExe,e)},e}(n),n.image.src!==e&&(n.image.src=e)):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement?(n.imageObj=e,n.attr.height=n.attr.height?n.attr.height:e.height,n.attr.width=n.attr.width?n.attr.width:e.width):(e instanceof Kn||e instanceof oi)&&(n.imageObj=e.domEl,n.attr.height=n.attr.height?n.attr.height:e.height,n.attr.width=n.attr.width?n.attr.width:e.width)),this.attr[t]=e,An.vDomChanged(this.nodeExe.vDomIndex)},Xn.prototype.updateBBox=function(){const t=this,{transform:e,x:n=0,y:i=0,width:r=0,height:o=0}=t.attr,{translateX:s,translateY:a,scaleX:h,scaleY:c}=Mn(e);t.BBox={x:(s+n)*h,y:(a+i)*c,width:r*h,height:o*c},e&&e.rotate?t.BBoxHit=Bn.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},Xn.prototype.execute=function(){const{width:t=0,height:e=0,x:n=0,y:i=0}=this.attr;this.imageObj&&this.ctx.drawImage(this.imageObj,n,i,t,e)},Xn.prototype.applyStyles=function(){},Xn.prototype.in=function(t){const{width:e=0,height:n=0,x:i=0,y:r=0}=this.attr;return t.x>=i&&t.x<=i+e&&t.y>=r&&t.y<=r+n},Yn.prototype=new jn,Yn.prototype.constructor=Yn,Yn.prototype.text=function(t){this.attr.text=t},Yn.prototype.updateBBox=function(){const t=this;let e=1,n=0,{x:i=0,y:r=0,transform:o}=t.attr;const{translateX:s,translateY:a,scaleX:h,scaleY:c}=Mn(o);this.style.font&&(this.ctx.font=this.style.font,e=parseInt(this.style.font.replace(/[^\d.]/g,""),10)||1),n=this.ctx.measureText(this.attr.text).width,"center"===this.style.textAlign?i-=n/2:"right"===this.style.textAlign&&(i-=n),t.width=n,t.height=e,t.x=i,t.y=r,t.BBox={x:(s+i)*h,y:(a+r)*c,width:n*h,height:e*c},o&&o.rotate?t.BBoxHit=Bn.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},Yn.prototype.execute=function(){void 0!==this.attr.text&&null!==this.attr.text&&("#000000"!==this.ctx.fillStyle&&this.ctx.fillText(this.attr.text,this.attr.x,this.attr.y+this.height),"#000000"!==this.ctx.strokeStyle&&this.ctx.strokeText(this.attr.text,this.attr.x,this.attr.y+this.height))},Yn.prototype.applyStyles=function(){},Yn.prototype.in=function(t){const{x:e=0,y:n=0,width:i=0,height:r=0}=this;return t.x>=e&&t.x<=e+i&&t.y>=n&&t.y<=n+r};const Gn=function(t,e,n){const i=this;i.ctx=t,i.attr=e,i.style=n,i.nodeName="circle",i.stack=[i]};(Gn.prototype=new jn).constructor=Gn,Gn.prototype.updateBBox=function(){const t=this,{transform:e,r:n=0,cx:i=0,cy:r=0}=t.attr,{translateX:o,translateY:s,scaleX:a,scaleY:h}=Mn(e);t.BBox={x:o+(i-n)*a,y:s+(r-n)*h,width:2*n*a,height:2*n*h},e&&e.rotate?t.BBoxHit=Bn.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},Gn.prototype.execute=function(){const{r:t=0,cx:e=0,cy:n=0}=this.attr;this.ctx.beginPath(),this.ctx.arc(e,n,t,0,2*Math.PI,!1),this.applyStyles(),this.ctx.closePath()},Gn.prototype.in=function(t,e){const{r:n=0,cx:i=0,cy:r=0}=this.attr;return Math.sqrt((t.x-i)*(t.x-i)+(t.y-r)*(t.y-r))<=n};const Un=function(t,e,n){const i=this;i.ctx=t,i.attr=e,i.style=n,i.nodeName="line",i.stack=[i]};function Hn(t,e,n){const i=this;i.ctx=t,i.attr=e,i.style=n,i.nodeName="polyline",i.stack=[i]}(Un.prototype=new jn).constructor=Un,Un.prototype.updateBBox=function(){const t=this,{transform:e,x1:n=0,y1:i=0,x2:r=0,y2:o=0}=t.attr,{translateX:s,translateY:a,scaleX:h,scaleY:c}=Mn(e);t.BBox={x:s+(n<r?n:r)*h,y:a+(i<o?i:o)*c,width:Math.abs(r-n)*h,height:Math.abs(o-i)*c},e&&e.rotate?t.BBoxHit=Bn.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},Un.prototype.execute=function(){const{ctx:t}=this,{x1:e=0,y1:n=0,x2:i=0,y2:r=0}=this.attr;t.beginPath(),t.moveTo(e,n),t.lineTo(i,r),this.applyStyles(),t.closePath()},Un.prototype.in=function(t){const{x1:e=0,y1:n=0,x2:i=0,y2:r=0}=this.attr;return parseFloat(Bn.getDistance({x:e,y:n},t)+Bn.getDistance(t,{x:i,y:r})).toFixed(1)===parseFloat(Bn.getDistance({x:e,y:n},{x:i,y:r})).toFixed(1)},Hn.prototype=new jn,Hn.constructor=Hn,Hn.prototype.execute=function(){const t=this;let e;if(this.attr.points&&0!==this.attr.points.length){this.ctx.beginPath(),t.ctx.moveTo(this.attr.points[0].x,this.attr.points[0].y);for(var n=1;n<this.attr.points.length;n++)e=this.attr.points[n],t.ctx.lineTo(e.x,e.y);this.applyStyles(),this.ctx.closePath()}},Hn.prototype.updateBBox=_n,Hn.prototype.in=function(t){let e=!1;for(let n=0,i=this.attr.points.length;n<=i-2;n++){const i=this.attr.points[n],r=this.attr.points[n+1];e=e||parseFloat(Bn.getDistance({x:i.x,y:i.y},t)+Bn.getDistance(t,{x:r.x,y:r.y})).toFixed(1)===parseFloat(Bn.getDistance({x:i.x,y:i.y},{x:r.x,y:r.y})).toFixed(1)}return e};const Vn=function(t,e,n){const i=this;return i.ctx=t,i.angle=0,i.nodeName="path",i.attr=e,i.style=n,i.attr.d&&(Mt.isTypePath(i.attr.d)?(i.path=i.attr.d,i.attr.d=i.attr.d.fetchPathString()):i.path=Mt.instance(i.attr.d),i.pathNode=new Path2D(i.attr.d)),i.stack=[i],i};function qn(t){if("[object Array]"!==Object.prototype.toString.call(t))return void console.error("Points expected as array [{x: , y:}]");if(t&&0===t.length)return;const e=new Path2D;e.moveTo(t[0].x,t[0].y);for(let n=1;n<t.length;n++)e.lineTo(t[n].x,t[n].y);return e.closePath(),{path:e,points:t,execute:function(t){t.beginPath();const e=this.points;t.moveTo(e[0].x,e[0].y);for(let n=1;n<e.length;n++)t.lineTo(e[n].x,e[n].y);t.closePath()}}}(Vn.prototype=new jn).constructor=Vn,Vn.prototype.updateBBox=function(){const t=this,{transform:e}=t.attr,{translateX:n,translateY:i,scaleX:r,scaleY:o}=Mn(e);t.BBox=t.path?t.path.BBox:{x:0,y:0,width:0,height:0},t.BBox.x=n+t.BBox.x*r,t.BBox.y=i+t.BBox.y*o,t.BBox.width*=r,t.BBox.height*=o,e&&e.rotate?t.BBoxHit=Bn.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},Vn.prototype.setAttr=function(t,e){this.attr[t]=e,"d"===t&&(Mt.isTypePath(e)?(this.path=e,this.attr.d=e.fetchPathString()):this.path=Mt.instance(this.attr.d),this.pathNode=new Path2D(this.attr.d))},Vn.prototype.getPointAtLength=function(t){return this.path?this.path.getPointAtLength(t):{x:0,y:0}},Vn.prototype.getAngleAtLength=function(t){return this.path?this.path.getAngleAtLength(t):0},Vn.prototype.getTotalLength=function(){return this.path?this.path.getTotalLength():0},Vn.prototype.execute=function(){this.attr.d&&("#000000"!==this.ctx.fillStyle||"#000000"!==this.ctx.strokeStyle?("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.pathNode),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.pathNode)):this.path.execute(this.ctx))},Vn.prototype.applyStyles=function(){},Vn.prototype.in=function(t){let e=!1;return this.attr.d&&this.pathNode?(this.ctx.save(),this.ctx.scale(1/this.ctx.pixelRatio,1/this.ctx.pixelRatio),e=this.ctx.isPointInPath(this.pathNode,t.x,t.y),this.ctx.restore(),e):e};const Zn=function(t,e,n){const i=this;return i.ctx=t,i.nodeName="polygon",i.attr=e,i.style=n,i.stack=[i],i.attr.points&&(i.polygon=qn(i.attr.points)),this};(Zn.prototype=new jn).constructor=Zn,Zn.prototype.setAttr=function(t,e){this.attr[t]=e,"points"===t&&(this.polygon=qn(this.attr.points),this.polygon&&(this.attr.points=this.polygon.points))},Zn.prototype.updateBBox=_n,Zn.prototype.execute=function(){this.polygon&&("#000000"!==this.ctx.fillStyle||"#000000"!==this.ctx.strokeStyle?("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.polygon.path),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.polygon.path)):this.polygon.execute(this.ctx))},Zn.prototype.applyStyles=function(){},Zn.prototype.in=function(t){let e=!1;return!!this.polygon&&(this.ctx.save(),this.ctx.scale(1/this.ctx.pixelRatio,1/this.ctx.pixelRatio),e=this.style.fillStyle?this.ctx.isPointInPath(this.polygon.path,t.x,t.y):e,this.ctx.restore(),e)};const Wn=function(t,e,n){const i=this;return i.ctx=t,i.nodeName="ellipse",i.attr=e,i.style=n,i.stack=[i],this};(Wn.prototype=new jn).constructor=Wn,Wn.prototype.updateBBox=function(){const t=this,{transform:e,cx:n=0,cy:i=0,rx:r=0,ry:o=0}=t.attr,{translateX:s,translateY:a,scaleX:h,scaleY:c}=Mn(e);t.BBox={x:s+(n-r)*h,y:a+(i-o)*c,width:2*r*h,height:2*o*c},e&&e.rotate?t.BBoxHit=Bn.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},Wn.prototype.execute=function(){const t=this.ctx,{cx:e=0,cy:n=0,rx:i=0,ry:r=0}=this.attr;t.beginPath(),t.ellipse(e,n,i,r,0,0,2*Math.PI),this.applyStyles(),t.closePath()},Wn.prototype.in=function(t){const{cx:e=0,cy:n=0,rx:i=0,ry:r=0}=this.attr;return(t.x-e)*(t.x-e)/(i*i)+(t.y-n)*(t.y-n)/(r*r)<=1};const $n=function(t,e,n){const i=this;return i.ctx=t,i.nodeName="rect",i.attr=e,i.style=n,i.stack=[i],this};function Qn(t,e){const{x:n=0,y:i=0,width:r=0,height:o=0,rx:s=0,ry:a=0}=e;t.beginPath(),t.moveTo(n+s,i),t.lineTo(n+r-s,i),t.quadraticCurveTo(n+r,i,n+r,i+a),t.lineTo(n+r,i+o-a),t.quadraticCurveTo(n+r,i+o,n+r-s,i+o),t.lineTo(n+s,i+o),t.quadraticCurveTo(n,i+o,n,i+o-a),t.lineTo(n,i+a),t.quadraticCurveTo(n,i,n+s,i),t.closePath()}($n.prototype=new jn).constructor=$n,$n.prototype.updateBBox=function(){const t=this,{transform:e,x:n=0,y:i=0,width:r=0,height:o=0}=t.attr,{translateX:s,translateY:a,scaleX:h,scaleY:c}=Mn(e);t.BBox={x:s+n*h,y:a+i*c,width:r*h,height:o*c},e&&e.rotate?t.BBoxHit=Bn.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},$n.prototype.applyStyles=function(){},$n.prototype.execute=function(){const t=this.ctx,{x:e=0,y:n=0,width:i=0,height:r=0,rx:o=0,ry:s=0}=this.attr;"#000000"!==t.fillStyle||"#000000"!==t.strokeStyle?("#000000"!==t.fillStyle&&(o||s?(Qn(t,{x:e,y:n,width:i,height:r,rx:o,ry:s}),t.fill()):t.fillRect(e,n,i,r)),"#000000"!==t.strokeStyle&&(o||s?(Qn(t,{x:e,y:n,width:i,height:r,rx:o,ry:s}),t.stroke()):t.strokeRect(e,n,i,r))):t.rect(e,n,i,r)},$n.prototype.in=function(t){const{x:e=0,y:n=0,width:i=0,height:r=0}=this.attr;return t.x>=e&&t.x<=e+i&&t.y>=n&&t.y<=n+r};const Jn=function(t,e,n){const i=this;return i.nodeName="g",i.ctx=t,i.attr=e,i.style=n,i.stack=new Array(0),this};(Jn.prototype=new jn).constructor=Jn,Jn.prototype.updateBBox=function(t){const e=this;let n,i,r,o;const{transform:s}=e.attr,{translateX:a,translateY:h,scaleX:c,scaleY:l}=Mn(s);if(e.BBox={},t&&t.length>0){let e,s,a;for(let h=0;h<t.length;h+=1)e=t[h],s=e.dom.BBoxHit.x,a=e.dom.BBoxHit.y,n=void 0===n||n>s?s:n,r=void 0===r||r>a?a:r,i=void 0===i||i<s+e.dom.BBoxHit.width?s+e.dom.BBoxHit.width:i,o=void 0===o||o<a+e.dom.BBoxHit.height?a+e.dom.BBoxHit.height:o}n=void 0===n?0:n,r=void 0===r?0:r,i=void 0===i?0:i,o=void 0===o?0:o,e.BBox.x=a+n*c,e.BBox.y=h+r*l,e.BBox.width=Math.abs(i-n)*c,e.BBox.height=Math.abs(o-r)*l,e.attr.transform&&e.attr.transform.rotate?e.BBoxHit=Bn.rotateBBox(this.BBox,this.attr.transform):e.BBoxHit=this.BBox},Jn.prototype.child=function(t){const e=this,n=t;n instanceof Kn?(n.dom.parent=e,e.stack[e.stack.length]=n):n instanceof Cn?n.stack.forEach((t=>{t.dom.parent=e,e.stack[e.stack.length]=t})):console.log("wrong Object")},Jn.prototype.in=function(t){const e=t.x,n=t.y,{BBox:i}=this,{transform:r}=this.attr,{translateX:o,translateY:s,scaleX:a,scaleY:h}=Mn(r);return e>=(i.x-o)/a&&e<=(i.x-o+i.width)/a&&n>=(i.y-s)/h&&n<=(i.y-s+i.height)/h};const Kn=function(t,e,n,i){switch(this.style=e.style||{},this.setStyle(e.style),this.attr=e.attr||{},this.id=n,this.nodeName=e.el,this.nodeType="CANVAS",this.children=[],this.events={},this.ctx=t,this.vDomIndex=i,this.bbox=void 0===e.bbox||e.bbox,e.el){case"circle":this.dom=new Gn(this.ctx,this.attr,this.style);break;case"rect":this.dom=new $n(this.ctx,this.attr,this.style);break;case"line":this.dom=new Un(this.ctx,this.attr,this.style);break;case"polyline":this.dom=new Hn(this.ctx,this.attr,this.style);break;case"path":this.dom=new Vn(this.ctx,this.attr,this.style);break;case"group":case"g":this.dom=new Jn(this.ctx,this.attr,this.style);break;case"text":this.dom=new Yn(this.ctx,this.attr,this.style);break;case"image":this.dom=new Xn(this.ctx,this.attr,this.style,e.onload,e.onerror,this);break;case"polygon":this.dom=new Zn(this.ctx,this.attr,this.style,this);break;case"ellipse":this.dom=new Wn(this.ctx,this.attr,this.style,this);break;default:this.dom=null}this.dom.nodeExe=this,this.BBoxUpdate=!0};function ti(t){return Ft.RGBAInstanceCheck(t)&&(t=t.rgba),"#000"===t||"#000000"===t||"black"===t?"rgb(1, 1, 1)":t}function ei(t,e={},n={}){const i=t?document.querySelector(t):null;let r=i?i.clientHeight:0,o=i?i.clientWidth:0;const s=document.createElement("canvas"),a=s.getContext("2d",e);let{enableEvents:h=!0,autoUpdate:c=!0,enableResize:l=!0}=n,p=Dn(a);a.pixelRatio=p;let f,u=function(t){t.clearRect(0,0,o*p,r*p)};s.setAttribute("height",r*p),s.setAttribute("width",o*p),s.style.height=r+"px",s.style.width=o+"px",s.style.position="absolute";let d,y,x,g,v=999999;i?(i.appendChild(s),f=new m,c&&(v=An.addVdom(f))):h=!1;const b=new Kn(a,{el:"g",attr:{id:"rootNode"}},Sn(),v);f&&f.rootNode(b);const w=b.execute.bind(b);b.container=i,b.domEl=s,b.height=r,b.width=o,b.type="CANVAS",b.ctx=a,b.setClear=function(t){u=t},b.setAttr=function(t,e){"viewBox"===t&&this.setViewBox.apply(this,e.split(",")),s.setAttribute(t,e),this.attr[t]=e},b.enableEvents=function(t){h=t},b.setStyle=function(t,e){this.domEl.style[t]=e},b.addDependentLayer=function(t){if(!(t instanceof Kn))return;const e=t.attr.id?t.attr.id:"dep-"+Math.ceil(1e3*Math.random());t.setAttr("id",e),t.vDomIndex=this.vDomIndex+":"+e,this.prependChild([t])};const B=function(e){document.querySelector(t)?(r=d||e.height,o=y||e.width,b.width=o,b.height=r,A(b.domEl,o,r),x&&x(),b.execute()):Ze(b)},A=function(t,e,n){t.setAttribute("height",n*p),t.setAttribute("width",e*p),t.style.height=n+"px",t.style.width=e+"px"};if(b.setPixelRatio=function(t){p=t,this.ctx.pixelRatio=p,A(this.domEl,this.width,this.height)},b.onResize=function(t){x=t},b.onChange=function(t){g=t},b.invokeOnChange=function(){},b.setSize=function(t,e){d=e,y=t,o=t,r=e,this.width=o,this.height=r,A(this.domEl,o,r),this.execute()},b.setViewBox=function(t,e,n,i){},b.getPixels=function(t,e,n,i){return new In(this.ctx.getImageData(t,e,n,i),n,i)},b.putPixels=function(t,e,n){if(t instanceof In)return this.ctx.putImageData(t.imageData,e,n)},b.clear=function(){u()},b.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},b.createPattern=Rn,b.createClip=Nn,b.createMask=On,b.execute=function(){u(a),a.setTransform(p,0,0,p,0,0),this.updateBBox(),w(),g&&this.stateModified&&g(),this.stateModified=!1},b.update=function(){this.execute()},b.createTexture=function(t){return new oi(this,t)},b.createAsyncTexture=function(t){return new Promise(((e,n)=>{const i=new oi(this,t);i.onLoad((function(){e(i)}))}))},b.destroy=function(){const e=document.querySelector(t);e&&e.contains(s)&&e.removeChild(s),An.removeVdom(v),Ze(b,B)},h){const t=new Rt(b);s.addEventListener("mousemove",(e=>{e.preventDefault(),t.mousemoveCheck(e)})),s.addEventListener("mousedown",(e=>{t.mousedownCheck(e)})),s.addEventListener("mouseup",(e=>{t.mouseupCheck(e)})),s.addEventListener("mouseleave",(e=>{t.mouseleaveCheck(e)})),s.addEventListener("contextmenu",(e=>{t.contextmenuCheck(e)})),s.addEventListener("touchstart",(e=>{t.touchstartCheck(e)})),s.addEventListener("touchend",(e=>{t.touchendCheck(e)})),s.addEventListener("touchmove",(e=>{e.preventDefault(),t.touchmoveCheck(e)})),s.addEventListener("touchcancel",(e=>{t.touchcancelCheck(e)})),s.addEventListener("wheel",(e=>{t.wheelEventCheck(e)})),s.addEventListener("pointerdown",(e=>{t.addPointer(e),t.pointerdownCheck(e)})),s.addEventListener("pointerup",(e=>{t.removePointer(e),t.pointerupCheck(e)})),s.addEventListener("pointermove",(e=>{e.preventDefault(),t.pointermoveCheck(e)}))}return An.execute(),l&&b.container&&qe(b,B),b}function ni(t,e){const n=document.createElement("canvas");n.setAttribute("height",e),n.setAttribute("width",t),n.style.height=e+"px",n.style.width=t+"px",this.canvas=n,this.context=this.canvas.getContext("2d")}function ii(t,e){const n=new Image;return n.crossOrigin="anonymous",n.src=e,t?(n.onload=function(){t&&(t.attr&&(t.attr.height=t.attr.height?t.attr.height:this.naturalHeight,t.attr.width=t.attr.width?t.attr.width:this.naturalWidth),t.imageObj=this,t.attr&&t.attr.onload&&"function"==typeof t.attr.onload&&t.attr.onload.call(t,t.image),t.asyncOnLoad&&"function"==typeof t.asyncOnLoad&&t.asyncOnLoad(t.image),ri(t))},n.onerror=function(e){console.error(e),t.nodeExe.attr.onerror&&"function"==typeof t.nodeExe.attr.onerror&&t.nodeExe.attr.onerror.call(t.nodeExe,e),t.asyncOnLoad&&"function"==typeof t.asyncOnLoad&&t.asyncOnLoad(t.image)},n):n}function ri(t){t.imageObj&&(t.attr&&t.attr.clip?function(t){const e=t.ctx,{clip:n,width:i=0,height:r=0}=t.attr,{sx:o=0,sy:s=0,swidth:a=i,sheight:h=r}=n;e.clearRect(0,0,i,r),e.drawImage(t.imageObj,o,s,a,h,0,0,i,r)}(t):t.execute(),t.attr&&t.attr.filter&&function(t){const e=t.ctx,{width:n=0,height:i=0}=t.attr,r=e.getImageData(0,0,n,i);e.putImageData(t.attr.filter(r),0,0)}(t),An.vDomChanged(t.nodeExe.vDomIndex))}function oi(t,e={}){const n=this;n.attr=Object.assign({},e.attr)||{},n.style=Object.assign({},e.style)||{},n.rImageObj=new ni(n.attr.width||1,n.attr.height||1),n.ctx=n.rImageObj.context,n.domEl=n.rImageObj.canvas,n.imageArray=[],n.seekIndex=0,n.nodeName="Sprite",n.nodeExe=t;for(const t in n.attr)n.setAttr(t,n.attr[t]);An.vDomChanged(t.vDomIndex)}function si(t,e=0,n=0){if(!Canvas)return console.error("Canvas missing from node"),console.error('Install "Canvas" "canvas-5-polyfill" node modules'),void console.error('Make "Canvas" "Image" "Path2D" objects global from the above modules');let i;const r=new Canvas(n,e);let o=r.getContext("2d",t);const s=Dn(o);let a=function(t){t.clearRect(0,0,n*s,e*s)};const h=new m,c=An.addVdom(h),l=new Kn(o,{el:"g",attr:{id:"rootNode"}},Sn(),c);h.rootNode(l);const p=l.execute.bind(l);return l.domEl=r,l.height=e,l.width=n,l.type="CANVAS",l.ENV="NODE",l.setClear=function(t){a=t},l.onChange=function(t){i=t},l.getPixels=function(t,e,n,i){return this.ctx.getImageData(t,e,n,i)},l.putPixels=function(t,e,n){return this.ctx.putImageData(t,e,n)},l.clear=function(){a()},l.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},l.setSize=function(i,r){n=i,e=r,this.domEl=new Canvas(n,e),o=this.domEl.getContext("2d",t),this.width=n,this.height=e,this.ctx=o,this.execute()},l.execute=function(){a(o),o.setTransform(s,0,0,s,0,0),l.updateBBox(),p()},l.execute=function(){a(o),o.setTransform(s,0,0,s,0,0),this.updateBBox(),p(),i&&this.stateModified&&i(),this.stateModified=!1},l.update=function(){this.execute()},l.toDataURL=function(){return this.domEl.toDataURL()},l.getPixels=function(t,e,n,i){return new In(this.ctx.getImageData(t,e,n,i),n,i)},l.putPixels=function(t,e,n){if(t instanceof In)return this.ctx.putImageData(t.imageData,e,n)},l.clear=function(){a()},l.createTexture=function(t){return new oi(this,t)},l.createAsyncTexture=function(t){return new Promise(((e,n)=>{const i=new oi(this,t);i.onLoad((function(){e(i)}))}))},l.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},l.createPattern=Rn,l.createClip=Nn,l.createMask=On,l}Kn.prototype=new Ye,Kn.prototype.node=function(){return this.updateBBox(),this.dom},Kn.prototype.stylesExe=function(){let t,e;const n=this.style;for(e in n)"string"==typeof n[e]||"number"==typeof n[e]?t=n[e]:"object"==typeof n[e]?t=n[e]instanceof zn||n[e]instanceof Fn||n[e]instanceof Ln||n[e]instanceof Pn?n[e].exe(this.ctx,this.dom.BBox):n[e]:"function"==typeof n[e]?(n[e]=n[e].call(this,this.dataObj),t=n[e]):console.log("unkonwn Style"),"function"!=typeof this.ctx[e]?this.ctx[e]=t:"function"==typeof this.ctx[e]?this.ctx[e](t):console.log("junk comp")},Kn.prototype.remove=function(){const{children:t}=this.dom.parent,e=t.indexOf(this);-1!==e&&t.splice(e,1),this.dom.parent.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex)},Kn.prototype.attributesExe=function(){this.dom.render(this.attr)},Kn.prototype.setStyle=function(t,e){if(2===arguments.length)null==e&&null!=this.style[t]?delete this.style[t]:this.style[t]=ti(e);else if(1===arguments.length&&"object"==typeof t){const e=Object.keys(t);for(let n=0,i=e.length;n<i;n+=1)null==t[e[n]]&&null!=this.style[e[n]]?delete this.style[e[n]]:this.style[e[n]]=ti(t[e[n]])}return An.vDomChanged(this.vDomIndex),this},Kn.prototype.setAttr=function(t,e){if(2===arguments.length)null==e&&null!=this.attr[t]?delete this.attr[t]:this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"==typeof t){const e=Object.keys(t);for(let n=0;n<e.length;n+=1)null==t[e[n]]&&null!=this.attr[e[n]]?delete this.attr[e[n]]:this.attr[e[n]]=t[e[n]],this.dom.setAttr(e[n],t[e[n]])}return this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex),this},Kn.prototype.rotate=function(t,e,n){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,n||0],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex),this},Kn.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),t.length<1?null:(this.attr.transform.scale=[t[0],t[1]?t[1]:t[0]],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex),this)},Kn.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex),this},Kn.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skew||(this.attr.transform.skew=[]),this.attr.transform.skew[0]=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex),this},Kn.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skew||(this.attr.transform.skew=[]),this.attr.transform.skew[1]=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex),this},Kn.prototype.execute=function(){if("none"!==this.style.display){if(this.ctx.save(),this.stylesExe(),this.attributesExe(),this.dom instanceof Jn)for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();this.ctx.restore()}},Kn.prototype.prependChild=function(t){const e=this,n=t;if(e.dom instanceof Jn)for(let t=0;t<n.length;t+=1)n[t].dom.parent=e,e.children.unshift(n[t]);else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex),e},Kn.prototype.child=function(t){const e=this,n=t;if(e.dom instanceof Jn)for(let t=0;t<n.length;t+=1)n[t].dom.parent=e,e.children[e.children.length]=n[t];else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex),e},Kn.prototype.updateBBox=function(){let t;if(this.bbox){for(let e=0,n=this.children.length;e<n;e+=1)this.children[e]&&(t=this.children[e].updateBBox()||t);if(this.BBoxUpdate||t)return this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0}return!1},Kn.prototype.in=function(t){return this.dom.in(t)},Kn.prototype.on=function(t,e){const n=this;if(this.events||(this.events={}),!e&&this.events[t])delete this.events[t];else if(e)if("function"==typeof e){const i=e.bind(n);this.events[t]=function(t){i(t)}}else"object"==typeof e&&(this.events[t]=e,e.constructor!==kn.constructor&&e.constructor!==En.constructor||e.bindMethods(this));return this},Kn.prototype.animatePathTo=Mt.animatePathTo,Kn.prototype.morphTo=Mt.morphTo,Kn.prototype.vDomIndex=null,Kn.prototype.createRadialGradient=function(t){return new zn(t,"radial")},Kn.prototype.createLinearGradient=function(t){return new zn(t,"linear")},Kn.prototype.createEls=function(t,e){const n=new Cn({type:"CANVAS",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(n.stack),An.vDomChanged(this.vDomIndex),n},Kn.prototype.text=function(t){return this.dom instanceof Yn&&this.dom.text(t),An.vDomChanged(this.vDomIndex),this},Kn.prototype.createEl=function(t){const e=new Kn(this.dom.ctx,t,Sn(),this.vDomIndex);return this.child([e]),An.vDomChanged(this.vDomIndex),e},Kn.prototype.removeChild=function(t){let e=-1;if(this.children.forEach(((n,i)=>{n===t&&(e=i)})),-1!==e){const t=this.children.splice(e,1)[0];this.dom.removeChild(t.dom)}this.BBoxUpdate=!0,An.vDomChanged(this.vDomIndex)},Kn.prototype.getBBox=function(){return{x:this.dom.BBox.x,y:this.dom.BBox.y,width:this.dom.BBox.width,height:this.dom.BBox.height}},Kn.prototype.getPixels=function(){return new In(this.ctx.getImageData(this.dom.BBox.x,this.dom.BBox.y,this.dom.BBox.width,this.dom.BBox.height),this.dom.BBox.width,this.dom.BBox.height)},Kn.prototype.putPixels=function(t){if(t instanceof In)return this.ctx.putImageData(t.imageData,this.dom.BBox.x,this.dom.BBox.y)},ni.prototype.setAttr=function(t,e){"height"===t?(this.canvas.setAttribute("height",e),this.canvas.style.height=e+"px"):"width"===t&&(this.canvas.setAttribute("width",e),this.canvas.style.width=e+"px")},oi.prototype=new Ye,oi.prototype.constructor=oi,oi.prototype.setAttr=function(t,e){const n=this;if("src"===t)if(Array.isArray(e)){const t=e.map((function(t){return new Promise(((e,n)=>{const i=ii(null,t);i.onload=function(){e(this)},i.onerror=function(t){n(t)}}))}));Promise.all(t).then((function(t){n.image=t,n.imageObj=t[n.seekIndex],n.attr&&n.attr.onload&&"function"==typeof n.attr.onload&&n.attr.onload.call(n,t),n.asyncOnLoad&&"function"==typeof n.asyncOnLoad&&n.asyncOnLoad(t),ri(n)}))}else"string"==typeof e?(n.image||(n.image=ii(n,e)),n.image.src!==e&&(n.image.src=e)):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement?(n.imageObj=e,n.attr.height=n.attr.height?n.attr.height:e.height,n.attr.width=n.attr.width?n.attr.width:e.width,ri(n)):(e instanceof Kn||e instanceof oi)&&(n.imageObj=e.domEl,n.attr.height=n.attr.height?n.attr.height:e.height,n.attr.width=n.attr.width?n.attr.width:e.width,ri(n));this.attr[t]=e,"height"!==t&&"width"!==t||(this.rImageObj.setAttr(t,e),ri(n)),"clip"!==t&&"filter"!==t||ri(n)},oi.prototype.onLoad=function(t){this.asyncOnLoad=t},oi.prototype.clone=function(){const t=Object.assign({},this.attr),e=Object.assign({},this.style);return t.src=this,new oi(this.nodeExe,{attr:t,style:e})},oi.prototype.execute=function(){const{width:t=0,height:e=0}=this.attr,n=this.attr.draw||{};this.ctx.clearRect(0,0,t,e),this.ctx.drawImage(this.imageObj,n.x||0,n.y||0,n.width||t,n.height||e)},oi.prototype.next=function(t){Array.isArray(this.image)&&(t<this.image.length&&t>=0?this.seekIndex=t:this.seekIndex<this.image.length-1&&this.seekIndex++,this.imageObj=this.image[this.seekIndex],ri(this))};var ai=ei,hi=si;function ci(t){let e;switch(t){case"point":e={vertexShader:"\n          precision highp float;\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_size;\n          \n          attribute mat3 a_transformMatrix;\n          \n          varying vec4 v_color;\n          void main() {\n            gl_Position = vec4(a_transformMatrix * vec3(a_position, 1), 1);\n            gl_PointSize = a_size;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "};break;case"circle":e={vertexShader:"\n                  precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    attribute float a_radius;\n                    attribute mat3 a_transformMatrix;\n                    varying vec4 v_color;\n\n                    void main() {\n                      gl_Position = vec4(a_transformMatrix * vec3(a_position, 1), 1);\n                      gl_PointSize = a_radius; // * a_transform.z * u_transform.z;\n                      v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                      float r = 0.0, delta = 0.0, alpha = 1.0;\n                      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                      r = dot(cxy, cxy);\n                      if(r > 1.0) {\n                        discard;\n                      }\n                      delta = 0.09;\n                      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n                      gl_FragColor = v_color * alpha;\n                    }\n                    "};break;case"image":e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec2 a_texCoord;\n                    uniform mat3 u_transformMatrix;\n                    varying vec2 v_texCoord;\n\n                    void main() {\n                      gl_Position = vec4(u_transformMatrix * vec3(a_position, 1), 1);\n                      v_texCoord = a_texCoord;\n                    }\n          ",fragmentShader:"\n                    precision mediump float;\n                    uniform sampler2D u_image;\n                    uniform float u_opacity;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      vec4 col = texture2D(u_image, v_texCoord);\n                      if (col.a == 0.0) {\n                        discard;\n                      } else {\n                        gl_FragColor = col;\n                        gl_FragColor.a *= u_opacity;\n                      }\n                    }\n                    "};break;case"polyline":case"polygon":e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    uniform mat3 u_transformMatrix;\n\n                    void main() {\n                      gl_Position = vec4(u_transformMatrix * vec3(a_position, 1), 1);\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    uniform vec4 u_color;\n                    void main() {\n                        gl_FragColor = u_color;\n                    }\n                    "};break;case"rect":case"line":e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    attribute mat3 a_transformMatrix;\n                    varying vec4 v_color;\n\n                    void main() {\n                      gl_Position = vec4(a_transformMatrix * vec3(a_position, 1), 1);\n                      v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "};break;default:e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    attribute mat3 a_transformMatrix;\n                    varying vec4 v_color;\n\n                    void main() {\n                      gl_Position = vec4(a_transformMatrix * vec3(a_position, 1), 1);\n                      v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "}}return e}var li=fi,pi=fi;function fi(t,e,n){n=n||2;var i,r,o,s,a,h,c,l=e&&e.length,p=l?e[0]*n:t.length,f=ui(t,0,p,n,!0),u=[];if(!f||f.next===f.prev)return u;if(l&&(f=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=ui(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(Ti(s));for(a.sort(bi),r=0;r<a.length;r++)wi(a[r],n),n=di(n,n.next);return n}(t,e,f,n)),t.length>80*n){i=o=t[0],r=s=t[1];for(var d=n;d<p;d+=n)(a=t[d])<i&&(i=a),(h=t[d+1])<r&&(r=h),a>o&&(o=a),h>s&&(s=h);c=0!==(c=Math.max(o-i,s-r))?1/c:0}return yi(f,u,n,i,r,c),u}function ui(t,e,n,i,r){var o,s;if(r===Ni(t,e,n,i)>0)for(o=e;o<n;o+=i)s=Pi(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=Pi(o,t[o],t[o+1],s);return s&&Ci(s,s.next)&&(Oi(s),s=s.next),s}function di(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Ci(i,i.next)&&0!==Si(i.prev,i,i.next))i=i.next;else{if(Oi(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function yi(t,e,n,i,r,o,s){if(t){!s&&o&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=Ai(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,h,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ);e++);for(h=c;a>0||h>0&&i;)0!==a&&(0===h||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,h--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(s>1)}(r)}(t,i,r,o);for(var a,h,c=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?mi(t,i,r,o):xi(t))e.push(a.i/n),e.push(t.i/n),e.push(h.i/n),Oi(t),t=h.next,c=h.next;else if((t=h)===c){s?1===s?yi(t=gi(di(t),e,n),e,n,i,r,o,2):2===s&&vi(t,e,n,i,r,o):yi(di(t),e,n,i,r,o,1);break}}}function xi(t){var e=t.prev,n=t,i=t.next;if(Si(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(ki(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Si(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function mi(t,e,n,i){var r=t.prev,o=t,s=t.next;if(Si(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,h=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,c=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,l=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,p=Ai(a,h,e,n,i),f=Ai(c,l,e,n,i),u=t.prevZ,d=t.nextZ;u&&u.z>=p&&d&&d.z<=f;){if(u!==t.prev&&u!==t.next&&ki(r.x,r.y,o.x,o.y,s.x,s.y,u.x,u.y)&&Si(u.prev,u,u.next)>=0)return!1;if(u=u.prevZ,d!==t.prev&&d!==t.next&&ki(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&Si(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;u&&u.z>=p;){if(u!==t.prev&&u!==t.next&&ki(r.x,r.y,o.x,o.y,s.x,s.y,u.x,u.y)&&Si(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&ki(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&Si(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function gi(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Ci(r,o)&&Di(r,i,i.next,o)&&zi(r,o)&&zi(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),Oi(i),Oi(i.next),i=t=o),i=i.next}while(i!==t);return di(i)}function vi(t,e,n,i,r,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&Ei(s,a)){var h=Ii(s,a);return s=di(s,s.next),h=di(h,h.next),yi(s,e,n,i,r,o),void yi(h,e,n,i,r,o)}a=a.next}s=s.next}while(s!==t)}function bi(t,e){return t.x-e.x}function wi(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n;var h,c=n,l=n.x,p=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=l&&r!==i.x&&ki(o<p?r:s,o,l,p,o<p?s:r,o,i.x,i.y)&&(h=Math.abs(o-i.y)/(r-i.x),zi(i,t)&&(h<f||h===f&&(i.x>n.x||i.x===n.x&&Bi(n,i)))&&(n=i,f=h)),i=i.next}while(i!==c);return n}(t,e)){var n=Ii(e,t);di(e,e.next),di(n,n.next)}}function Bi(t,e){return Si(t.prev,t,e.prev)<0&&Si(e.next,t,t.next)<0}function Ai(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ti(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ki(t,e,n,i,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function Ei(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Di(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(zi(t,e)&&zi(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Si(t.prev,t,e.prev)||Si(t,e.prev,e))||Ci(t,e)&&Si(t.prev,t,t.next)>0&&Si(e.prev,e,e.next)>0)}function Si(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ci(t,e){return t.x===e.x&&t.y===e.y}function Di(t,e,n,i){var r=_i(Si(t,e,n)),o=_i(Si(t,e,i)),s=_i(Si(n,i,t)),a=_i(Si(n,i,e));return r!==o&&s!==a||(!(0!==r||!Mi(t,n,e))||(!(0!==o||!Mi(t,i,e))||(!(0!==s||!Mi(n,t,i))||!(0!==a||!Mi(n,e,i)))))}function Mi(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function _i(t){return t>0?1:t<0?-1:0}function zi(t,e){return Si(t.prev,t,t.next)<0?Si(t,e,t.next)>=0&&Si(t,t.prev,e)>=0:Si(t,e,t.prev)<0||Si(t,t.next,e)<0}function Ii(t,e){var n=new Li(t.i,t.x,t.y),i=new Li(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Pi(t,e,n,i){var r=new Li(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Oi(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Li(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ni(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}fi.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(Ni(t,0,o,n));if(r)for(var a=0,h=e.length;a<h;a++){var c=e[a]*n,l=a<h-1?e[a+1]*n:t.length;s-=Math.abs(Ni(t,c,l,n))}var p=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,u=i[a+1]*n,d=i[a+2]*n;p+=Math.abs((t[f]-t[d])*(t[u+1]-t[f+1])-(t[f]-t[u])*(t[d+1]-t[f+1]))}return 0===s&&0===p?0:Math.abs((p-s)/s)},fi.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n},li.default=pi;const Fi=F;let Ri;const ji=x,Xi=wn.zoom(),Yi=wn.drag();let Gi=0;function Ui(){return Gi+=1,Gi}function Hi(t){const e={translateX:0,translateY:0,scaleX:1,scaleY:1,angle:0};return t&&(t.translate&&t.translate.length>0&&(e.translateX=t.translate[0],e.translateY=t.translate[1]),t.scale&&t.scale.length>0&&(e.scaleX=t.scale[0],e.scaleY=t.scale[1]||e.scaleX),t.rotate&&t.rotate.length>0&&(e.angle=t.rotate[0])),e}function Vi(){const t=this,{transform:e,points:n=[]}=t.attr,{translateX:i,translateY:r,scaleX:o,scaleY:s}=Hi(e);if(n&&n.length>0){let e=n[0].x,a=n[0].x,h=n[0].y,c=n[0].y;for(let t=1;t<n.length;t+=1)e>n[t].x&&(e=n[t].x),a<n[t].x&&(a=n[t].x),h>n[t].y&&(h=n[t].y),c<n[t].y&&(c=n[t].y);t.BBox={x:i+e*o,y:r+h*s,width:(a-e)*o,height:(c-h)*s}}else t.BBox={x:0,y:0,width:0,height:0};e&&e.rotate?t.BBoxHit=Fi.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox}var qi=function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],h=t[6],c=t[7],l=t[8],p=e[0],f=e[1],u=e[2],d=e[3],y=e[4],x=e[5],m=e[6],g=e[7],v=e[8];return[p*n+f*o+u*h,p*i+f*s+u*c,p*r+f*a+u*l,d*n+y*o+x*h,d*i+y*s+x*c,d*r+y*a+x*l,m*n+g*o+v*h,m*i+g*s+v*c,m*r+g*a+v*l]},Zi=function(t,e,n){return n&&n[6]===t&&n[7]===e?n:[1,0,0,0,1,0,t,e,1]},Wi=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,-n,0,n,e,0,0,0,1]},$i=function(t,e){return[t,0,0,0,e,0,0,0,1]},Qi=function(){return[1,0,0,0,1,0,0,0,1]},Ji=function(t,e){return[2/t,0,0,0,-2/e,0,-1,1,1]};function Ki(t){const e=this.attr.transform;let n=t||this.projectionMatrix;if(e&&e.translate&&(this.translationMatrix=Zi(e.translate[0],e.translate[1],this.translationMatrix),n=qi(n,this.translationMatrix)),e&&e.rotate){const t=Math.PI/180*e.rotate[0];this.rotationMatrix=Wi(t),this.rotationCentric=Zi(e.rotate[1]||0,e.rotate[2]||0,this.rotationCentric),n=qi(n,this.rotationMatrix)}e&&e.scale&&(this.scaleMatrix=$i(e.scale[0],e.scale[1]),n=qi(n,this.scaleMatrix)),this.rotationCentric&&(n=qi(n,this.rotationCentric)),this.transformMatrix=n}const tr=function(){He.apply(this,arguments)};function er(t,e,n){var i=t.createShader(n);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(i);return console.error("*** Error compiling shader '"+i+"':"+r),t.deleteShader(i),null}return i}function nr(t,e){return function(t,e){var n=t.createProgram();if(e.forEach((function(e){t.attachShader(n,e)})),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS)){var i=t.getProgramInfoLog(n);return console.error("Error in program linking:"+i),t.deleteProgram(n),null}return n}(t,[er(t,e.vertexShader,t.VERTEX_SHADER),er(t,e.fragmentShader,t.FRAGMENT_SHADER)])}function ir(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}function rr(t,e,n){this.ctx=t,this.attr=e||{},this.style=n||{},this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null)}function or(t,e,n){this.ctx=t,this.attr=e||{},this.style=n||{},this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null)}function sr(t,e,n){const i=this;this.ctx=t,this.attr=e,this.style=n,this.pointsGeometry=[],this.transform=[0,0,1,1],this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),i.attr.d&&(Mt.isTypePath(i.attr.d)?(i.path=i.attr.d,i.attr.d=i.attr.d.fetchPathString()):i.path=Mt.instance(i.attr.d),this.points=new Float32Array(this.path.getPoints())),this.style.stroke&&(this.color=new Float32Array([this.style.stroke.r/255,this.style.stroke.g/255,this.style.stroke.b/255,void 0===this.style.stroke.a?1:this.style.stroke.a/255])),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null)}function ar(t,e,n){this.ctx=t,this.attr=e||{},this.style=n||{},this.points=[],this.transform=[0,0,1,1];const i=[];if(this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.attr.points){const t=this.attr.points;for(let e=0,n=t.length;e<n;e++)i[2*e]=t[e].x,i[2*e+1]=t[e].y;this.points=new Float32Array(i)}this.style.stroke&&(this.color=new Float32Array([this.style.stroke.r/255,this.style.stroke.g/255,this.style.stroke.b/255,void 0===this.style.stroke.a?1:this.style.stroke.a/255])),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null)}function hr(t,e,n){this.ctx=t,this.attr=e||{},this.style=n||{},this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null)}function cr(t){return li(t.reduce((function(t,e){return t[t.length]=e.x,t[t.length]=e.y,t}),[])).map((function(e){return t[e]}))}function lr(t,e,n){this.ctx=t,this.attr=e,this.style=n,this.positionArray=[],this.transform=[0,0,1,1];const i=[];if(this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.attr.points){const t=cr(this.attr.points);for(let e=0,n=t.length;e<n;e++)i[2*e]=t[e].x,i[2*e+1]=t[e].y;this.points=new Float32Array(i)}this.style.fill&&(this.color=new Float32Array([this.style.stroke.r/255,this.style.stroke.g/255,this.style.stroke.b/255,void 0===this.style.stroke.a?1:this.style.stroke.a/255])),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null)}function pr(t,e,n){this.ctx=t,this.attr=e,this.style=n,this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null)}(tr.prototype=new He).constructor=tr,tr.prototype.createNode=function(t,e,n){return new Gr(t,e,Ui(),n)},ir.prototype.exec=function(t,e){"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,e)},ir.prototype.setStyle=function(t,e){e?(this.style[t]=e,this.shader&&"fill"===t&&(void 0!==this.style.opacity&&(e.a*=this.style.opacity),this.shader.indexBased&&this.shader.updateColor(this.pindex,e)),this.shader&&"opacity"===t&&(void 0!==this.style.fill&&(this.style.fill.a*=this.style.opacity),this.shader.updateColor(this.pindex,this.style.fill))):this.style[t]&&delete this.style[t]},ir.prototype.getAttr=function(t){return this.attr[t]},ir.prototype.getStyle=function(t){return this.style[t]},rr.prototype=new ir,rr.prototype.constructor=rr,rr.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.pindex),this.shader.addColors(this.style.fill||gr,this.pindex),this.shader.addSize(this.attr.size||0,this.pindex),this.shader.addTransform(this.transformMatrix,this.pindex))},rr.prototype.setAttr=function(t,e){this.attr[t]=e,"transform"===t&&this.exec(Ki,this.p_matrix),this.shader&&("x"!==t&&"y"!==t||this.shader.updateVertex(this.pindex,this.attr.x,this.attr.y),"size"===t&&this.shader.updateSize(this.pindex,this.attr.size||0),"transform"===t&&this.shader.updateTransform(this.pindex,this.transformMatrix))},rr.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t),this.shader&&this.shader.addTransform(this.transformMatrix,this.pindex)},rr.prototype.in=function(t){const{x:e=0,y:n=0,size:i=0}=this.attr;return t.x>=e&&t.x<=e+i&&t.y>=n&&t.y<=n+i},rr.prototype.updateBBox=function(){const t=this,{transform:e,x:n=0,y:i=0,size:r=0}=t.attr,{translateX:o,translateY:s,scaleX:a,scaleY:h}=Hi(e);t.BBox={x:o+n*a,y:s+i*h,width:r*a,height:r*h},e&&e.rotate?t.BBoxHit=Fi.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},or.prototype=new ir,or.prototype.constructor=or,or.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0,this.pindex),this.shader.addColors(this.style.fill||gr,this.pindex),this.shader.addTransform(this.transformMatrix,this.pindex))},or.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t),this.shader&&this.shader.addTransform(this.transformMatrix,this.pindex)},or.prototype.setAttr=function(t,e){this.attr[t]=e,"transform"===t&&this.exec(Ki,this.p_matrix),this.shader&&("x"!==t&&"width"!==t&&"y"!==t&&"height"!==t||this.shader.updateVertex(this.pindex,this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0),"transform"===t&&this.shader.updateTransform(this.pindex,this.transformMatrix))},or.prototype.in=function(t){const{x:e=0,y:n=0,width:i=0,height:r=0}=this.attr;return t.x>=e&&t.x<=e+i&&t.y>=n&&t.y<=n+r},or.prototype.updateBBox=function(){const t=this,{transform:e,x:n=0,y:i=0,width:r=0,height:o=0}=t.attr,{translateX:s,translateY:a,scaleX:h,scaleY:c}=Hi(e);t.BBox={x:s+n*h,y:a+i*c,width:r*h,height:o*c},e&&e.rotate?t.BBoxHit=Fi.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},sr.prototype=new ir,sr.prototype.constructor=sr,sr.prototype.setShader=function(t){this.shader=t},sr.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t)},sr.prototype.setAttr=function(t,e){this.attr[t]=e,null!=e?("d"===t&&(Mt.isTypePath(e)?(this.path=e,this.attr.d=e.fetchPathString()):this.path=Mt.instance(this.attr.d),this.points=new Float32Array(this.path.getPoints())),"transform"===t&&this.exec(Ki,this.p_matrix)):delete this.attr[t]},sr.prototype.updateBBox=function(){const t=this,{transform:e}=t.attr,{translateX:n,translateY:i,scaleX:r,scaleY:o}=Hi(e);t.BBox=t.path?t.path.BBox:{x:0,y:0,width:0,height:0},t.BBox.x=n+t.BBox.x*r,t.BBox.y=i+t.BBox.y*o,t.BBox.width*=r,t.BBox.height*=o,e&&e.rotate?t.BBoxHit=Fi.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},ar.prototype=new ir,ar.prototype.constructor=ar,ar.prototype.setShader=function(t){this.shader=t},ar.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t)},ar.prototype.setAttr=function(t,e){if(this.attr[t]=e,"points"===t){const t=this.attr.points,e=[];for(let n=0,i=t.length;n<i;n++)e[2*n]=t[n].x,e[2*n+1]=t[n].y;this.points=new Float32Array(e)}"transform"===t&&this.exec(Ki,this.p_matrix)},ar.prototype.updateBBox=Vi,ar.prototype.setStyle=function(t,e){this.style[t]=e,"stroke"===t&&(this.color=new Float32Array([this.style.stroke.r/255,this.style.stroke.g/255,this.style.stroke.b/255,void 0===this.style.stroke.a?1:this.style.stroke.a/255]))},hr.prototype=new ir,hr.prototype.constructor=hr,hr.prototype.setShader=function(t){this.shader=t;const{x1:e=0,y1:n=0,x2:i=e,y2:r=n}=this.attr;this.shader&&(this.shader.addVertex(e,n,i,r,this.pindex),this.shader.addColors(this.style.stroke||gr,this.pindex),this.shader.addTransform(this.transformMatrix,this.pindex))},hr.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t),this.shader&&this.shader.addTransform(this.transformMatrix,this.pindex)},hr.prototype.setAttr=function(t,e){this.attr[t]=e,null!=e||null==this.attr[t]?("transform"===t&&this.exec(Ki,this.p_matrix),!this.shader||"x1"!==t&&"y1"!==t&&"x2"!==t&&"y2"!==t||this.shader.updateVertex(this.pindex,this.attr.x1,this.attr.y1,this.attr.x2,this.attr.y2),this.shader&&"transform"===t&&this.shader.updateTransform(this.pindex,this.transformMatrix)):delete this.attr[t]},hr.prototype.updateBBox=function(){const t=this,{transform:e,x1:n=0,y1:i=0,x2:r=0,y2:o=0}=t.attr,{translateX:s,translateY:a,scaleX:h,scaleY:c}=Hi(e);t.BBox={x:s+(n<r?n:r)*h,y:a+(i<o?i:o)*c,width:Math.abs(r-n)*h,height:Math.abs(o-i)*c},e&&e.rotate?t.BBoxHit=Fi.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},lr.prototype=new ir,lr.prototype.constructor=lr,lr.prototype.setShader=function(t){this.shader=t},lr.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t)},lr.prototype.setAttr=function(t,e){if(this.attr[t]=e,null!=e){if("points"===t){const t=[],n=cr(e);for(let e=0,i=n.length;e<i;e++)t[2*e]=n[e].x,t[2*e+1]=n[e].y;this.points=new Float32Array(t)}"transform"===t&&this.exec(Ki,this.p_matrix)}else delete this.attr[t]},lr.prototype.setStyle=function(t,e){this.style[t]=e,"fill"===t&&(this.color=new Float32Array([this.style.fill.r/255,this.style.fill.g/255,this.style.fill.b/255,void 0===this.style.fill.a?1:this.style.fill.a/255]))},lr.prototype.updateBBox=Vi,pr.prototype=new ir,pr.prototype.constructor=pr,pr.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.cx||0,this.attr.cy||0,this.pindex),this.shader.addColors(this.style.fill||gr,this.pindex),this.shader.addSize(this.attr.r||0,this.pindex),this.shader.addTransform(this.transformMatrix,this.pindex))},pr.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t),this.shader&&this.shader.addTransform(this.transformMatrix,this.pindex)},pr.prototype.setAttr=function(t,e){this.attr[t]=e,null!=e?("transform"===t&&this.exec(Ki,this.p_matrix),!this.shader||"cx"!==t&&"cy"!==t||this.shader.updateVertex(this.pindex,this.attr.cx,this.attr.cy),this.shader&&"r"===t&&this.shader.updateSize(this.pindex,this.attr.r||0),this.shader&&"transform"===t&&this.shader.updateTransform(this.pindex,this.transformMatrix)):delete this.attr[t]},pr.prototype.in=function(t,e){const{r:n=0,cx:i=0,cy:r=0}=this.attr;return Math.sqrt((t.x-i)*(t.x-i)+(t.y-r)*(t.y-r))<=n},pr.prototype.updateBBox=function(){const t=this,{transform:e,r:n=0,cx:i=0,cy:r=0}=t.attr,{translateX:o,translateY:s,scaleX:a,scaleY:h}=Hi(e);t.BBox={x:o+(i-n)*a,y:s+(r-n)*h,width:2*n*a,height:2*n*h},e&&e.rotate?t.BBoxHit=Fi.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox};const fr={};function ur(t){return 0==(t&t-1)}function dr(t,e){const n=document.createElement("canvas"),i=n.getContext("2d");(e=e||{fill:"#fff"}).font||(e.font="10px Arial");const r=parseFloat(e.font,10)||12;i.font=e.font;const o=i.measureText(t).width,s=r;n.setAttribute("height",s*Ri),n.setAttribute("width",o*Ri),n.style.width=o,n.style.height=s,e.font=r*Ri+(isNaN(parseFloat(e.font,10))?e.font:e.font.substring(r.toString().length));for(const t in e)i[t]=e[t];return i.fillText(t,0,.75*s*Ri),{dom:n,ctx:i,width:o,height:s,ratio:Ri,style:e,str:t,updateText:function(){!function(t,e,n,i){t.clearRect(0,0,e*i,n*i)}(this.ctx,this.width,this.height,this.ratio);for(const t in this.style)this.ctx[t]=this.style[t];this.ctx.fillText(this.str,0,.75*this.height)}}}function yr(t,e,n,i){const r=this;this.ctx=t,this.attr=e,this.style=n,this.vDomIndex=i,this.positionArray=new Float32Array(12),this.transform=[0,0,1,1],this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null),r.attr.text&&"string"==typeof r.attr.text&&(this.text=dr(r.attr.text,r.style),this.attr.width=this.text.width,this.attr.height=this.text.height),this.text&&(this.textureNode=new Vr(t,{src:this.text.dom},this.vDomIndex))}function xr(t,e,n,i){const r=this;if(this.ctx=t,this.attr=e,this.style=n,this.vDomIndex=i,this.positionArray=new Float32Array(12),this.transform=[0,0,1,1],this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null),r.attr.src&&"string"==typeof r.attr.src&&!fr[r.attr.src]?(this.textureNode=new Vr(t,{src:this.attr.src},this.vDomIndex),fr[r.attr.src]=this.textureNode):r.attr.src&&r.attr.src instanceof Ye?this.textureNode=new Vr(t,{src:this.attr.src},this.vDomIndex):"string"==typeof r.attr.src&&fr[r.attr.src]?this.textureNode=fr[r.attr.src]:r.attr.src&&r.attr.src instanceof Vr&&(this.textureNode=r.attr.src),this.attr.x||this.attr.y||this.attr.width||this.attr.height){const t=this.attr.x||0,e=this.attr.y||0,n=t+(this.attr.width||0),i=e+(this.attr.height||0);this.positionArray[0]=this.positionArray[4]=this.positionArray[6]=t,this.positionArray[1]=this.positionArray[3]=this.positionArray[9]=e,this.positionArray[2]=this.positionArray[8]=this.positionArray[10]=n,this.positionArray[5]=this.positionArray[7]=this.positionArray[11]=i}}function mr(t,e,n,i,r){this.ctx=t,this.attr=e,this.style=n,this.renderTarget=i,this.vDomIndex=r,e.shaderType&&(this.shader=Yr(t,e,n,e.shaderType,this.renderTarget,r)),this.projectionMatrix=Ji(this.ctx.canvas.width/Ri,this.ctx.canvas.height/Ri),this.transformMatrix=qi(this.projectionMatrix,Qi()),this.attr.transform&&this.exec(Ki,null)}yr.prototype=new ir,yr.prototype.constructor=yr,yr.prototype.setShader=function(t){this.shader=t},yr.prototype.setAttr=function(t,e){if(this.attr[t]=e,null!=e){if("text"===t&&"string"==typeof e&&(this.text?this.text=dr(this.attr.text,this.style):this.text=dr(e,this.style),this.attr.width=this.text.width,this.attr.height=this.text.height,this.textureNode?this.textureNode.setAttr("src",this.text.dom):this.textureNode=new Vr(this.ctx,{src:this.text.dom},this.vDomIndex)),"transform"===t&&this.exec(Ki,this.p_matrix),"x"===t||"y"===t){const t=this.attr.x||0,e=this.attr.y||0,n=t+(this.attr.width||0),i=e+(this.attr.height||0);this.positionArray[0]=this.positionArray[4]=this.positionArray[6]=t,this.positionArray[1]=this.positionArray[3]=this.positionArray[9]=e,this.positionArray[2]=this.positionArray[8]=this.positionArray[10]=n,this.positionArray[5]=this.positionArray[7]=this.positionArray[11]=i}}else delete this.attr[t]},yr.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t)},yr.prototype.setStyle=function(t,e){if(this.style[t]=e,this.text)if(this.text.style[t]=e,"font"===t){const t=parseFloat(e,10)||12;this.text.ctx.font=e;const n=this.text.ctx.measureText(this.attr.text).width,i=t;this.text.style.font=t*Ri+(isNaN(parseFloat(e,10))?this.style.font:this.style.font.substring(t.toString().length)),this.text.updateText(),this.text.dom.setAttribute("height",i*Ri),this.text.dom.setAttribute("width",n*Ri),this.attr.width=n,this.attr.height=i,this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0)}else this.text.style[t]=e,this.text.updateText(),this.textureNode.setAttr("src",this.text.dom)},yr.prototype.getAttr=function(t){return this.attr[t]},yr.prototype.getStyle=function(t){return this.style[t]},yr.prototype.in=function(t){const{width:e=0,height:n=0,x:i=0,y:r=0}=this.attr;return t.x>=i&&t.x<=i+e&&t.y>=r&&t.y<=r+n},yr.prototype.updateBBox=function(){const t=this,{transform:e,x:n=0,y:i=0,width:r=0,height:o=0}=t.attr,{translateX:s,translateY:a,scaleX:h,scaleY:c}=Hi(e);t.BBox={x:(s+n)*h,y:(a+i)*c,width:r*h,height:o*c},e&&e.rotate?t.BBoxHit=Fi.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},xr.prototype=new ir,xr.prototype.constructor=xr,xr.prototype.setShader=function(t){this.shader=t},xr.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t)},xr.prototype.setAttr=function(t,e){if(this.attr[t]=e,null!=e){if("src"===t&&"string"==typeof e?e&&!fr[e]?(this.textureNode=new Vr(this.ctx,{src:e},this.vDomIndex),fr[e]=this.textureNode):e&&fr[e]&&(this.textureNode=fr[e]):"src"===t&&e instanceof Ye?this.textureNode=new Vr(this.ctx,{src:e},this.vDomIndex):"src"===t&&e instanceof Vr&&(this.textureNode=e),"x"===t||"width"===t||"y"===t||"height"===t){const t=this.attr.x||0,e=this.attr.y||0,n=t+(this.attr.width||0),i=e+(this.attr.height||0);this.positionArray[0]=this.positionArray[4]=this.positionArray[6]=t,this.positionArray[1]=this.positionArray[3]=this.positionArray[9]=e,this.positionArray[2]=this.positionArray[8]=this.positionArray[10]=n,this.positionArray[5]=this.positionArray[7]=this.positionArray[11]=i}"transform"===t&&this.exec(Ki,this.p_matrix)}else delete this.attr[t]},xr.prototype.setStyle=function(t,e){e?this.style[t]=e:this.style[t]&&delete this.style[t]},xr.prototype.getAttr=function(t){return this.attr[t]},xr.prototype.getStyle=function(t){return this.style[t]},xr.prototype.in=function(t){const{width:e=0,height:n=0,x:i=0,y:r=0}=this.attr;return t.x>=i&&t.x<=i+e&&t.y>=r&&t.y<=r+n},xr.prototype.updateBBox=function(){const t=this,{transform:e,x:n=0,y:i=0,width:r=0,height:o=0}=t.attr,{translateX:s,translateY:a,scaleX:h,scaleY:c}=Hi(e);t.BBox={x:(s+n)*h,y:(a+i)*c,width:r*h,height:o*c},e&&e.rotate?t.BBoxHit=Fi.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},mr.prototype=new ir,mr.prototype.constructor=mr,mr.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Ki,t),this.transformMatrix=qi(this.transformMatrix,t)},mr.prototype.setAttr=function(t,e){this.attr[t]=e,"shaderType"===t&&(this.shader=Yr(this.ctx,this.attr,this.style,e,this.renderTarget,this.vDomIndex)),"transform"===t&&this.exec(Ki,this.p_matrix)},mr.prototype.setShader=function(){},mr.prototype.in=function(t){const e=t.x,n=t.y,{BBox:i}=this,{transform:r}=this.attr,{translateX:o,translateY:s,scaleX:a,scaleY:h}=Hi(r);return e>=(i.x-o)/a&&e<=(i.x-o+i.width)/a&&n>=(i.y-s)/h&&n<=(i.y-s+i.height)/h},mr.prototype.updateBBox=function(t){const e=this;let n,i,r,o;const{transform:s}=e.attr,{translateX:a,translateY:h,scaleX:c,scaleY:l}=Hi(s);if(e.BBox={},t&&t.length>0){let e,s,a;for(let h=0;h<t.length;h+=1)e=t[h],e&&(s=e.dom.BBoxHit.x,a=e.dom.BBoxHit.y,n=void 0===n||n>s?s:n,r=void 0===r||r>a?a:r,i=void 0===i||i<s+e.dom.BBoxHit.width?s+e.dom.BBoxHit.width:i,o=void 0===o||o<a+e.dom.BBoxHit.height?a+e.dom.BBoxHit.height:o)}n=void 0===n?0:n,r=void 0===r?0:r,i=void 0===i?0:i,o=void 0===o?0:o,e.BBox.x=a+n*c,e.BBox.y=h+r*l,e.BBox.width=Math.abs(i-n)*c,e.BBox.height=Math.abs(o-r)*l,e.attr.transform&&e.attr.transform.rotate?e.BBoxHit=Fi.rotateBBox(this.BBox,this.attr.transform):e.BBoxHit=this.BBox};const gr=Ft.rgba(0,0,0,255);function vr(t,e,n,i){let r=i.type;r||(r="FLOAT",i.value instanceof Float32Array?r="FLOAT":i.value instanceof Int8Array?r="BYTE":i.value instanceof Int16Array?r="SHORT":i.value instanceof Uint8Array?r="UNSIGNED_BYTE":i.value instanceof Uint16Array&&(r="UNSIGNED_SHORT"));const o=t.createBuffer(),s={bufferType:t.ARRAY_BUFFER,buffer:o,drawType:t.STATIC_DRAW,valueType:t[r],size:i.size,attributeLocation:t.getAttribLocation(e,n),value:i.value,attr:n};return t.bindBuffer(s.bufferType,s.buffer),t.bufferData(s.bufferType,s.value,s.drawType),s}function br(t,e,n,i){let r;const o=i.size?i.size:i.value.length;return i.matrix?Number.isInteger(Math.sqrt(i.value.length))?r="uniformMatrix"+Math.sqrt(i.value.length)+"fv":console.error("Not Square Matrix"):i.value instanceof Vr?r="uniform1i":i.value instanceof Float32Array?r="uniform"+o+"fv":i.value instanceof Int8Array||i.value instanceof Int16Array||i.value instanceof Uint8Array?r="uniform"+o+"iv":Number.isInteger(i.value)?Number.isInteger(i.value)&&(r="uniform1i"):r="uniform1f",{matrix:i.matrix,transpose:void 0!==i.transpose&&i.transpose,type:r,value:i.value,uniformLocation:t.getUniformLocation(e,n)}}function wr(t,e,n){this.ctx=t,this.dom={BBoxHit:{x:0,y:0,height:0,width:0}},this.shader=e,this.vDomIndex=n,this.program=nr(t,e),this.uniforms={},this.attr={},this.attrObjs={},this.indexesObj=null,this.preDraw=e.preDraw,this.postDraw=e.postDraw,this.geometry=e.geometry,this.renderTarget=e.renderTarget;for(const n in e.uniforms)this.uniforms[n]=br(t,this.program,n,e.uniforms[n]);this.geometry&&(this.geometry instanceof Wr||this.geometry instanceof $r||this.geometry instanceof Qr?(this.attributes=this.geometry.attributes,this.indexes=this.geometry.indexes):console.error("Wrong Geometry type"));for(const e in this.attributes)this.attrObjs[e]=vr(t,this.program,e,this.attributes[e]);this.indexes&&(this.indexesObj=function(t,e,n){let i="FLOAT";return n.value instanceof Float32Array?i="FLOAT":n.value instanceof Int8Array?i="BYTE":n.value instanceof Int16Array?i="SHORT":n.value instanceof Uint8Array?i="UNSIGNED_BYTE":n.value instanceof Uint16Array&&(i="UNSIGNED_SHORT"),{bufferType:t.ELEMENT_ARRAY_BUFFER,buffer:t.createBuffer(),drawType:t.STATIC_DRAW,valueType:t[i],value:n.value,count:n.count,offset:n.offset}}(t,this.program,this.indexes))}function Br(){}function Ar(t,e,n,i){t.transform=t.transformTyped&&t.transformTyped.length>0?Array.from(t.transformTyped):t.transform,t.transformTyped=null;const r=e*n*9;let o=0;for(;o<n;)t.transform[r+9*o]=i[0],t.transform[r+9*o+1]=i[1],t.transform[r+9*o+2]=i[2],t.transform[r+9*o+3]=i[3],t.transform[r+9*o+4]=i[4],t.transform[r+9*o+5]=i[5],t.transform[r+9*o+6]=i[6],t.transform[r+9*o+7]=i[7],t.transform[r+9*o+8]=i[8],o++;t.addTransform_=!0,t.transformUpdate=!0}function Tr(t,e,n,i){const r=t.addTransform_?t.transform:t.transformTyped,o=e*n*9;let s=0;for(;s<n;)r[o+9*s]=i[0],r[o+9*s+1]=i[1],r[o+9*s+2]=i[2],r[o+9*s+3]=i[3],r[o+9*s+4]=i[4],r[o+9*s+5]=i[5],r[o+9*s+6]=i[6],r[o+9*s+7]=i[7],r[o+9*s+8]=i[8],s++;t.updateTransform_=!0}function kr(t,e,n){const i=t.addTransform_?t.transform:t.transformTyped,r=e*n*9;let o=0;for(;o<n;)i[r+9*o]=void 0,i[r+9*o+1]=void 0,i[r+9*o+2]=void 0,i[r+9*o+3]=void 0,i[r+9*o+4]=void 0,i[r+9*o+5]=void 0,i[r+9*o+6]=void 0,i[r+9*o+7]=void 0,i[r+9*o+8]=void 0,o++;t.clearTransform_=!0,t.filterTransformUpdate=!0}function Er(t){t.addTransform_&&(t.clearTransform_&&(t.transform=t.transform.filter((function(t){return!isNaN(t)})),t.clearTransform_=!1),t.transformTyped=new Float32Array(t.transform),t.transform=[],t.addTransform_=!1,t.updateTransform_=!1,t.shaderInstance.setAttributeData("a_transformMatrix",t.transformTyped)),t.clearTransform_&&(t.transformTyped=t.transformTyped.filter((function(t){return!isNaN(t)})),t.clearTransform_=!1,t.shaderInstance.setAttributeData("a_transformMatrix",t.transformTyped)),t.updateTransform_&&(t.shaderInstance.setAttributeData("a_transformMatrix",t.transformTyped),t.updateTransform_=!1)}function Sr(t,e,n,i){t.positionArray=t.typedPositionArray&&t.typedPositionArray.length>0?Array.from(t.typedPositionArray):t.positionArray,t.typedPositionArray=null;const r=e*n*2;let o=0;for(;o<i.length;)t.positionArray[r+o]=i[o],o++;t.addVertex_=!0}function Cr(t,e,n,i){const r=t.addVertex_?t.positionArray:t.typedPositionArray,o=e*n*2;let s=0;for(isNaN(r[o])&&console.log("overriding Nan");s<i.length;)r[o+s]=i[s],s++;t.updateVertex_=!0}function Dr(t,e,n){const i=t.addVertex_?t.positionArray:t.typedPositionArray,r=e*n*2;let o=0;for(;o<n;)i[r+2*o]=void 0,i[r+2*o+1]=void 0,o++;t.filterVertex_=!0}function Mr(t){t.addVertex_&&(t.filterVertex_&&(t.positionArray=t.positionArray.filter((function(t){return!isNaN(t)})),t.filterVertex_=!1),t.typedPositionArray=new Float32Array(t.positionArray),t.positionArray=[],t.addVertex_=!1,t.updateVertex_=!1,t.shaderInstance.setAttributeData("a_position",t.typedPositionArray)),t.filterVertex_&&(t.typedPositionArray=t.typedPositionArray.filter((function(t){return!isNaN(t)})),t.filterVertex_=!1,t.shaderInstance.setAttributeData("a_position",t.typedPositionArray)),t.updateVertex_&&(t.shaderInstance.setAttributeData("a_position",t.typedPositionArray),t.updateVertex_=!1)}function _r(t,e,n,i){t.colorArray=t.typedColorArray&&t.typedColorArray.length>0?Array.from(t.typedColorArray):t.colorArray,t.typedColorArray=null;const r=e*n*4;let o=0;for(i=Ft.colorToRGB(i);o<n;)t.colorArray[r+4*o]=i.r/255,t.colorArray[r+4*o+1]=i.g/255,t.colorArray[r+4*o+2]=i.b/255,t.colorArray[r+4*o+3]=void 0===i.a?1:i.a/255,o++;t.addColor_=!0}function zr(t,e,n,i){const r=t.addColor_?t.colorArray:t.typedColorArray;isNaN(r[e*n*4])&&console.log("overriding Nan");const o=e*n*4;let s=0;for(;s<n;)r[o+4*s]=i.r/255,r[o+4*s+1]=i.g/255,r[o+4*s+2]=i.b/255,r[o+4*s+3]=void 0===i.a?1:i.a/255,s++;t.updateColor_=!0}function Ir(t,e,n){const i=t.addColor_?t.colorArray:t.typedColorArray;isNaN(i[e*n*4])&&console.log("overriding Nan");const r=e*n*4;let o=0;for(;o<n;)i[r+4*o]=void 0,i[r+4*o+1]=void 0,i[r+4*o+2]=void 0,i[r+4*o+3]=void 0,o++;t.filterColor_=!0}function Pr(t){t.addColor_&&(t.filterColor_&&(t.colorArray=t.colorArray.filter((function(t){return!isNaN(t)})),t.filterColor_=!1),t.typedColorArray=new Float32Array(t.colorArray),t.colorArray=[],t.addColor_=!1,t.updateColor_=!1,t.shaderInstance.setAttributeData("a_color",t.typedColorArray)),t.filterColor_&&(t.typedColorArray=t.typedColorArray.filter((function(t){return!isNaN(t)})),t.shaderInstance.setAttributeData("a_color",t.typedColorArray),t.filterColor_=!1),t.updateColor_&&(t.shaderInstance.setAttributeData("a_color",t.typedColorArray),t.updateColor_=!1)}function Or(t,e,n,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=n||{},this.vDomIndex=i,this.indexBased=!0,this.transform=[],this.selftransform=[0,0,1,1],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new $r,this.geometry.setAttr("a_color",{value:new Float32Array([]),size:4}),this.geometry.setAttr("a_size",{value:new Float32Array([]),size:1}),this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.geometry.setAttr("a_transformMatrix",{value:new Float32Array(this.transform),size:3}),this.shaderInstance=new wr(t,{fragmentShader:ci("point").fragmentShader,vertexShader:ci("point").vertexShader,uniforms:{},geometry:this.geometry},i),this.positionArray=[],this.colorArray=[],this.pointsSize=[],this.transform=[],this.vertexUpdate=!0,this.colorUpdate=!0,this.sizeUpdate=!0,this.transformUpdate=!0}function Lr(t,e,n,i,r){this.ctx=t,this.dom={},this.positionArray=[],this.colorArray=[],this.transform=[],this.rotate=[],this.attr=e||{},this.style=n||{},this.vDomIndex=r,this.renderTarget=i,this.indexBased=!0,this.selftransform=[0,0,1,1],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Wr,this.geometry.setAttr("a_transformMatrix",{value:new Float32Array(this.transform),size:3}),this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new wr(t,{fragmentShader:ci("rect").fragmentShader,vertexShader:ci("rect").vertexShader,uniforms:{},geometry:this.geometry},r)}function Nr(t,e,n,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=n||{},this.vDomIndex=r,this.positionArray=[],this.colorArray=[],this.transform=[],this.vertexUpdate=!0,this.colorUpdate=!0,this.renderTarget=i,this.indexBased=!0,this.selftransform=new Float32Array([0,0,1,1]),this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Qr,this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setAttr("a_transformMatrix",{value:new Float32Array(this.transform),size:3}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new wr(t,{fragmentShader:ci("line").fragmentShader,vertexShader:ci("line").vertexShader,uniforms:{},geometry:this.geometry},r)}function Fr(t,e,n,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=n||{},this.vDomIndex=r,this.positionArray=[],this.colorArray=[],this.renderTarget=i,this.indexBased=!1,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]});const{translateX:o,translateY:s,scaleX:a,scaleY:h}=Hi(this.attr.transform);this.transform=new Float32Array([o,s,a,h]),this.geometry=new Qr,this.geometry.drawType="LINE_STRIP",this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new wr(t,{fragmentShader:ci("polyline").fragmentShader,vertexShader:ci("polyline").vertexShader,uniforms:{u_transformMatrix:{value:new Float32Array(Qi()),matrix:!0},u_color:{value:new Float32Array(4)}},geometry:this.geometry},r)}function Rr(t,e,n,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=n||{},this.vDomIndex=r,this.colorArray=[],this.positionArray=[],this.renderTarget=i,this.indexBased=!1,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]});const{translateX:o,translateY:s,scaleX:a,scaleY:h}=Hi(this.attr.transform);this.transform=new Float32Array([o,s,a,h]),this.geometry=new Wr,this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.shaderInstance=new wr(t,{fragmentShader:ci("polygon").fragmentShader,vertexShader:ci("polygon").vertexShader,uniforms:{u_transformMatrix:{value:new Float32Array(Qi()),matrix:!0},u_color:{value:new Float32Array(4)}},geometry:this.geometry},r)}function jr(t,e,n,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=n||{},this.vDomIndex=r,this.positionArray=[],this.colorArray=[],this.transform=[],this.pointsSize=[],this.renderTarget=i,this.indexBased=!0,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new $r,this.geometry.setAttr("a_transformMatrix",{value:new Float32Array(this.transform),size:3}),this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_radius",{value:new Float32Array(this.pointsSize),size:1}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,0),this.shaderInstance=new wr(t,{fragmentShader:ci("circle").fragmentShader,vertexShader:ci("circle").vertexShader,uniforms:{},geometry:this.geometry},r)}function Xr(t,e,n,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=n||{},this.vDomIndex=r,this.textCoor=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this.renderTarget=i,this.indexBased=!1,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Wr,this.geometry.setAttr("a_texCoord",{value:this.textCoor,size:2}),this.geometry.setAttr("a_position",{value:new Float32Array([0,0]),size:2}),this.geometry.setDrawRange(0,6),this.shaderInstance=new wr(t,{fragmentShader:ci("image").fragmentShader,vertexShader:ci("image").vertexShader,uniforms:{u_transformMatrix:{value:new Float32Array(Qi()),matrix:!0},u_image:{value:new Vr(this.ctx,{},this.vDomIndex)},u_opacity:{value:1..toFixed(2)}},geometry:this.geometry},r),this.positionArray=[],this.vertexUpdate=!0}function Yr(t,e,n,i,r,o){let s;switch(i){case"rect":s=new Lr(t,e,n,r,o);break;case"point":s=new Or(t,e,n,r,o);break;case"line":s=new Nr(t,e,n,r,o);break;case"polyline":case"path":s=new Fr(t,e,n,r,o);break;case"polygon":s=new Rr(t,e,n,r,o);break;case"circle":s=new jr(t,e,n,r,o);break;case"image":case"text":s=new Xr(t,e,n,r,o);break;default:s=null}return s}function Gr(t,e,n,i){switch(this.ctx=t,this.style=e.style||{},this.attr=e.attr||{},this.id=n,this.nodeName=e.el,this.nodeType="WEBGL",this.children=[],this.ctx=t,this.vDomIndex=i,this.el=e.el,this.shaderType=e.shaderType,this.exeCtx=e.ctx,this.bbox=void 0===e.bbox||e.bbox,this.events={},e.el){case"point":this.dom=new rr(this.ctx,this.attr,this.style);break;case"rect":this.dom=new or(this.ctx,this.attr,this.style);break;case"line":this.dom=new hr(this.ctx,this.attr,this.style);break;case"polyline":this.dom=new ar(this.ctx,this.attr,this.style);break;case"polygon":this.dom=new lr(this.ctx,this.attr,this.style);break;case"path":this.dom=new sr(this.ctx,this.attr,this.style);break;case"circle":this.dom=new pr(this.ctx,this.attr,this.style);break;case"image":this.dom=new xr(this.ctx,this.attr,this.style,i);break;case"text":this.dom=new yr(this.ctx,this.attr,this.style,i);break;case"group":this.dom=new mr(this.ctx,this.attr,this.style,e.renderTarget,i);break;default:this.dom=null}this.dom.nodeExe=this,this.dom instanceof mr||(delete this.createEl,delete this.createEls)}function Ur(t){const e=new Image;return e.crossOrigin="anonymous",e.onload=function(){t.update(),t.updated=!0,ji.vDomChanged(t.vDomIndex)},e.onerror=function(t){},e}function Hr(t,e){return new Uint8Array(new ArrayBuffer(t*e*4))}function Vr(t,e,n){const i=this,r=t.getParameter(t.MAX_TEXTURE_SIZE);this.ctx=t,this.texture=t.createTexture(),this.type="TEXTURE_2D",this.width=e.width>r?r:e.width,this.height=e.height>r?r:e.height,this.border=e.border?e.border:0,this.format=e.format?e.format:"RGBA",this.type=e.type?e.type:"UNSIGNED_BYTE",this.warpS=e.warpS?e.warpS:"CLAMP_TO_EDGE",this.warpT=e.warpT?e.warpT:"CLAMP_TO_EDGE",this.magFilter=e.magFilter?e.magFilter:"LINEAR",this.minFilter=e.minFilter?e.minFilter:"LINEAR",this.mipMap=e.mipMap,this.updated=!1,this.image=null,this.vDomIndex=n,"string"==typeof e.src?(i.image=Ur(i),i.image.src=e.src):e.src instanceof HTMLImageElement||e.src instanceof SVGImageElement||e.src instanceof HTMLCanvasElement||e.src instanceof Uint8Array?(i.image=e.src,i.update(),i.updated=!0):e.src instanceof Ye?(i.image=e.src.domEl,i.update(),i.updated=!0):(this.width&&this.height&&(i.image=Hr(this.width,this.height),i.update()),i.updated=!0),ji.vDomChanged(i.vDomIndex)}function qr(t,e){this.ctx=t,this.fbo=t.createFramebuffer(),this.texture=e.texture,this.texture.updated||this.texture.update()}function Zr(){}function Wr(t){this.attributes={},this.drawType="TRIANGLES",this.indexes=null,this.drawRange=[0,0]}function $r(t){this.attributes={},this.drawType="POINTS",this.indexes=null,this.drawRange=[0,0]}function Qr(t){this.attributes={},this.drawType="LINES",this.indexes=null,this.drawRange=[0,0]}wr.prototype=new Br,wr.prototype.constructor=wr,wr.prototype.useProgram=function(){this.ctx.useProgram(this.program)},wr.prototype.applyUniforms=function(){for(const t in this.uniforms)this.uniforms[t].matrix?this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].transpose,this.uniforms[t].value):this.uniforms[t].value instanceof Vr?(this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value.texture),this.uniforms[t].value.loadTexture()):this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value)},wr.prototype.applyAttributes=function(){let t;for(const e in this.attrObjs)t=this.attrObjs[e],"a_transformMatrix"===e?(this.ctx.enableVertexAttribArray(t.attributeLocation+0),this.ctx.enableVertexAttribArray(t.attributeLocation+1),this.ctx.enableVertexAttribArray(t.attributeLocation+2),this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.vertexAttribPointer(t.attributeLocation+0,t.size,t.valueType,!1,4*t.size*3,0),this.ctx.vertexAttribPointer(t.attributeLocation+1,t.size,t.valueType,!1,4*t.size*3,12),this.ctx.vertexAttribPointer(t.attributeLocation+2,t.size,t.valueType,!1,4*t.size*3,24)):(this.ctx.enableVertexAttribArray(t.attributeLocation),this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.vertexAttribPointer(t.attributeLocation,t.size,t.valueType,!1,0,0))},wr.prototype.applyIndexes=function(){const t=this.indexesObj;this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.bufferData(t.bufferType,t.value,t.drawType)},wr.prototype.draw=function(){this.ctx.drawArrays(this.ctx[this.geometry.drawType],this.geometry.drawRange[0],this.geometry.drawRange[1])},wr.prototype.drawElements=function(){this.ctx.drawElements(this.ctx[this.geometry.drawType],this.indexesObj.count,this.indexesObj.type?this.indexesObj.type:this.ctx.UNSIGNED_SHORT,this.indexesObj.offset)},wr.prototype.updateBBox=function(t){return!0},wr.prototype.execute=function(){this.ctx.useProgram(this.program),this.applyUniforms(),this.applyAttributes(),this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update(),this.indexesObj?(this.applyIndexes(),this.drawElements()):this.draw(),this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.clear()},wr.prototype.addUniform=function(t,e){this.uniforms[t]=br(this.ctx,this.program,t,e),ji.vDomChanged(this.vDomIndex)},wr.prototype.addAttribute=function(t,e){this.attributes[t]=e,this.attrObjs[t]=vr(this.ctx,this.program,t,e),ji.vDomChanged(this.vDomIndex)},wr.prototype.setAttributeData=function(t,e){const n=this.attrObjs[t];this.attributes[t].value=e,this.attrObjs[t].value=e,this.ctx.bindBuffer(n.bufferType,n.buffer),this.ctx.bufferData(n.bufferType,n.value,n.drawType),ji.vDomChanged(this.vDomIndex)},wr.prototype.applyAttributeData=function(t,e){this.attributes[t].value=e,this.attrObjs[t].value=e;const n=this.attrObjs[t];this.ctx.bindBuffer(n.bufferType,n.buffer),this.ctx.bufferData(n.bufferType,this.attributes[n.attr].value,n.drawType),this.ctx.enableVertexAttribArray(n.attributeLocation),this.ctx.vertexAttribPointer(n.attributeLocation,n.size,n.valueType,!1,0,0)},wr.prototype.setUniformData=function(t,e){this.uniforms[t].value=e,ji.vDomChanged(this.vDomIndex)},wr.prototype.applyUniformData=function(t,e){this.uniforms[t].value=e,this.uniforms[t].matrix?this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].transpose,this.uniforms[t].value):this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value)},Br.prototype.setAttr=function(t,e){if(this.attr[t]=e,"transform"===t){const{translateX:t,translateY:e,scaleX:n,scaleY:i}=Hi(this.attr.transform);this.selftransform=new Float32Array([t,e,n,i])}},Br.prototype.translate=function(t){this.attr.transform.translate=t},Br.prototype.scale=function(t){this.attr.transform.scale=t},Br.prototype.rotate=function(t){this.attr.transform.rotate=t},Or.prototype=new Br,Or.prototype.constructor=Or,Or.prototype.clear=function(t){Ir(this,t,1),Dr(this,t,1),kr(this,t,1);(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=void 0,this.filterSizeFlag=!0},Or.prototype.addTransform=function(t,e){Ar(this,e,1,t)},Or.prototype.updateTransform=function(t,e){Tr(this,t,1,e)},Or.prototype.updateVertex=function(t,e,n){Cr(this,t,1,[e,n])},Or.prototype.updateSize=function(t,e){(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=e},Or.prototype.updateColor=function(t,e){zr(this,t,1,e)},Or.prototype.addVertex=function(t,e,n){Sr(this,n,1,[t,e])},Or.prototype.addSize=function(t,e){this.pointsSize=this.typedSizeArray&&this.typedSizeArray.length>0?Array.from(this.typedSizeArray):this.pointsSize,this.pointsSize[e]=t,this.sizeUpdate=!0},Or.prototype.addColors=function(t,e){_r(this,e,1,t)},Or.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update(),Mr(this),Pr(this),Er(this),this.sizeUpdate&&(this.filterSizeFlag&&(this.pointsSize=this.pointsSize.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.typedSizeArray=new Float32Array(this.pointsSize),this.pointsSize=[],this.sizeUpdate=!1),this.filterSizeFlag&&(this.typedSizeArray=this.typedSizeArray.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.shaderInstance.setAttributeData("a_size",this.typedSizeArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update()},Lr.prototype=new Br,Lr.prototype.constructor=Lr,Lr.prototype.clear=function(t){Ir(this,t,6),Dr(this,t,6),kr(this,t,6)},Lr.prototype.updateVertex=function(t,e,n,i,r){const o=e+i,s=n+r;Cr(this,t,6,[e,n,o,n,e,s,e,s,o,n,o,s])},Lr.prototype.updateTransform=function(t,e){Tr(this,t,6,e)},Lr.prototype.addTransform=function(t,e){Ar(this,e,6,t)},Lr.prototype.updateColor=function(t,e){zr(this,t,6,e)},Lr.prototype.addVertex=function(t,e,n,i,r){const o=t+n,s=e+i;Sr(this,r,6,[t,e,o,e,t,s,t,s,o,e,o,s])},Lr.prototype.addColors=function(t,e){_r(this,e,6,t)},Lr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update(),Pr(this),Er(this),Mr(this),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.clear()},Nr.prototype=new Br,Nr.prototype.constructor=Nr,Nr.prototype.clear=function(t){Ir(this,t,2),Dr(this,t,2)},Nr.prototype.updateTransform=function(t,e){Tr(this,t,2,e)},Nr.prototype.addTransform=function(t,e){Ar(this,e,2,t)},Nr.prototype.updateVertex=function(t,e,n,i,r){Cr(this,t,2,[e,n,i,r])},Nr.prototype.updateColor=function(t,e){zr(this,t,2,e)},Nr.prototype.addVertex=function(t,e,n,i,r){Sr(this,r,2,[t,e,n,i])},Nr.prototype.addColors=function(t,e){_r(this,e,2,t)},Nr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update(),Mr(this),Pr(this),Er(this),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.clear()},Fr.prototype=new Br,Fr.prototype.constructor=Fr,Fr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update();for(let e=0,n=t.length;e<n;e++)this.shaderInstance.applyUniformData("u_transformMatrix",t[e].dom.transformMatrix),this.shaderInstance.setAttributeData("a_position",t[e].dom.points),this.shaderInstance.setUniformData("u_color",t[e].dom.color),this.geometry.setDrawRange(0,t[e].dom.points.length/2),this.shaderInstance.execute();this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.clear()},Rr.prototype=new Br,Rr.prototype.constructor=Rr,Rr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update(),this.shaderInstance.useProgram();for(let e=0,n=t.length;e<n;e++)this.shaderInstance.applyUniformData("u_transformMatrix",t[e].dom.transformMatrix),this.shaderInstance.setAttributeData("a_position",t[e].dom.points),this.shaderInstance.setUniformData("u_color",t[e].dom.color),this.geometry.setDrawRange(0,t[e].dom.points.length/2),this.shaderInstance.execute();this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.clear()},jr.prototype=new Br,jr.prototype.constructor=jr,jr.prototype.clear=function(t){Ir(this,t,1),Dr(this,t,1),kr(this,t,1);(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=void 0,this.filterSizeFlag=!0},jr.prototype.updateTransform=function(t,e){Tr(this,t,1,e)},jr.prototype.addTransform=function(t,e){Ar(this,e,1,t)},jr.prototype.updateVertex=function(t,e,n){Cr(this,t,1,[e,n])},jr.prototype.updateColor=function(t,e){zr(this,t,1,e)},jr.prototype.updateSize=function(t,e){(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=e},jr.prototype.addVertex=function(t,e,n){Sr(this,n,1,[t,e])},jr.prototype.addSize=function(t,e){this.pointsSize=this.typedSizeArray&&this.typedSizeArray.length>0?Array.from(this.typedSizeArray):this.pointsSize,this.pointsSize[e]=t,this.sizeUpdate=!0},jr.prototype.addColors=function(t,e){_r(this,e,1,t)},jr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update(),Mr(this),Pr(this),Er(this),this.sizeUpdate&&(this.filterSizeFlag&&(this.pointsSize=this.pointsSize.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.typedSizeArray=new Float32Array(this.pointsSize),this.pointsSize=[],this.sizeUpdate=!1),this.filterSizeFlag&&(this.typedSizeArray=this.typedSizeArray.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.shaderInstance.setAttributeData("a_radius",this.typedSizeArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.clear()},Xr.prototype=new Br,Xr.prototype.constructor=Xr,Xr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.update(),this.shaderInstance.useProgram(),this.shaderInstance.applyAttributeData("a_texCoord",this.textCoor);const e=void 0!==this.style.opacity?this.style.opacity:1;let n;for(let i=0,r=t.length;i<r;i++){const r=t[i];r.dom.textureNode&&r.dom.textureNode.updated&&("none"!==r.style.display&&(this.shaderInstance.applyUniformData("u_transformMatrix",r.dom.transformMatrix),r.dom.textureNode!==n&&(r.dom.textureNode.loadTexture(),n=r.dom.textureNode,this.shaderInstance.applyUniformData("u_image",r.dom.textureNode)),this.shaderInstance.applyAttributeData("a_position",r.dom.positionArray),this.shaderInstance.applyUniformData("u_opacity",((void 0!==r.style.opacity?r.style.opacity:1)*e).toFixed(2)),this.shaderInstance.draw()))}this.renderTarget&&this.renderTarget instanceof qr&&this.renderTarget.clear()},Gr.prototype=new Ye,Gr.prototype.reIndexChildren=function(){this.children=this.children.filter((function(t){return t}));for(var t=0,e=this.children.length;t<e;t++)this.children[t].dom.pindex=t},Gr.prototype.applyTransformationMatrix=function(t){this.dom.applyTransformationMatrix(t),this.children.forEach((function(t){t.applyTransformationMatrix(self.dom.transformMatrix)}))},Gr.prototype.setAttr=function(t,e){const n=this;if(2===arguments.length)null==e&&null!=this.attr[t]?delete this.attr[t]:this.attr[t]=e,this.dom.setAttr(t,e),"transform"===t&&this.children.length>0&&this.children.forEach((function(t){t.applyTransformationMatrix(n.dom.transformMatrix)}));else if(1===arguments.length&&"object"==typeof t)for(const e in t)null==t[e]&&null!=this.attr[t]?delete this.attr[e]:this.attr[e]=t[e],this.dom.setAttr(e,t[e]),"transform"===t&&this.children.length>0&&this.children.forEach((function(t){t.applyTransformationMatrix(n.dom.transformMatrix)}));return this.BBoxUpdate=!0,ji.vDomChanged(this.vDomIndex),this},Gr.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),t.length<1?null:(this.attr.transform.scale=[t[0],t[1]?t[1]:t[0]],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,ji.vDomChanged(this.vDomIndex),this)},Gr.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,ji.vDomChanged(this.vDomIndex),this},Gr.prototype.rotate=function(t,e,n){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,n||0],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,ji.vDomChanged(this.vDomIndex),this},Gr.prototype.setStyle=function(t,e){if(2===arguments.length)null==e&&null!=this.style[t]?delete this.style[t]:("fill"!==t&&"stroke"!==t||(e=Ft.colorToRGB(e)),this.style[t]=e),this.dom.setStyle(t,e);else if(1===arguments.length&&"object"==typeof t)for(const n in t)null==(e=t[n])&&null!=this.style[n]?delete this.style[n]:("fill"!==n&&"stroke"!==n||(e=Ft.colorToRGB(e)),this.style[n]=e),this.dom.setStyle(n,e);return ji.vDomChanged(this.vDomIndex),this},Gr.prototype.setReIndex=function(){this.reindex=!0},Gr.prototype.updateBBox=function(){let t;if(this.bbox){for(let e=0,n=this.children.length;e<n;e+=1)this.children[e]&&(t=this.children[e].updateBBox()||t);if(this.BBoxUpdate||t)return this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0}return!1},Gr.prototype.in=function(t){return this.dom.in(t)},Gr.prototype.on=function(t,e){const n=this;if(this.events||(this.events={}),null==e&&null!=this.events[t])delete this.events[t];else if(e)if("function"==typeof e){const i=e.bind(n);this.events[t]=function(t){i(t)}}else"object"==typeof e&&(this.events[t]=e,e.constructor!==Xi.constructor&&e.constructor!==Yi.constructor||e.bindMethods(this));return this},Gr.prototype.execute=function(){if("none"!==this.style.display)if(!this.dom.shader&&this.dom instanceof mr)for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();else this.dom.shader&&this.dom instanceof mr&&(this.reindex&&(this.reIndexChildren(),this.reindex=!1),this.exeCtx&&this.exeCtx(this.ctx),this.dom.shader.execute(this.children))},Gr.prototype.child=function(t){const e=this;let n;if(e.dom instanceof mr)for(let i=0;i<t.length;i+=1)n=t[i],n.dom.parent=e,e.children[e.children.length]=n,n.dom.pindex=e.children.length-1,n instanceof wr||n.dom.setShader(this.dom.shader),e.dom.attr&&e.dom.attr.transform&&n.applyTransformationMatrix(e.dom.transformMatrix);else console.log("Error");return this.BBoxUpdate=!0,ji.vDomChanged(this.vDomIndex),e},Gr.prototype.createEls=function(t,e){const n=new tr({type:"WEBGL",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(n.stack),ji.vDomChanged(this.vDomIndex),n},Gr.prototype.createEl=function(t){const e=new Gr(this.ctx,t,Ui(),this.vDomIndex);return this.child([e]),ji.vDomChanged(this.vDomIndex),e},Gr.prototype.createShaderEl=function(t){const e=new wr(this.ctx,t,this.vDomIndex);return this.child([e]),ji.vDomChanged(this.vDomIndex),e},Gr.prototype.remove=function(){const{children:t}=this.dom.parent,e=t.indexOf(this);-1!==e&&(this.dom.parent.dom.shader?(this.dom.parent.dom.shader.indexBased&&this.dom.parent.dom.shader.clear(this.dom.pindex),this.dom.parent.setReIndex(),t[this.dom.pindex]=void 0):t.splice(e,1)),this.BBoxUpdate=!0,ji.vDomChanged(this.vDomIndex)},Gr.prototype.removeChild=function(t){let e=-1;if(this.children.forEach(((n,i)=>{n===t&&(e=i)})),-1!==e){const t=this.children.splice(e,1)[0];this.dom.removeChild(t.dom)}this.BBoxUpdate=!0,ji.vDomChanged(this.vDomIndex)},Vr.prototype.setAttr=function(t,e){if(1===arguments.length)for(const n in t)this[n]=t[n],"src"===n&&("string"==typeof e?(this.image&&this.image instanceof Image||(this.image=Ur(this)),this.image.src=e):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement||e instanceof Uint8Array?(this.image=e,this.update()):e instanceof Ye&&(this.image=e.domEl,this.update())),(t.height||t.width)&&(self.image=Hr(this.width,this.height));else this[t]=e,console.warning("Instead of key, value, pass Object of key,value for optimal rendering"),"src"===t&&("string"==typeof e?(this.image&&this.image instanceof Image||(this.image=Ur(this)),this.image.src=e):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement||e instanceof Uint8Array?(this.image=e,this.update()):e instanceof Ye&&(this.image=e.domEl,this.update()))},Vr.prototype.loadTexture=function(){this.updated&&(this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.texture))},Vr.prototype.clear=function(t){},Vr.prototype.update=function(){const t=this.ctx;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),!this.image||this.image instanceof Uint8Array?t.texImage2D(t.TEXTURE_2D,this.border,t[this.format],this.width,this.height,0,t[this.format],t[this.type],this.image):t.texImage2D(t.TEXTURE_2D,this.border,t[this.format],t[this.format],t[this.type],this.image),this.mipMap?(ur(self.image.width)&&ur(self.image.height)||console.warn("Image dimension not in power of 2"),t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.magFilter])):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[this.warpS]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[this.warpT]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.minFilter])),this.updated=!0},qr.prototype.setAttr=function(t,e){this[t]=e},qr.prototype.update=function(){this.texture&&this.texture instanceof Vr&&(this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,this.fbo),this.ctx.framebufferTexture2D(this.ctx.FRAMEBUFFER,this.ctx.COLOR_ATTACHMENT0,this.ctx.TEXTURE_2D,this.texture.texture,0),this.ctx.clearColor(0,0,0,0),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT))},qr.prototype.clear=function(){this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null)},Zr.prototype.setAttr=function(t,e){!e&&this.attributes[t]?delete this.attributes[t]:this.attributes[t]=e},Zr.prototype.setDrawRange=function(t,e){this.drawRange=[t,e]},Zr.prototype.setDrawType=function(t){this.drawType=t},Zr.prototype.setIndex=function(t){this.indexes=t},Wr.prototype=new Zr,Wr.constructor=Wr,$r.prototype=new Zr,$r.constructor=$r,Qr.prototype=new Zr,Qr.constructor=Qr;var Jr=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Kr=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];var to=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},eo={blur:function(t=1){return function(e){return function(t,e,n,i,r,o){for(var s,a=t.data,h=2*o+1,c=i-1,l=r-1,p=o+1,f=p*(p+1)/2,u=new to,d=u,y=1;y<h;y++)d=d.next=new to,y===p&&(s=d);d.next=u;for(var x=null,m=null,g=0,v=0,b=Jr[o],w=Kr[o],B=0;B<r;B++){d=u;for(var A=a[v],T=a[v+1],k=a[v+2],E=a[v+3],S=0;S<p;S++)d.r=A,d.g=T,d.b=k,d.a=E,d=d.next;for(var C=0,D=0,M=0,_=0,z=p*A,I=p*T,P=p*k,O=p*E,L=f*A,N=f*T,F=f*k,R=f*E,j=1;j<p;j++){var X=v+((c<j?c:j)<<2),Y=a[X],G=a[X+1],U=a[X+2],H=a[X+3],V=p-j;L+=(d.r=Y)*V,N+=(d.g=G)*V,F+=(d.b=U)*V,R+=(d.a=H)*V,C+=Y,D+=G,M+=U,_+=H,d=d.next}x=u,m=s;for(var q=0;q<i;q++){var Z=R*b>>w;if(a[v+3]=Z,0!==Z){var W=255/Z;a[v]=(L*b>>w)*W,a[v+1]=(N*b>>w)*W,a[v+2]=(F*b>>w)*W}else a[v]=a[v+1]=a[v+2]=0;L-=z,N-=I,F-=P,R-=O,z-=x.r,I-=x.g,P-=x.b,O-=x.a;var $=q+o+1;$=g+($<c?$:c)<<2,L+=C+=x.r=a[$],N+=D+=x.g=a[$+1],F+=M+=x.b=a[$+2],R+=_+=x.a=a[$+3],x=x.next;var Q=m,J=Q.r,K=Q.g,tt=Q.b,et=Q.a;z+=J,I+=K,P+=tt,O+=et,C-=J,D-=K,M-=tt,_-=et,m=m.next,v+=4}g+=i}for(var nt=0;nt<i;nt++){var it=a[v=nt<<2],rt=a[v+1],ot=a[v+2],st=a[v+3],at=p*it,ht=p*rt,ct=p*ot,lt=p*st,pt=f*it,ft=f*rt,ut=f*ot,dt=f*st;d=u;for(var yt=0;yt<p;yt++)d.r=it,d.g=rt,d.b=ot,d.a=st,d=d.next;for(var xt=i,mt=0,gt=0,vt=0,bt=0,wt=1;wt<=o;wt++){v=xt+nt<<2;var Bt=p-wt;pt+=(d.r=it=a[v])*Bt,ft+=(d.g=rt=a[v+1])*Bt,ut+=(d.b=ot=a[v+2])*Bt,dt+=(d.a=st=a[v+3])*Bt,bt+=it,mt+=rt,gt+=ot,vt+=st,d=d.next,wt<l&&(xt+=i)}v=nt,x=u,m=s;for(var At=0;At<r;At++){var Tt=v<<2;a[Tt+3]=st=dt*b>>w,st>0?(st=255/st,a[Tt]=(pt*b>>w)*st,a[Tt+1]=(ft*b>>w)*st,a[Tt+2]=(ut*b>>w)*st):a[Tt]=a[Tt+1]=a[Tt+2]=0,pt-=at,ft-=ht,ut-=ct,dt-=lt,at-=x.r,ht-=x.g,ct-=x.b,lt-=x.a,Tt=nt+((Tt=At+p)<l?Tt:l)*i<<2,pt+=bt+=x.r=a[Tt],ft+=mt+=x.g=a[Tt+1],ut+=gt+=x.b=a[Tt+2],dt+=vt+=x.a=a[Tt+3],x=x.next,at+=it=m.r,ht+=rt=m.g,ct+=ot=m.b,lt+=st=m.a,bt-=it,mt-=rt,gt-=ot,vt-=st,m=m.next,v+=i}}return t}(e,0,0,e.width,e.height,t)}},greyScale:function(){}};const no=Mt.instance,io=ai,ro=hi;t.Path=no,t.behaviour=wn,t.canvasLayer=io,t.canvasNodeLayer=ro,t.chain=yt,t.color=Ft,t.ease=J,t.geometry=F,t.queue=x,t.svgLayer=function(t,e={}){const n=document.querySelector(t);let i=n.clientHeight,r=n.clientWidth;const{autoUpdate:o=!0,enableResize:s=!0}=e,a=document.createElementNS(on.svg,"svg");let h;a.setAttribute("height",i),a.setAttribute("width",r),a.style.position="absolute";let c,l,p,f,u=999999;n&&(n.appendChild(a),h=new m,o&&(u=We.addVdom(h)));const d=new hn(a,{},Qe(),u);d.container=n,d.type="SVG",d.width=r,d.height=i,d.domEl=a;const y=new Rt(d);h&&h.rootNode(d),d.setLayerId=function(t){a.setAttribute("id",t)};const x=function(e){document.querySelector(t)?(i=c||e.height,r=l||e.width,a.setAttribute("height",i),a.setAttribute("width",r),d.width=r,d.height=i,p&&p(),d.update()):Ze(d)};d.onResize=function(t){p=t},d.onChange=function(t){f=t},d.invokeOnChange=function(){f&&f()},d.setSize=function(t,e){this.dom.setAttribute("height",e),this.dom.setAttribute("width",t),this.width=t,this.height=e,c=e,l=t},d.update=function(){this.execute()},d.setViewBox=function(t,e,n,i){this.dom.setAttribute("viewBox",t+","+e+","+i+","+n)},d.destroy=function(){const e=document.querySelector(t);e&&e.contains(a)&&e.removeChild(a),We.removeVdom(u)},d.createPattern=function(t){return new en(this,t)},d.createClip=function(t){return new tn(this,t)},d.createMask=function(t){return new Ke(this,t)};let g=null;return d.dom.addEventListener("pointerdown",(t=>{y.addPointer(t),t.target.drag_&&(t.target.drag_(t,"pointerdown",y),g=t.target)})),d.dom.addEventListener("pointerup",(t=>{g&&(g.drag_(t,"pointerup",y),g=null),y.removePointer(t)})),d.dom.addEventListener("pointermove",(t=>{t.preventDefault(),g&&g.drag_(t,"pointermove",y)})),We.execute(),s&&qe(d,x),d},t.utility=eo,t.webglLayer=function(t,e={},n={}){const i=t?document.querySelector(t):null;let r=i?i.clientHeight:0,o=i?i.clientWidth:0,s=Ft.rgba(0,0,0,0);const{enableEvents:a=!1,autoUpdate:h=!0,enableResize:c=!1}=n;(e=e||{premultipliedAlpha:!1,depth:!1,antialias:!1,alpha:!0}).premultipliedAlpha=void 0!==e.premultipliedAlpha&&e.premultipliedAlpha,e.depth=void 0!==e.depth&&e.depth,e.antialias=void 0!==e.antialias&&e.antialias,e.alpha=void 0===e.alpha||e.alpha;const l=document.createElement("canvas"),p=l.getContext("webgl",e),f=function(t){const e=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1);return e<1?1:e}(p);let u;Ri=f>=2?2:Math.floor(f),l.setAttribute("height",r*Ri),l.setAttribute("width",o*Ri),l.style.height=r+"px",l.style.width=o+"px",l.style.position="absolute";let d,y,x=999999;i&&(i.appendChild(l),u=new m,h&&(x=ji.addVdom(u)));const g=new Gr(p,{el:"group",attr:{id:"rootNode"},ctx:function(t){t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.clearColor(s.r,s.g,s.b,s.a)}},Ui(),x);u&&u.rootNode(g);const v=g.execute.bind(g);g.container=i,g.domEl=l,g.height=r,g.width=o,g.type="WEBGL",g.ctx.pixelRatio=Ri;let b=function(t){t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)};g.execute=function(){b(this.ctx),this.updateBBox(),this.ctx.enable(this.ctx.BLEND),this.ctx.blendFunc(this.ctx.SRC_ALPHA,this.ctx.ONE_MINUS_SRC_ALPHA),v()},g.update=function(){this.execute()},g.destroy=function(){const e=document.querySelector(t);e&&e.contains(l)&&e.removeChild(l),ji.removeVdom(x)},g.getPixels=function(t,e,n,i){const r=new Uint8Array(n*i*4);return this.ctx.readPixels(t,e,n,i,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,r),r},g.putPixels=function(t,e,n){return this.ctx.putImageData(t,e,n)},g.clear=function(){b(this.ctx)},g.setClearColor=function(t){s=t},g.setClear=function(t){b=t};const w=function(e){document.querySelector(t)?(r=e.height,o=e.width,g.width=o,g.height=r,B(g.domEl,o,r),b(g.ctx),d&&d(),g.execute(),l.style.height=r+"px",l.style.width=o+"px"):Ze(g)},B=function(t,e,n){t.width=Math.floor(e*Ri),t.height=Math.floor(n*Ri),t.style.height=n+"px",t.style.width=e+"px"};if(g.onResize=function(t){d=t},g.onChange=function(t){y=t},g.invokeOnChange=function(){y&&y()},g.setPixelRatio=function(t){Ri=t,this.ctx.pixelRatio=Ri,B(this.domEl,this.width,this.height)},g.setSize=function(t,e){this.width=t,this.height=e,r=e,o=t,B(this.domEl,this.width,this.height),this.execute()},g.setViewBox=function(t,e,n,i){},g.setStyle=function(t,e){this.domEl.style[t]=e},g.setAttr=function(t,e){"viewBox"===t&&this.setViewBox.apply(this,e.split(",")),l.setAttribute(t,e)},g.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},g.MeshGeometry=function(){return new Wr(this.ctx)},g.PointsGeometry=function(){return new $r(this.ctx)},g.LineGeometry=function(){return new Qr(this.ctx)},g.createWebglTexture=function(t){return new Vr(this.ctx,t,this.vDomIndex)},g.RenderTarget=function(t){return new qr(this.ctx,t,this.vDomIndex)},a){const t=new Rt(g);l.addEventListener("mousemove",(e=>{e.preventDefault(),t.mousemoveCheck(e)})),l.addEventListener("mousedown",(e=>{t.mousedownCheck(e)})),l.addEventListener("mouseup",(e=>{t.mouseupCheck(e)})),l.addEventListener("mouseleave",(e=>{t.mouseleaveCheck(e)})),l.addEventListener("contextmenu",(e=>{t.contextmenuCheck(e)})),l.addEventListener("touchstart",(e=>{t.touchstartCheck(e)})),l.addEventListener("touchend",(e=>{t.touchendCheck(e)})),l.addEventListener("touchmove",(e=>{e.preventDefault(),t.touchmoveCheck(e)})),l.addEventListener("touchcancel",(e=>{t.touchcancelCheck(e)})),l.addEventListener("wheel",(e=>{t.wheelEventCheck(e)})),l.addEventListener("pointerdown",(e=>{t.addPointer(e),t.pointerdownCheck(e)})),l.addEventListener("pointerup",(e=>{t.removePointer(e),t.pointerupCheck(e)})),l.addEventListener("pointermove",(e=>{e.preventDefault(),t.pointermoveCheck(e)}))}return ji.execute(),c&&g.container&&qe(g,w),g},Object.defineProperty(t,"__esModule",{value:!0})}));